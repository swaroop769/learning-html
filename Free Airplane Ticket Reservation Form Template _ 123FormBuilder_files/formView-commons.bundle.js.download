"use strict";(self.webpackJsonpFormView=self.webpackJsonpFormView||[]).push([[223],{36356:function(e,t,n){n.d(t,{b:function(){return c}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(43693),u=n.n(s),c=function(){function e(){i()(this,e),u()(this,"isEventTriggeringDisabled",!1),u()(this,"isInSyncMode",!1),u()(this,"events",void 0)}return a()(e,[{key:"isEventTriggeringEnabled",value:function(){return!this.isEventTriggeringDisabled}},{key:"on",value:function(e,t){return void 0===this.events&&(this.events={}),void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this}},{key:"off",value:function(e,t){if(void 0===this.events)return this;if(void 0===this.events[e])return this;if(void 0===t)delete this.events[e];else{for(var n=0,r=this.events[e].length;n<r;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}0===this.events[e].length&&delete this.events[e]}return this}},{key:"disableEvents",value:function(){return this.isEventTriggeringDisabled=!0,this}},{key:"enableEvents",value:function(){return this.isEventTriggeringDisabled=!1,this}},{key:"enableSyncMode",value:function(){return this.isInSyncMode=!0,this}},{key:"disableSyncMode",value:function(){return this.isInSyncMode=!1,this}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.isEventTriggeringDisabled||void 0===this.events||void 0!==this.events[e]&&function(t){for(var r=0,i=t.events[e].length;r<i;r++)t.isInSyncMode?t.events[e][r].apply(t,n):function(e){setTimeout((function(){e.apply(t,n)}))}(t.events[e][r])}(this),this}}]),e}()},88042:function(e,t,n){n.d(t,{a:function(){return H}});var r,i=n(17383),o=n.n(i),a=n(34579),s=n.n(a),u=n(43693),c=n.n(u);!function(e){e[e.TOKEN_VAR=0]="TOKEN_VAR",e[e.TOKEN_IF=1]="TOKEN_IF",e[e.TOKEN_ELSE=2]="TOKEN_ELSE",e[e.TOKEN_UNLESS=3]="TOKEN_UNLESS",e[e.TOKEN_EACH=4]="TOKEN_EACH",e[e.TOKEN_END=5]="TOKEN_END",e[e.TOKEN_TEXT=6]="TOKEN_TEXT",e[e.TOKEN_WITH=7]="TOKEN_WITH",e[e.TOKEN_COMMENT=8]="TOKEN_COMMENT",e[e.TOKEN_EQUALS=9]="TOKEN_EQUALS"}(r||(r={}));var l=n(23073),h=n.n(l),f=function(){function e(t,n,r){o()(this,e),c()(this,"model",void 0),c()(this,"parent",null),c()(this,"helpers",void 0),this.model=t,this.parent=n||null,this.helpers=r||[]}return s()(e,[{key:"getModel",value:function(){return this.model}},{key:"get",value:function(e){if("this"===e)return this.model;var t,n=e.split("/"),r=n.length;return null===(t=r>1?this.cd(n.slice(0,r-1).join("/")).get(n[r-1]):".."==n[0]?this.getParent().getModel():this.model[n[0]])||void 0===t?"":t}},{key:"getHelper",value:function(e){for(var t=0,n=this.helpers.length;t<n;t++)if(this.helpers[t].name===e)return this.helpers[t];throw new Error('HELPER "'.concat(e,'" not found!'))}},{key:"isNotEmpty",value:function(e){var t=this.get(e);return!!t&&(!h()(t,Array)||0!==t.length)}},{key:"equals",value:function(e,t){return this.get(e)===this.get(t)}},{key:"cd",value:function(t){for(var n=t.split("/"),r=this,i=0,o=n.length;".."==t[i];){if(!r.getParent())throw new Error("Illegal path: ".concat(n.join("/")));r=r.getParent(),i++}for(;i<o;){if(".."==n[i]){if(!r.getParent())throw new Error("Illegal path: ".concat(n.join("/")));r=r.getParent()}else if("this"==n[i]&&0==i);else{if(!h()(r.getModel(),Object)||void 0==r.getModel()[n[i]])throw new Error("Illegal path: ".concat(n.join("/")));r=new e(r.getModel()[n[i]],this,this.helpers)}i++}return r}},{key:"each",value:function(t,n){var r=this.get(t)||[];if(r&&h()(r,Array))for(var i=0,o=r.length;i<o;i++)n(new e(r[i],this,this.helpers))}},{key:"getParent",value:function(){if(this.parent)return this.parent;throw new Error("Failed to get context parent!")}}]),e}(),d=n(12475),p=n.n(d),g=n(29511),v=n.n(g),m=n(28452),y=n.n(m),b=n(63072),E=n.n(b),w=function(){function e(t,n){o()(this,e),c()(this,"parent",null),c()(this,"type",void 0),c()(this,"params",void 0),this.type=t,this.params=n}return s()(e,[{key:"withParent",value:function(e){return this.parent=e,this}},{key:"getParent",value:function(){return this.parent}},{key:"getBlockType",value:function(){return this.type}},{key:"getParam",value:function(e){return this.params&&this.params[e]||null}},{key:"setParam",value:function(e,t){this.params[e]=t}}]),e}();function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var N=function(e){v()(n,e);var t=T(n);function n(e){var i;if(o()(this,n),i=t.call(this,r.TOKEN_IF,[]),c()(p()(i),"elseAppended",!1),c()(p()(i),"trueBranchChildren",[]),c()(p()(i),"falseBranchChildren",[]),i.params[0]=H.normalizePath(e[0]),null===i.params[0])throw new Error("Illegal IF variable: ".concat(e[0]));return i}return s()(n,[{key:"append",value:function(e){if(e.getBlockType()===r.TOKEN_ELSE){if(this.elseAppended)throw new Error("Else appended!");return this.elseAppended=!0,e}return this.elseAppended?this.falseBranchChildren.push(e):this.trueBranchChildren.push(e),e.withParent(this)}},{key:"allowChildren",value:function(){return!0}},{key:"parse",value:function(e){var t="";if(e.isNotEmpty(this.getParam(0)))for(var n=0,r=this.trueBranchChildren.length;n<r;n++)t=t.concat(this.trueBranchChildren[n].parse(e));else for(var i=0,o=this.falseBranchChildren.length;i<o;i++)t=t.concat(this.falseBranchChildren[i].parse(e));return t}}]),n}(w);function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var R=function(e){v()(n,e);var t=k(n);function n(e){var i;if(o()(this,n),i=t.call(this,r.TOKEN_UNLESS,[]),c()(p()(i),"elseAppended",!1),c()(p()(i),"trueBranchChildren",[]),c()(p()(i),"falseBranchChildren",[]),i.params[0]=H.normalizePath(e[0]),null===i.params[0])throw new Error("Illegal UNLESS variable: ".concat(e[0]));return i}return s()(n,[{key:"append",value:function(e){if(e.getBlockType()===r.TOKEN_ELSE){if(this.elseAppended)throw new Error("Else appended!");this.elseAppended=!0}else this.elseAppended?this.falseBranchChildren.push(e):this.trueBranchChildren.push(e);return e.withParent(this)}},{key:"allowChildren",value:function(){return!0}},{key:"parse",value:function(e){var t="";if(e.isNotEmpty(this.getParam(0)))for(var n=0,r=this.falseBranchChildren.length;n<r;n++)t=t.concat(this.falseBranchChildren[n].parse(e));else for(var i=0,o=this.trueBranchChildren.length;i<o;i++)t=t.concat(this.trueBranchChildren[i].parse(e));return t}}]),n}(w);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var C=function(e){v()(n,e);var t=S(n);function n(){return o()(this,n),t.call(this,r.TOKEN_END,null)}return s()(n,[{key:"allowChildren",value:function(){return!1}},{key:"parse",value:function(e){return""}},{key:"append",value:function(e){throw new Error("Cannot append something into a END block!")}}]),n}(w);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var D=function(e){v()(n,e);var t=O(n);function n(e){var i;return o()(this,n),i=t.call(this,r.TOKEN_TEXT,null),c()(p()(i),"text",void 0),i.text=e,i}return s()(n,[{key:"allowChildren",value:function(){return!1}},{key:"parse",value:function(e){return this.text}},{key:"append",value:function(e){throw new Error("Method not allowed.")}}]),n}(w);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var A=function(e){v()(n,e);var t=I(n);function n(e,i){var a;if(o()(this,n),a=t.call(this,r.TOKEN_VAR,[]),c()(p()(a),"isEscaped",void 0),a.params.push(H.normalizePath(e[0])),null===a.params[0])throw new Error("Illegal variable: ".concat(e[0]));for(var s=1,u=e.length;s<u;s++)a.params.push(e[s]);return a.isEscaped=i,a}return s()(n,[{key:"allowChildren",value:function(){return!1}},{key:"parse",value:function(e){for(var t=String(e.get(this.getParam(0))),n=1,r=this.params.length;n<r;n++)t=e.getHelper(this.params[n]).func(t);return this.isEscaped?t.replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;"):t}},{key:"append",value:function(e){throw new Error("A VAR block does not allow insertion")}}]),n}(w);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var x=function(e){v()(n,e);var t=_(n);function n(e){var i;if(o()(this,n),i=t.call(this,r.TOKEN_WITH,[]),c()(p()(i),"children",[]),i.params.push(H.normalizePath(e[0])),null===i.params[0])throw new Error("Illegal WITH argument");return i}return s()(n,[{key:"allowChildren",value:function(){return!0}},{key:"parse",value:function(e){for(var t=e.cd(this.getParam(0)),n="",r=0,i=this.children.length;r<i;r++)n=n.concat(this.children[r].parse(t));return n}},{key:"append",value:function(e){return this.children.push(e.withParent(this)),e}}]),n}(w);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var L=function(e){v()(n,e);var t=M(n);function n(){return o()(this,n),t.call(this,r.TOKEN_ELSE,null)}return s()(n,[{key:"allowChildren",value:function(){return!1}},{key:"parse",value:function(e){throw new Error("Should never be parsed")}},{key:"append",value:function(e){throw new Error("Cannot have children")}},{key:"withParent",value:function(e){if(!e||e.getBlockType()!==r.TOKEN_IF&&e.getBlockType()!==r.TOKEN_UNLESS)throw new Error("Invalid ELSE block parent: Expected IF or UNLESS!");return this}}]),n}(w);function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var B=function(e){v()(n,e);var t=F(n);function n(e){var i;if(o()(this,n),i=t.call(this,r.TOKEN_EACH,[]),c()(p()(i),"children",void 0),i.children=[],i.params.push(H.normalizePath(e[0])),null===i.params[0])throw new Error("Illegal each argument!");return i}return s()(n,[{key:"allowChildren",value:function(){return!0}},{key:"parse",value:function(e){var t="";return function(n){e.each(n.getParam(0),(function(e){for(var r=0,i=n.children.length;r<i;r++)t=t.concat(n.children[r].parse(e))}))}(this),t}},{key:"append",value:function(e){return this.children.push(e.withParent(this)),e}}]),n}(w);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var U=function(e){v()(n,e);var t=P(n);function n(e){var i;if(o()(this,n),i=t.call(this,r.TOKEN_EQUALS,[]),c()(p()(i),"children",[]),i.params[0]=H.normalizePath(e[0]),i.params[1]=H.normalizePath(e[1]),null===i.params[0])throw new Error("Illegal EQUALS variable: ".concat(e[0]));if(null===i.params[1])throw new Error("Illegal EQUALS variable: ".concat(e[1]));return i}return s()(n,[{key:"append",value:function(e){return this.children.push(e),e.withParent(this)}},{key:"allowChildren",value:function(){return!0}},{key:"parse",value:function(e){var t="";if(e.equals(this.getParam(0),this.getParam(1)))for(var n=0,r=this.children.length;n<r;n++)t=t.concat(this.children[n].parse(e));return t}}]),n}(w),H=function(){function e(t){o()(this,e),c()(this,"instructions",void 0),c()(this,"helpers",[]),this.instructions=e.tokenize(t);for(var n=0,r=e.GLOBAL_HELPERS.length;n<r;n++)this.helpers.push(e.GLOBAL_HELPERS[n])}return s()(e,[{key:"parse",value:function(e){for(var t=[],n=new f(e,null,this.helpers),r=0,i=this.instructions.length;r<i;r++)t.push(this.instructions[r].parse(n));return t.join("")}},{key:"withHelper",value:function(e){if(!e)throw new Error("Invalid argument!");for(var t=0,n=this.helpers.length;t<n;t++)if(this.helpers[t].name===e.name)throw new Error('Helper "'.concat(e.name,'" already added!'));return this.helpers.push(e),this}}],[{key:"createEmptyBlockText",value:function(){return{token:r.TOKEN_TEXT,params:null,settings:null,text:""}}},{key:"tokenize",value:function(t){for(var n,i,o,a,s,u=0,c=t.length,l=null,h=[],f=[];u<c;)(i="{"===(n=t.charAt(u))?this.readToken(u,c,t):null)?(l&&h.push(l),l={text:i.text,token:i.token,params:i.params,settings:i.settings},h.push(l),u+=o=l.text.length,o,l=null):((l=l||e.createEmptyBlockText()).text+=n,u++);if(l&&h.push(l),!h.length)return[];for(var d=0,p=h.length;d<p;d++)if(h[d].token===r.TOKEN_END){if(!s)throw new Error("Unexpected TOKEN END!");s=s.getParent()}else a=this.createInstructionFromBlock(h[d]),s?(s.append(a),a.withParent(s)):(f.push(a),a.withParent(null)),a.allowChildren()&&(s=a);return f}},{key:"readToken",value:function(e,t,n){if("{"!==n.charAt(e)||"{"!==n.charAt(e+1))return null;var r,i,o=!0,a=e+2,s=[],u=!1,c="",l=0,h=!1;for("{"===n.charAt(e+2)?(o=!1,a++,c="{{{"):c="{{";!u;)c+=l>=1&&h?this.repeat(" ",i=this.readPipeAndSpaces(n,a)):this.repeat(" ",i=this.readSpaces(n,a)),a+=i,(i=(r=this.readArgument(n,a)).length)?(c+=r,a+=i,a+=i=this.readSpaces(n,a),c+=this.repeat(" ",i),s.push(r),1===++l&&(h=!this.isReservedKeyword(r))):u=!0;return e=a,"}"===n.charAt(e)&&"}"===n.charAt(e+1)?(c+="}}",o?s.length>0?this.convertArgsToToken(s,o,c):null:"}"===n.charAt(e+2)&&s.length?(c+="}",this.convertArgsToToken(s,o,c)):null):void 0}},{key:"readPipeAndSpaces",value:function(e,t){for(var n,r=0,i=0;(n=e.charAt(t))&&(" "===n||"\n"===n||"\r"===n||"\t"===n||"|"===n);)r++,"|"===n&&i++,t++;return 1===i?r:0}},{key:"readSpaces",value:function(e,t){for(var n,r=0;(n=e.charAt(t))&&(" "===n||"\n"===n||"\r"===n||"\t"===n);)r++,t++;return r}},{key:"readArgument",value:function(t,n){for(var r,i="";(r=t.charAt(n))&&e.ARGUMENT_VALID_CHARS.indexOf(r)>-1;)i+=r,n++;return i}},{key:"convertArgsToToken",value:function(e,t,n){var i=e.length;if(0===i)return null;if(1===i)return this.isReservedKeyword(e[0])?"#end"===e[0]||"#else"===e[0]?{text:n,params:null,token:"#end"===e[0]?r.TOKEN_END:r.TOKEN_ELSE,settings:null}:null:{text:n,params:e,token:r.TOKEN_VAR,settings:{escaped:t}};if(!this.isReservedKeyword(e[0]))return{text:n,params:e,token:r.TOKEN_VAR,settings:{escaped:t}};if(!t)return null;switch(e[0]){case"#if":case"#unless":return 2===i&&this.isValidContextPath(e[1])?{token:"#if"===e[0]?r.TOKEN_IF:r.TOKEN_UNLESS,params:[e[1]],text:n,settings:{negated:"#unless"===e[0]}}:null;case"#equals":return 3===i&&this.isValidContextPath(e[1])&&this.isValidContextPath(e[2])?{token:r.TOKEN_EQUALS,params:[e[1],e[2]],text:n,settings:null}:null;case"#each":return 2===i&&this.isValidContextPath(e[1])?{token:r.TOKEN_EACH,params:[e[1]],text:n,settings:null}:4===i&&"in"===e[2]&&this.isValidContextPath(e[1])&&this.isValidVariableName(e[3])?{token:r.TOKEN_EACH,params:[e[1],e[3]],text:n,settings:null}:null;case"#with":return 2===i&&this.isValidContextPath(e[1])?{token:r.TOKEN_WITH,params:[e[1]],text:n,settings:null}:null;default:throw new Error("Invalid keyword: ".concat(e[0]))}}},{key:"isReservedKeyword",value:function(e){return"#if"===e||"#each"===e||"#unless"===e||"#else"===e||"#end"===e||"#with"===e||"#equals"===e}},{key:"isValidContextPath",value:function(e){if(!e)return!1;for(var t=e.split("/"),n=0,r=t.length;n<r;n++)if("."!==t[n]&&".."!==t[n]&&!this.isValidVariableName(t[n]))return!1;return!0}},{key:"isValidVariableName",value:function(t){if(t){for(var n=t.split("."),r=0,i=n.length;r<i;r++){if(!(e.VAR_START_CHAR.indexOf(n[r].charAt(0))>-1))return!1;for(var o=1,a=n[r].length;o<a;o++)if(-1===e.VAR_OTHER_CHARS.indexOf(n[r].charAt(o)))return!1}return!0}return!1}},{key:"repeat",value:function(e,t){for(var n="",r=0;r<t;r++)n+=e;return n}},{key:"createInstructionFromBlock",value:function(e){switch(e.token){case r.TOKEN_IF:return new N(e.params);case r.TOKEN_UNLESS:return new R(e.params);case r.TOKEN_END:return new C;case r.TOKEN_TEXT:return new D(e.text);case r.TOKEN_VAR:return new A(e.params,e.settings.escaped);case r.TOKEN_EACH:return new B(e.params);case r.TOKEN_WITH:return new x(e.params);case r.TOKEN_ELSE:return new L;case r.TOKEN_EQUALS:return new U(e.params);default:throw new Error("Unknown block type: ".concat(JSON.stringify(e)))}}},{key:"normalizePath",value:function(e){if(e){for(var t,n=e.split("/"),r=[],i=0,o=0,a=n.length;o<a;o++)if("."!==n[o]&&""!==n[o])if(".."===n[o])i>0&&".."!==r[i-1]?(i--,r.pop()):(i++,r.push(".."));else for(var s=0,u=(t=n[o].split(".")).length;s<u;s++){if(""===t[s])return null;r.push(t[s]),i++}for(var c=i-1;c>-1;c--)"this"===r[c]&&c>1&&(r.splice(c,1),i--);return i?r.join("/"):null}return e}},{key:"trimDOMNodes",value:function(e){for(var t=e.querySelectorAll("*"),n=0;n<t.length;n++)t[n].innerHTML=t[n].innerHTML.trim(),t[n].innerHTML||t[n].classList.add("blank")}},{key:"addHelper",value:function(e){if(!e)throw new Error("Invalid argument!");for(var t=0,n=this.GLOBAL_HELPERS.length;t<n;t++)if(this.GLOBAL_HELPERS[t].name===e.name)throw new Error('Helper "'.concat(e.name,'" already added!'));this.GLOBAL_HELPERS.push(e)}}]),e}();c()(H,"GLOBAL_HELPERS",[{name:"upper",func:function(e){return String(e).toUpperCase()}},{name:"lower",func:function(e){return String(e).toLowerCase()}}]),c()(H,"ARGUMENT_VALID_CHARS","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789./_$#"),c()(H,"VAR_START_CHAR","$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_"),c()(H,"VAR_OTHER_CHARS","$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789")},70916:function(e,t,n){var r;n.d(t,{s:function(){return r}}),function(e){e.DEPENDENCY_MANAGER="rsdgfydqxv",e.BUY_USERS="jcqqqeuyku",e.ERROR_LOGGER="isloowrumj",e.API_BASE="myvlglkxjq",e.API_BEARER="nfykwfswyu",e.API_SERVICE="fulwxuaunj",e.JWT_SERVICE="abnfsfymcw",e.USER_DATA_SERVICE="jmzuvvtifp",e.USER_SERVICE="tadbfxdqxv",e.LEGACY_API_SERVICE="ievmmadpns",e.STATIC_DATA_SERVICE="ndgvxpcicr",e.FORM_DETAILS_SERVICE="egzwzusrsu",e.FEATURE_SERVICE="gzzfinsdmt"}(r||(r={}))},48156:function(e,t,n){n.d(t,{i:function(){return h}});var r=n(23073),i=n.n(r),o=n(17383),a=n.n(o),s=n(34579),u=n.n(s),c=n(43693),l=n.n(c),h=function(){function e(t){a()(this,e),l()(this,"i18n",void 0),this.i18n=t}return u()(e,[{key:"convertFileSizeToString",value:function(t){var n,r;switch(!0){case t/e.KILOBYTE<1:n=t,r=null;break;case t/e.MEGABYTE<1:r="KB",n=t/e.KILOBYTE;break;case t/e.GIGABYTE<1:r="MB",n=t/e.MEGABYTE;break;case t/e.TERABYTE<1:r="GB",n=t/e.GIGABYTE;break;default:r="TB",n=t/e.TERABYTE}return Number(n).toFixed(1).replace(/\.0$/g,"")+(null===r?"":" "+r)}}],[{key:"download",value:function(t,n,r){var o,a,s=window,u="application/octet-stream",c=r||u,l=t,h=!n&&!r&&l,f=document.createElement("a"),d=function(e){return String(e)},p=s.Blob||s.MozBlob||s.WebKitBlob||d,g=n||"download";p=p.call?p.bind(s):Blob;var v=function(e,t){if("download"in f)return f.href=e,f.setAttribute("download",g),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===t&&setTimeout((function(){s.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-+]+)/,u)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-+]+)/,u)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)},m=function(e){for(var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=r.length,o=0,a=new Uint8Array(i);o<i;++o)a[o]=r.charCodeAt(o);return new p([a],{type:n})};if("true"===String(this)&&(c=(l=[l,c])[0],l=l[1]),h&&h.length<2048&&(g=h.split("/").pop().split("?")[0],f.href=h,-1!==f.href.indexOf(h))){var y=new XMLHttpRequest;return y.open("GET",h,!0),y.responseType="blob",y.onload=function(t){e.download(t.target.response,g,u)},setTimeout((function(){y.send()}),0),y}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&p!==d))return navigator.msSaveBlob?navigator.msSaveBlob(m(l),g):v(l);c=(l=m(l)).type||u}else if(/([\x80-\xff])/.test(l)){for(var b=0,E=new Uint8Array(l.length),w=E.length;b<w;++b)E[b]=l.charCodeAt(b);l=new p([E],{type:c})}if(o=i()(l,p)?l:new p([l],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,g);if(s.URL)v(s.URL.createObjectURL(o),!0);else{if("string"===typeof o||o.constructor===d)try{return v("data:"+c+";base64,"+s.btoa(o))}catch(T){return v("data:"+c+","+encodeURIComponent(o))}(a=new FileReader).onload=function(){v(this.result)},a.readAsDataURL(o)}return!0}}]),e}();l()(h,"KILOBYTE",1024),l()(h,"MEGABYTE",1048576),l()(h,"GIGABYTE",1073741824),l()(h,"TERABYTE",1099511627776)},42395:function(e,t,n){n.d(t,{X:function(){return s}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=function(){function e(){i()(this,e)}return a()(e,null,[{key:"create",value:function(e,t){var n=null;return function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)}}}]),e}()},89478:function(e,t,n){n.d(t,{R:function(){return p}});var r,i,o=n(23073),a=n.n(o),s=n(17383),u=n.n(s),c=n(34579),l=n.n(c),h=n(43693),f=n.n(h);!function(e){e.NATIVE="123",e.WIX="wix",e.WEEBLY="weebly"}(r||(r={})),function(e){e.TODAY="today",e.YESTERDAY="yesterday",e.THE_DAY_BEFORE_YESTERDAY="the_day_before_yesterday",e.THIS_WEEK="this_week",e.PREVIOUS_WEEK="previous_week",e.TWO_WEEKS_AGO="two_weeks_ago",e.THIS_MONTH="this_month",e.PREVIOUS_MONTH="previous_month",e.TWO_MONTHS_AGO="two_months_ago"}(i||(i={}));var d=n(69046),p=function(){function e(t){u()(this,e),f()(this,"_tempDate",new Date),f()(this,"_i18nDate",void 0),f()(this,"_weekDays",void 0),f()(this,"_monthNames",void 0),f()(this,"_i18nTime",void 0),f()(this,"_shortDayNames_us",["Su","Mo","Tu","We","Th","Fr","Sa"]),f()(this,"_shortMonthNames_us",["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),f()(this,"_longMonthNames_us",["January","February","March","April","May","June","July","August","September","Octomber","November","December"]),f()(this,"_friendlyTimeFormatWhenYearIsCurrentYear","%d %M"),f()(this,"_friendlyTimeFormatWhenYearIsDifferentThanCurrentYear","%d %M, %Y"),f()(this,"_i18nTimeFormat",{fewSecondsAgo:"Few seconds ago",fewMinutesAgo:"Few minutes ago",xMinutesAgo:"%t% minutes ago",xHoursAgo:"%t% hours ago",yesterday:"Yesterday"}),f()(this,"COMMON_TIME_STRINGS",{yesterday:"-1d",today:"now",tomorrow:"+1d",overmorrow:"+2d"}),f()(this,"i18n",void 0),this.i18n=t,this.setI18nService()}return l()(e,[{key:"setI18nService",value:function(){return this._friendlyTimeFormatWhenYearIsCurrentYear=this.getTranslatedTextIfExistsOrNullOtherwise(this.i18n,"LOGS_DateFormatWhenYearIsCurrentYear")||"%d %M",this._friendlyTimeFormatWhenYearIsDifferentThanCurrentYear=this.getTranslatedTextIfExistsOrNullOtherwise(this.i18n,"LOGS_DateFormatWhenYearIsDifferentThanCurrentYear")||"%d %M, %Y",this._i18nDate=(this.i18n.translateText("LOGS_DateInternationalization")||"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|January|February|March|April|May|June|July|August|September|October|November|December").split("|"),this._weekDays=this._i18nDate.slice(0,7),this._monthNames=this._i18nDate.slice(7),this._i18nTime=(this.i18n.translateText("LOGS_TimeInternationalization")||"Few seconds ago|Few minutes ago|%t% minutes ago|%t% hours ago|Yesterday").split("|"),this._i18nTimeFormat.fewSecondsAgo=this._i18nTime[0],this._i18nTimeFormat.fewMinutesAgo=this._i18nTime[1],this._i18nTimeFormat.xMinutesAgo=this._i18nTime[2],this._i18nTimeFormat.xHoursAgo=this._i18nTime[3],this._i18nTimeFormat.yesterday=this._i18nTime[4],this}},{key:"_formatI18nTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._i18nTimeFormat[e].replace(/%t%/g,String(t||""))}},{key:"_padNumber",value:function(e,t){var n=String(~~e);for(t=~~t;n.length<t;)n="0"+n;return n}},{key:"formatTimeFriendly",value:function(e){if(0===(e=~~e))return" ";var t=+new Date/1e3-e;switch(this._tempDate.setTime(1e3*e),!0){case t<60:return this._formatI18nTime("fewSecondsAgo",t);case t<300:return this._formatI18nTime("fewMinutesAgo",~~(t/60));case t<3600:return this._formatI18nTime("xMinutesAgo",~~(t/60));case t<86400:return this._tempDate.getDay()!=(new Date).getDay()?this._formatI18nTime("yesterday")+", "+this._padNumber(this._tempDate.getHours(),2)+":"+this._padNumber(this._tempDate.getMinutes(),2):this._formatI18nTime("xHoursAgo",Math.round(t/3600));case t<=518400:return this._weekDays[this._tempDate.getDay()];default:return this._tempDate.getFullYear()===(new Date).getFullYear()?this.formatTime(e,this._friendlyTimeFormatWhenYearIsCurrentYear):this.formatTime(e,this._friendlyTimeFormatWhenYearIsDifferentThanCurrentYear)}}},{key:"getKey",value:function(e,t){for(var n,r=e.toLowerCase(),i=0;i<t.length;i++)if(n=t[i].toString().toLowerCase(),r.substr(0,n.length)==n)return i;throw new Error("Date.prototype: Unparsable string: key not found (str="+e+", arr=["+t.join(",")+")!")}},{key:"unpadDigitsFromString",value:function(e){if(""==e)return 0;for(var t,n=e.toString(),r=0;r<n.length&&"0"==n.charAt(r);)r++;return t=parseInt(n.substr(r)),isNaN(t)?0:t}},{key:"readNumberFromAString",value:function(e,t,n,r){var i=e.toString();if(i.length<t)throw new Error("TimeUtils: cannot parse string: not enough length");for(var o,a=i.substr(0,t),s=t;s<n&&(o=i.charAt(s),-1!=="0123456789".indexOf(o))&&parseInt(String(this.unpadDigitsFromString(a.concat(o))))<=r;)a=a.concat(o),s++;if(parseInt(a)>r)throw new Error("TimeUtils: invalid number: max allowed number is "+r+", got: "+a);return a}},{key:"parseDate",value:function(e,t){var n=new Date;if(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),"undefined"==typeof e||!e)return n;for(var r,i,o,a,s,u,c,l=null,h=null,f=null,d=null,p=null,g=null,v=null,m=String(e||""),y=String(t||""),b=0,E=!1,w=0,T=y.length;w<T;w++)try{if(m=m.substr(b),"%"==y.charAt(w)){if(++w>=y.length)throw new Error("unterminated date expression at position "+w+" in string "+y);switch(y.charAt(w)){case"a":b+=this._shortDayNames_us[this.getKey(m,this._shortDayNames_us)].length;break;case"b":p=this.getKey(m,this._shortMonthNames_us),b=this._shortMonthNames_us[p].length;break;case"c":p=~~(s=this.readNumberFromAString(m,1,2,12)),b=s.length,p-=1;break;case"d":g=~~(u=this.readNumberFromAString(m,2,2,31)),b=u.length;break;case"e":g=~~(u=this.readNumberFromAString(m,1,2,31)),b=u.length;break;case"H":l=~~(r=this.readNumberFromAString(m,2,2,23)),b=r.length;break;case"h":case"I":l=~~(r=this.readNumberFromAString(m,2,2,12)),b=r.length;break;case"i":h=~~(i=this.readNumberFromAString(m,2,2,59)),b=i.length;break;case"k":l=~~(r=this.readNumberFromAString(m,1,2,23)),b=r.length;break;case"l":l=~~(r=this.readNumberFromAString(m,1,2,12)),b=r.length;break;case"M":p=this.getKey(m,this._longMonthNames_us),b=this._longMonthNames_us[p].length;break;case"m":p=~~(s=this.readNumberFromAString(m,2,2,12)),b=s.length,p=this.unpadDigitsFromString(s)-1;break;case"p":v=this.getKey(m,["AM","PM"]),b=2;break;case"s":case"S":f=~~(o=this.readNumberFromAString(m,2,2,59)),b=o.length;break;case"Y":d=~~(a=this.readNumberFromAString(m,4,4,2100)),b=a.length;break;case"U":if(null===(c=/^(\-)?([\d]+)/.exec(m)))throw new Error("Could not parse %U modifier: invalid unix timestamp!");return n.setTime(1e3*parseInt((c[1]||"").concat(c[2]))),n;default:throw E=!0,new Error('Unsupported token "%'+y.charAt(w)+'" while parsing date')}}else if(b=1,m.charAt(0)!==y.charAt(w))throw E=!0,new Error("Unexpected character: "+JSON.stringify(m.charAt(0))+", expected: "+y.charAt(w))}catch(N){if(E)throw N;return null}if(g=null===g?null:this.unpadDigitsFromString(String(g)),p=null===p?null:this.unpadDigitsFromString(String(p)),d=null===d?null:this.unpadDigitsFromString(String(d)),l=null===l?null:this.unpadDigitsFromString(String(l)),h=null===h?null:this.unpadDigitsFromString(String(h)),f=null===f?null:this.unpadDigitsFromString(String(f)),1===v&&null!==l&&(l+=12)>23)throw new Error('Date.prototype: invalid hour : "'+l+'"');return null!==p&&n.setMonth(p),null!==g&&n.setDate(g),null!==p&&n.setMonth(p),null!==d&&n.setFullYear(d),null!==l&&n.setHours(l),null!==h&&n.setMinutes(h),null!==f&&n.setSeconds(f),12===n.getHours()&&0===v&&n.setHours(0),n}},{key:"intToTime",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"%H:%i:%s",r="",i=0,o="",a=n.length,s=new Date;for(s.setHours(0),s.setMinutes(0),s.setSeconds(e);i<a;){if("%"===(o=n.charAt(i))){if(++i==a)return r;switch(o=n.charAt(i)){case"H":r=r.concat(this._padNumber(s.getHours(),2));break;case"h":case"I":t=s.getHours(),r=r.concat(0==t?"12":t<=12?this._padNumber(t,2):this._padNumber(t-12,2));break;case"i":r=r.concat(this._padNumber(s.getMinutes(),2));break;case"k":r=r.concat(String(s.getHours()));break;case"l":t=s.getHours(),r=r.concat(0==t?"12":t<=12?t:t-12);break;case"p":t=s.getHours(),r=r.concat(t<12?"AM":"PM");break;case"r":t=s.getHours(),r=r.concat(this._padNumber(0==t?"12":t<12?t:t-12,2),":",this._padNumber(s.getMinutes(),2),":",this._padNumber(s.getSeconds(),2)," ",s.getHours()<12?"AM":"PM");break;case"s":case"S":r=r.concat(this._padNumber(s.getSeconds(),2));break;case"T":r=r.concat(this._padNumber(s.getHours(),2),":",this._padNumber(s.getMinutes(),2),":",this._padNumber(s.getSeconds(),2));break;case"%":r=r.concat("%");break;default:throw new Error("The %"+o+" specifier is not supported!")}}else r=r.concat(o);i++}return r}},{key:"formatTime",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"%Y-%m-%d %H:%i:%s",r="",i=0,o="",a=n.length,s=new Date;for(s.setTime(1e3*e);i<a;){if("%"===(o=n.charAt(i))){if(++i==a)return r;switch(o=n.charAt(i)){case"a":r=r.concat(this._weekDays[s.getDay()].substr(0,3));break;case"b":r=r.concat(this._monthNames[s.getMonth()].substr(0,3));break;case"c":r=r.concat(String(s.getMonth()+1));break;case"d":r=r.concat(this._padNumber(s.getDate(),2));break;case"e":r=r.concat(String(s.getDate()));break;case"H":r=r.concat(this._padNumber(s.getHours(),2));break;case"h":case"I":t=s.getHours(),r=r.concat(0==t?"12":t<=12?this._padNumber(t,2):this._padNumber(t-12,2));break;case"i":r=r.concat(this._padNumber(s.getMinutes(),2));break;case"k":r=r.concat(String(s.getHours()));break;case"l":t=s.getHours(),r=r.concat(0==t?"12":t<=12?t:t-12);break;case"M":r=r.concat(this._monthNames[s.getMonth()]);break;case"m":r=r.concat(this._padNumber(s.getMonth()+1,2));break;case"p":t=s.getHours(),r=r.concat(t<12?"AM":"PM");break;case"r":t=s.getHours(),r=r.concat(this._padNumber(0==t?"12":t<12?t:t-12,2),":",this._padNumber(s.getMinutes(),2),":",this._padNumber(s.getSeconds(),2)," ",s.getHours()<12?"AM":"PM");break;case"s":case"S":r=r.concat(this._padNumber(s.getSeconds(),2));break;case"T":r=r.concat(this._padNumber(s.getHours(),2),":",this._padNumber(s.getMinutes(),2),":",this._padNumber(s.getSeconds(),2));break;case"W":r=r.concat(this._weekDays[s.getDay()]);break;case"w":r=r.concat(String(s.getDay()));break;case"Y":r=r.concat(String(s.getFullYear()));break;case"y":r=r.concat(String(s.getFullYear()).substr(2));break;case"U":r=r.concat(String(Math.floor(s.getTime()/1e3)));break;case"%":r=r.concat("%");break;default:throw new Error("The %"+o+" specifier is not supported!")}}else r=r.concat(o);i++}return r}},{key:"getMonthNamesLong",value:function(){return this._monthNames}},{key:"getMonthNamesShort",value:function(){for(var e=[],t=0,n=this._monthNames.length;t<n;t++)e.push(this._monthNames[t].substr(0,3));return e}},{key:"getWeekNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new Date(e?+e:+new Date);return t.setHours(0,0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7)),~~(((t.getTime()-new Date(t.getFullYear(),0,1).getTime())/864e5+1)/7)}},{key:"getFriendlyIntervalName",value:function(e){switch(e){case i.TODAY:return this.i18n.translateText("dashboard_activityDateToday")||"Today";case i.YESTERDAY:return this.i18n.translateText("dashboard_activityDateYesterday")||"Yesterday";case i.THE_DAY_BEFORE_YESTERDAY:return this.i18n.translateText("dashboard_activityDateTwoDaysAgo")||"Two days ago";case i.THIS_WEEK:return this.i18n.translateText("dashboard_activityDateThisWeek")||"This week";case i.PREVIOUS_WEEK:return this.i18n.translateText("dashboard_activityDateLastWeek")||"Last week";case i.TWO_WEEKS_AGO:return this.i18n.translateText("dashboard_activityDateTwoWeeksAgo")||"Two weeks ago";case i.THIS_MONTH:return this.i18n.translateText("dashboard_activityDateThisMonth")||"This month";case i.PREVIOUS_MONTH:return this.getMonthName(1)||"Last month";case i.TWO_MONTHS_AGO:return this.getMonthName(2)||"Two months ago";default:return}}},{key:"getMonthName",value:function(e){var t=new Date;return t.setMonth(t.getMonth()-e),this._monthNames[t.getMonth()]}},{key:"dateAdd",value:function(e,t){if(""===(e=String(e||"")))return null;var n,r,i,o="-"===e.charAt(0),s="+"===e.charAt(0)||null,u=null,c=null,l=null,h=null,f=null,d=null,p=null,g=null,v=new Date,m=!1;for((o||s)&&(e=e.substr(1)),null===s&&(s=!0),t&&a()(t,Date)&&v.setTime(t.getTime()),i=o?-1:1;""!==e&&(r=/^([1-9]([\d]+)?)(HH|MM|SS|MS|D|W|M|Y)/i.exec(e));){switch(n=~~r[1],m=!0,r[3].toLowerCase()){case"hh":if(null!==u)return null;u=n;break;case"mm":if(null!==h)return null;h=n;break;case"ss":if(null!==c)return null;c=n;break;case"ms":if(null!==l)return null;l=n;break;case"y":if(null!==p)return null;p=n;break;case"m":if(null!==d)return null;d=n;break;case"w":if(null!==g)return null;g=n;break;case"d":if(null!==f)return null;f=n;break;default:return null}e=e.substr(r[0].length)}return m&&""===e?(null!==p&&v.setFullYear(v.getFullYear()+i*p),null!==d&&v.setMonth(v.getMonth()+i*d),null!==g&&v.setDate(v.getDate()+7*i*g),null!==f&&v.setDate(v.getDate()+i*f),null!==u&&v.setHours(v.getHours()+i*u),null!==h&&v.setMinutes(v.getMinutes()+i*h),null!==c&&v.setSeconds(v.getSeconds()+i*c),null!==l&&v.setMilliseconds(v.getMilliseconds()+i*l),v):null}},{key:"stringToTime",value:function(t,n){if(""===(t=String(t||"").toLowerCase())||"now"===t)return new Date;t=this.COMMON_TIME_STRINGS[t]||t;var r=this.dateAdd(t);if(null!==r)return r;for(var i=e.DATE_FORMAT_MAPPINGS_FOR_STRING_TO_TIME_FUNCTION[n||"datemmddyyyy"]||e.DATE_FORMAT_MAPPINGS_FOR_STRING_TO_TIME_FUNCTION.datemmddyyyy,o=0,a=i.length;o<a;o++)try{if(r=this.parseDate(t,i[o]))return r}catch(s){}try{if(r=this.parseDate(t,"%H:%i:%S"))return r}catch(s){}try{if(r=this.parseDate(t,"%h:%i:%S %p"))return r}catch(s){}try{if(r=this.parseDate(t,"%H:%i %p"))return r}catch(s){}try{if(r=this.parseDate(t,"%H:%i"))return r}catch(s){}return null}},{key:"isHumanDateString",value:function(e){var t=String(e||"").toLowerCase();return"now"===t||void 0!==this.COMMON_TIME_STRINGS[t]}},{key:"getTranslatedTextIfExistsOrNullOtherwise",value:function(e,t){var n=e.translateText(t);return n===t?null:n}}],[{key:"createInstanceInNonSingletonModeWithoutInternationalizationSupport",value:function(){var t=new d.W;return t.setTranslations({LOGS_DateInternationalization:"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|January|February|March|April|May|June|July|August|September|October|November|December",LOGS_TimeInternationalization:"Few seconds ago|Few minutes ago|%t% minutes ago|%t% hours ago|Yesterday",dashboard_activityDateToday:"Today",dashboard_activityDateBeforeYesterday:"The day before yesterday",dashboard_activityDateThisWeek:"This week",dashboard_activityDateWeekBefore:"The week before",dashboard_activityDateThisMonth:"This month",dashboard_activityDateWeekXBefore:"Week%d"}),new e(t)}},{key:"dateEquals",value:function(e,t){return e===t||!(!e&&t||!t&&e)&&e.getTime()===t.getTime()}},{key:"createDateFromUTCTimestamp",value:function(e){var t=new Date,n=6e4*t.getTimezoneOffset();return null===e?t.setTime(t.getTime()+n):t.setTime(1e3*e+n),t}},{key:"getDateTimestampWithAppliedUTCCorrection",value:function(e){return e?Math.round((e.getTime()-6e4*e.getTimezoneOffset())/1e3):null}}]),e}();f()(p,"DATE_FORMAT_MAPPINGS_FOR_STRING_TO_TIME_FUNCTION",{dateyyyymmdd:["%Y/%m/%d","%Y-%m-%d","%Y.%m.%d"],dateddmmyyyy:["%d/%m/%Y","%d-%m-%Y","%d.%m.%Y"],datemmddyyyy:["%m/%d/%Y","%m-%d-%Y","%m.%d.%Y"],datemmyyyy:["%m/%Y","%m-%Y","%m.%Y"]})},90249:function(e,t,n){var r=n(73738),i=n.n(r),o=n(17383),a=n.n(o),s=n(34579),u=n.n(s),c=n(12475),l=n.n(c),h=n(29511),f=n.n(h),d=n(28452),p=n.n(d),g=n(63072),v=n.n(g),m=n(43693),y=n.n(m);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var E=function(e){f()(n,e);var t=b(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),y()(l()(e),"$",window.jQuery),y()(l()(e),"EVENTS",["click","change"]),y()(l()(e),"MAX_ITEMS_ALLOWED_ONCE",10),y()(l()(e),"stack",[]),y()(l()(e),"config",window.CFTracking||{}),y()(l()(e),"context",e.config.context||{}),y()(l()(e),"urlParams",e.getUrlParams(window.location.href)),y()(l()(e),"URL","".concat(document.baseURI,"ajax_tracker.php")),y()(l()(e),"debug",!1),y()(l()(e),"enabled",!0),y()(l()(e),"async",!0),e}return u()(n,[{key:"track",value:function(e,t,n){var r=this;if(!this.enabled)return!1;this.debug&&console.log("DEBUG-METRIC-TRACKER: queue metric: ".concat(e)),window.dataLayer&&-1!==e.indexOf("_chat_")&&window.dataLayer.push({event:"chat: ".concat(e),value:t,tags:n,url:window.location.href});var i={name:e,value:t||1};n&&(i.tags=n),this.push(i),setTimeout((function(){r.send()}),100)}},{key:"sendWithoutDelay",value:function(){return!!this.enabled&&(0===this.stack.length||(console.log("Sending queued tracker events"),this.async=!1,this.send(),this.async=!0),!0)}},{key:"push",value:function(e){var t,n=[],r="";if("object"===i()(e.tags)){for(var o in e.tags)e.tags.hasOwnProperty(o)&&n.push(o);n.sort();for(var a=0;a<n.length;a++)r+="|".concat(n[a]).concat(e.tags[n[a]])}t="|".concat(e.name).concat(e.value,"a79pZ").concat(r),e.xtk=D(t),this.stack.push(e)}},{key:"ucfirst",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"send",value:function(){var e=this;if(0!==this.stack.length){var t;t=this.stack.length>=this.MAX_ITEMS_ALLOWED_ONCE?this.stack.slice(0,this.MAX_ITEMS_ALLOWED_ONCE):this.stack.slice(0),this.stack.length=0,this.context.url=window.location.href;var n="".concat(this.URL,"?").concat(this.$.param(this.context));this.debug&&console.log("DEBUG-METRIC-TRACKER: sending ".concat(t.length," metrics --\x3e ").concat(t[0].name),t,this.context),"local.123contactform.com"!==location.hostname&&(this.$.ajax({url:n,async:this.async,type:"POST",cache:!1,complete:function(t){e.debug&&console.log("DEBUG-METRIC-TRACKER: ajax call response",t.responseText),"STOP"===t.responseText&&e.disable()},data:{data:t}}),window.dataLayer&&window.dataLayer.push({formEvent:t}))}else this.debug&&console.log("DEBUG-METRIC-TRACKER: send was called but stack is empty. Will do nothing!")}},{key:"disable",value:function(){this.enabled=!1}},{key:"loadFromDomWithDelegation",value:function(){var e=this,t=null;if(this.debug&&(t=(new Date).getTime()),this.$.each(this.EVENTS,(function(t,n){e.$("body").delegate("[data-track-".concat(n,"]"),n,(function(t){if(e.enabled){n=e.ucfirst(n);var r=e.$(e),i=r.data(),o=i["track".concat(n)],a=null;if(!i["tracked".concat(n)]){for(var s in i)if(0===s.indexOf("tag")){!1===a&&(a={});var u=i[s];if("string"===typeof u&&0===u.indexOf("->")){var c=u.match(/->(.+)\[(.+)\]/i);3==c.length&&(u=e.$(c[1]).data(c[2]))}a[s.replace("tag","")]=u}a?e.track(o,1,a):e.track(o,null,null),void 0===i.trackMultiple&&r.data("tracked-".concat(n),!0)}}}))})),this.debug){var n=(new Date).getTime(),r=n-t;console.log("DEBUG-METRIC-TRACKER: time spent in loadFromDomWithDelegation %c".concat(r,"ms"),"color: white; background-color: red")}}},{key:"getControlType",value:function(e){var t={"0_0":"Textbox","1_0":"Textarea","2_0":"Checkbox","2_1":"TOS","3_0":"Radio","4_0":"Dropdown","5_0":"Heading","6_1":"Name","6_2":"Address","6_3":"Phone","6_4":"Date","6_5":"Date","6_6":"Time","6_7":"Price","6_8":"HTMLBlock","6_9":"Upload","6_10":"GoogleMap","6_11":"Image","6_12":"SocialButtons","6_13":"PageBreak","6_15":"RatingStars","6_16":"DigitalSignature"};return t[e]?t[e]:"Unknown"}},{key:"getControlSubtype",value:function(e){var t={"0_0_5":"Number","0_0_7":"Email","0_0_14":"Password","0_0_8":"Website","3_0_1":"Likertscale"};return!!t[e]&&t[e]}},{key:"getUrlParams",value:function(e){if(!e)return{};var t,n,r=e.indexOf("?"),i=e.indexOf("#"),o=e.substring(r>-1?r+1:0,i>-1?i:e.length).split("&"),a={};for(n=0;n<o.length;n++)a[(t=o[n].split("="))[0]]=t[1];return a}},{key:"trackPerf",value:function(){var e,t;if((null===(e=this.config)||void 0===e?void 0:e.perfData)&&(t=this.context.p?this.context.p:this.urlParams.p&&this.urlParams.p.length?this.urlParams.p:window.location.pathname.replace(/\/(.+)\.html/g,"$1")).length){var n,r={page:t,__mtype:"t"},i=this.config.prefix||"";if("undefined"!==typeof window.performance&&"undefined"!==typeof window.performance.navigation)switch(window.performance.navigation.type){case 0:r.navType="user_action";break;case 1:r.navType="refresh";break;case 2:r.navType="back_fwd"}for(var o in this.config.perfData)this.config.perfData.hasOwnProperty(o)&&(n={name:i+o,value:this.config.perfData[o],tags:r},this.push(n));"undefined"!==typeof window.performance&&"undefined"!==typeof window.performance.timing&&("undefined"!==typeof window.performance.timing.responseEnd&&"undefined"!==typeof window.performance.timing.fetchStart&&(n={name:"".concat(i,"network_latency"),value:window.performance.timing.responseEnd-window.performance.timing.fetchStart,tags:r},this.push(n)),"undefined"!==typeof window.performance.timing.loadEventEnd&&"undefined"!==typeof window.performance.timing.responseEnd&&(n={name:"".concat(i,"windowload_perf"),value:window.performance.timing.loadEventEnd-window.performance.timing.responseEnd,tags:r},this.push(n)),"undefined"!==typeof window.performance.timing.domContentLoadedEventStart&&"undefined"!==typeof window.performance.timing.responseEnd&&(n={name:"".concat(i,"domready_perf"),value:window.performance.timing.domContentLoadedEventStart-window.performance.timing.responseEnd,tags:r},this.push(n)),"undefined"!==typeof window.performance.memory&&"undefined"!==typeof window.performance.memory.usedJSHeapSize&&(n={name:"".concat(i,"js_memory_perf"),value:window.performance.memory.usedJSHeapSize,tags:{page:t,__mtype:"g"}},this.push(n))),this.stack.length&&this.send()}}},{key:"addEventListener",value:function(e,t,n){var r,i,o=arguments,a=this;return e.addEventListener?(e.addEventListener(t,n,!1),!0):e.attachEvent?e.attachEvent("on".concat(t),n):("function"===typeof e[t="on".concat(t)]&&(r=e[t],i=n,n=function(){r.apply(a,o),i.apply(a,o)}),e[t]=n,!0)}},{key:"init",value:function(){var e=this;this.debug&&console.log("DEBUG-METRIC-TRACKER: init"),this.config.perf&&(this.config.perfData={},this.addEventListener(window.document,"DOMContentLoaded",(function(){e.config.perfData.domready=Date.now()-e.config.start})),this.addEventListener(window,"load",(function(){e.config.perfData.windowload=Date.now()-e.config.start,setTimeout(e.trackPerf,4)}))),this.$((function(){setTimeout((function(){e.loadFromDomWithDelegation()}),1)}))}},{key:"event",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.enabled&&this.track(e,1,t)}},{key:"timing",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.__mtype="t",this.enabled&&this.track(e,t,n)}},{key:"trackControlProperty",value:function(e,t){if(this.enabled){var n={};n.ControlType=t,n.ControlSubtype=t,this.track(e,1,n)}}},{key:"trackControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.enabled){var r=t.split("_"),i=this.getControlType("".concat(r[0],"_").concat(r[1])),o=this.getControlSubtype(t);o&&(n.subtype=o),e+=".".concat(i),this.track(e,1,n)}}}]),n}(n(87373).K);function w(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];n=N(n,r,i,o,t[0],7,-680876936),o=N(o,n,r,i,t[1],12,-389564586),i=N(i,o,n,r,t[2],17,606105819),r=N(r,i,o,n,t[3],22,-1044525330),n=N(n,r,i,o,t[4],7,-176418897),o=N(o,n,r,i,t[5],12,1200080426),i=N(i,o,n,r,t[6],17,-1473231341),r=N(r,i,o,n,t[7],22,-45705983),n=N(n,r,i,o,t[8],7,1770035416),o=N(o,n,r,i,t[9],12,-1958414417),i=N(i,o,n,r,t[10],17,-42063),r=N(r,i,o,n,t[11],22,-1990404162),n=N(n,r,i,o,t[12],7,1804603682),o=N(o,n,r,i,t[13],12,-40341101),i=N(i,o,n,r,t[14],17,-1502002290),n=k(n,r=N(r,i,o,n,t[15],22,1236535329),i,o,t[1],5,-165796510),o=k(o,n,r,i,t[6],9,-1069501632),i=k(i,o,n,r,t[11],14,643717713),r=k(r,i,o,n,t[0],20,-373897302),n=k(n,r,i,o,t[5],5,-701558691),o=k(o,n,r,i,t[10],9,38016083),i=k(i,o,n,r,t[15],14,-660478335),r=k(r,i,o,n,t[4],20,-405537848),n=k(n,r,i,o,t[9],5,568446438),o=k(o,n,r,i,t[14],9,-1019803690),i=k(i,o,n,r,t[3],14,-187363961),r=k(r,i,o,n,t[8],20,1163531501),n=k(n,r,i,o,t[13],5,-1444681467),o=k(o,n,r,i,t[2],9,-51403784),i=k(i,o,n,r,t[7],14,1735328473),n=R(n,r=k(r,i,o,n,t[12],20,-1926607734),i,o,t[5],4,-378558),o=R(o,n,r,i,t[8],11,-2022574463),i=R(i,o,n,r,t[11],16,1839030562),r=R(r,i,o,n,t[14],23,-35309556),n=R(n,r,i,o,t[1],4,-1530992060),o=R(o,n,r,i,t[4],11,1272893353),i=R(i,o,n,r,t[7],16,-155497632),r=R(r,i,o,n,t[10],23,-1094730640),n=R(n,r,i,o,t[13],4,681279174),o=R(o,n,r,i,t[0],11,-358537222),i=R(i,o,n,r,t[3],16,-722521979),r=R(r,i,o,n,t[6],23,76029189),n=R(n,r,i,o,t[9],4,-640364487),o=R(o,n,r,i,t[12],11,-421815835),i=R(i,o,n,r,t[15],16,530742520),n=S(n,r=R(r,i,o,n,t[2],23,-995338651),i,o,t[0],6,-198630844),o=S(o,n,r,i,t[7],10,1126891415),i=S(i,o,n,r,t[14],15,-1416354905),r=S(r,i,o,n,t[5],21,-57434055),n=S(n,r,i,o,t[12],6,1700485571),o=S(o,n,r,i,t[3],10,-1894986606),i=S(i,o,n,r,t[10],15,-1051523),r=S(r,i,o,n,t[1],21,-2054922799),n=S(n,r,i,o,t[8],6,1873313359),o=S(o,n,r,i,t[15],10,-30611744),i=S(i,o,n,r,t[6],15,-1560198380),r=S(r,i,o,n,t[13],21,1309151649),n=S(n,r,i,o,t[4],6,-145523070),o=S(o,n,r,i,t[11],10,-1120210379),i=S(i,o,n,r,t[2],15,718787259),r=S(r,i,o,n,t[9],21,-343485551),e[0]=I(n,e[0]),e[1]=I(r,e[1]),e[2]=I(i,e[2]),e[3]=I(o,e[3])}function T(e,t,n,r,i,o){return t=I(I(t,e),I(r,o)),I(t<<i|t>>>32-i,n)}function N(e,t,n,r,i,o,a){return T(t&n|~t&r,e,t,i,o,a)}function k(e,t,n,r,i,o,a){return T(t&r|n&~r,e,t,i,o,a)}function R(e,t,n,r,i,o,a){return T(t^n^r,e,t,i,o,a)}function S(e,t,n,r,i,o,a){return T(n^(t|~r),e,t,i,o,a)}function C(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function O(e){for(var t="0123456789abcdef".split(""),n="",r=0;r<4;r++)n+=t[e>>8*r+4&15]+t[e>>8*r&15];return n}function D(e){return function(e){for(var t=0;t<e.length;t++)e[t]=O(e[t]);return e.join("")}(function(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)w(r,C(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(w(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,w(r,i),r}(e))}var I=function(e,t){return e+t&4294967295};"5d41402abc4b2a76b9719d911017c592"!=D("hello")&&(I=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}),t.A=E},59511:function(e,t,n){n.d(t,{H:function(){return u}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(5414),u=function(){function e(){i()(this,e)}return a()(e,[{key:"setCookie",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.XG.COOKIE_SAME_SITE_LAX,a=new Date,u=60*i*1e3+24*r*60*60*1e3,c=e.computeSameSiteDirective(o);a.setTime(a.getTime()+u),e.browserSetCookie("".concat(t,"=").concat(n,";expires=").concat(a.toUTCString(),";SameSite=").concat(c,";path=/"))}},{key:"setSessionCookie",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.XG.COOKIE_SAME_SITE_LAX,i=e.computeSameSiteDirective(r);e.browserSetCookie("".concat(t,"=").concat(n,";SameSite=").concat(i,";path=/"))}},{key:"deleteCookie",value:function(t){e.browserSetCookie("".concat(t,"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"))}},{key:"getCookie",value:function(e){for(var t="".concat(e,"="),n=document.cookie.split("; "),r=0;r<n.length;r++){var i=n[r];if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}},{key:"checkCookie",value:function(e){return""!==this.getCookie(e)}}],[{key:"browserSetCookie",value:function(e){document.cookie=e}},{key:"computeSameSiteDirective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.XG.COOKIE_SAME_SITE_LAX;return e===s.XG.COOKIE_SAME_SITE_NONE?"".concat(s.XG.COOKIE_SAME_SITE_NONE,";Secure"):e}}]),e}()},61978:function(e,t,n){n.d(t,{Q:function(){return b}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(12475),u=n.n(s),c=n(29511),l=n.n(c),h=n(28452),f=n.n(h),d=n(63072),p=n.n(d),g=n(43693),v=n.n(g),m=n(88468);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var b=function(e){l()(n,e);var t=y(n);function n(e,r){var o;if(i()(this,n),o=t.call(this),v()(u()(o),"jq",void 0),v()(u()(o),"cache",{}),v()(u()(o),"started",{}),v()(u()(o),"loadedJS",{}),v()(u()(o),"metricsService",m.Z.getInstance()),o.jq=e,r)for(var a in r)r.hasOwnProperty(a)&&o.preloadResource(a,r[a]);return o}return a()(n,[{key:"preloadResource",value:function(e,t){this.cache[e]=t}},{key:"isPageNotFoundBuffer",value:function(e){return e&&"string"===typeof e&&e.indexOf('data-page-name="404error">')>-1}},{key:"getWithPromise",value:function(e){var t=this;return new Promise((function(n,r){t.get(e).then((function(e){n(e)})).fail((function(e){r(e)}))}))}},{key:"get",value:function(e){if(!e||"string"!==typeof e)throw new Error("Invalid argument: non-empty string expected!");return"undefined"!==typeof window.DEP123_URL_BASE_PATH&&""!==window.DEP123_URL_BASE_PATH&&(e.startsWith("//")||e.startsWith("http://")||e.startsWith("https://")||(e=window.DEP123_URL_BASE_PATH+(e.startsWith("/")?"":"/")+e)),function(t,n){return void 0!==t.cache[e]?n.Deferred((function(n){n.resolve(t.cache[e])})).promise():t.started[e]?n.Deferred((function(n){t.on("fetch_".concat(e),(function(){n.resolve(t.cache[e])})),t.on("error_".concat(e),(function(){n.reject(new Error('Failed fetching resource: "'.concat(e,'"')))}))})).promise():(t.started[e]=(new Date).toString(),n.Deferred((function(r){var i=-1===e.indexOf("?")?"".concat(e,"?_=").concat(+new Date):"".concat(e,"&_=").concat(+new Date);n.get(i).then((function(n){if(t.isPageNotFoundBuffer(n))return r.reject(new Error("Resource ".concat(e," seems to be a not-found page!"))),t.trigger("error_".concat(e)),t.off("fetch_".concat(e)),void t.off("error_".concat(e));t.cache[e]=n,delete t.started[e],r.resolve(t.cache[e]),t.trigger("fetch_".concat(e)),t.off("fetch_".concat(e)),t.off("error_".concat(e))})).fail((function(){t.metricsService.event("editor_load_resource_error"),r.reject(new Error('Failed fetching resource: "'.concat(e,'"'))),t.trigger("error_".concat(e)),t.off("fetch_".concat(e)),t.off("error_".concat(e))}))})).promise())}(this,this.jq)}},{key:"loadJavascript",value:function(e){return function(t,n){return n.loadedJS[e]?t.Deferred((function(e){e.resolve(!0)})).promise():t.Deferred((function(t){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),r.onload=function(){t.resolve(!0)},r.onerror=function(){n.metricsService.event("editor_load_resource_error"),t.reject(new Error('Failed to load external javascript: "'.concat(e,'"')))},document.getElementsByTagName("head")[0].appendChild(r)})).promise()}(this.jq,this)}}]),n}(n(36356).b)},56087:function(e,t,n){n.d(t,{M:function(){return f}});var r=n(73738),i=n.n(r),o=n(17383),a=n.n(o),s=n(34579),u=n.n(s),c=n(43693),l=n.n(c),h=n(89478),f=function(){function e(){a()(this,e)}return u()(e,[{key:"NOT",value:function(e){return!e}}],[{key:"DATE_DIFF",value:function(t,n,r){void 0===r&&(r=e.DEFAULT_JQL_DATE_FORMAT);var i=e.timeUtils.parseDate(t,r),o=e.timeUtils.parseDate(n,r),a=i.getTime(),s=o.getTime();return Math.ceil(Math.abs(s-a)/864e5)}},{key:"DATE_BETWEEN",value:function(t,n,r,i){void 0===i&&(i=e.DEFAULT_JQL_DATE_FORMAT);var o=e.timeUtils.parseDate(n,i),a=e.timeUtils.parseDate(r,i),s=e.timeUtils.parseDate(t,i),u=o.getTime(),c=a.getTime(),l=s.getTime();return l>=Math.min(u,c)&&l<=Math.max(u,c)}},{key:"DATE_FORMAT",value:function(t,n,r){void 0===n&&(n=e.DEFAULT_JQL_DATE_FORMAT),void 0===r&&(r=e.DEFAULT_JQL_DATE_FORMAT),""===t&&(t=r.replace("%Y","1970").replace("%m","01").replace("%d","01"));var i=e.timeUtils.parseDate(t,r);return e.timeUtils.formatTime(Math.floor(i.getTime()/1e3),n)}},{key:"DATE_GET_NUMBER_OF_DAYS",value:function(t,n){void 0===n&&(n=e.DEFAULT_JQL_DATE_FORMAT);try{var r=t?e.timeUtils.parseDate(t,n):new Date;if(!r)return 0;var i=r.getMonth(),o=r.getDate(),a=r.getFullYear(),s=0===a%4;return 365*(a-1)+~~(a/4)+e.DAYS_MAPPINGS[i]+o+(s&&i<2?-1:0)}catch(u){return 0}}},{key:"TIME_GET_NUMBER_OF_MINUTES",value:function(t,n){void 0===n&&(n=e.DEFAULT_JQL_TIME_FORMAT);var r=t?e.timeUtils.parseDate(t,n):new Date;return r?60*r.getHours()+r.getMinutes():0}},{key:"CURRENT_DATE",value:function(t){var n=new Date;return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),e.timeUtils.formatTime(Math.floor(n.getTime()/1e3),t||e.DEFAULT_JQL_DATE_FORMAT)}},{key:"DATE_COMPARE",value:function(t,n,r){var i=e.timeUtils.parseDate(t,r||e.DEFAULT_JQL_DATE_FORMAT),o=e.timeUtils.parseDate(n,r||e.DEFAULT_JQL_DATE_FORMAT),a=i.getTime(),s=o.getTime();return a===s?0:a<s?-1:1}},{key:"TIME_COMPARE",value:function(t,n,r){if(""===t)return-1;var i=e.timeUtils.stringToTime(t,r||e.DEFAULT_JQL_DATE_FORMAT),o=e.timeUtils.stringToTime(n,r||e.DEFAULT_JQL_DATE_FORMAT),a=i.getTime(),s=o.getTime();return a===s?0:a<s?-1:1}},{key:"DATE_ADD_INTERVAL",value:function(t,n,r){var i,o,a,s=e.timeUtils.parseDate(t,r||e.DEFAULT_JQL_DATE_FORMAT),u=0,c=null,l=null,h=null,f=null,d=null,p=null,g=null,v=String(n||"").toLowerCase();for(["-","+"].indexOf(i=v.substr(0,1))>-1&&(u="-"===i?-1:1,v=v.substr(1));o=/^([\s]+)?([1-9]([\d]+)?)([\s]+)?(day(s)?|month(s)?|year(s)?|hour(s)?|minute(s)?|second(s)?|millisecond(s)?)([\s]+)?/.exec(v);)switch(v=v.substr(o[0].length),a=~~o[2],o[5]){case"day":case"days":c=null===c?a:c+a;break;case"month":case"months":l=null===l?a:l+a;break;case"year":case"years":h=null===h?a:h+a;break;case"hour":case"hours":f=null===f?a:f+a;break;case"minute":case"minutes":d=null===d?a:d+a;break;case"second":case"seconds":p=null===p?a:p+a;break;case"millisecond":case"milliseconds":g=null===g?a:g+a}return null!==g&&s.setMilliseconds(s.getMilliseconds()+u*g),null!==p&&s.setSeconds(s.getSeconds()+u*p),null!==d&&s.setMinutes(s.getMinutes()+u*d),null!==f&&s.setHours(s.getHours()+u*f),null!==c&&s.setDate(s.getDate()+u*c),null!==l&&s.setMonth(s.getMonth()+u*l),null!==h&&s.setFullYear(s.getFullYear()+u*h),e.timeUtils.formatTime(Math.floor(s.getTime()/1e3),r||e.DEFAULT_JQL_DATE_FORMAT)}},{key:"CONCAT",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t?t.join(""):""}},{key:"SUM",value:function(){for(var e,t=0,n=0,r=arguments.length;n<r;n++)e=parseFloat(n<0||arguments.length<=n?void 0:arguments[n]),!isNaN(e)&&isFinite(e)&&(t+=e);return t}},{key:"EQUALS",value:function(e,t){return e==t}},{key:"COMPARE",value:function(e,t){var n,r,o,a,s,u,c;return null===e&&null===t?0:null===e?-2:(!1===e&&(e="0"),!1!==t&&null!==t||(t="0"),!0===e&&(e="1"),!0===t&&(t="1"),"string"===(r=i()(e))||"string"===(o=i()(t))?(a="string"===r?e.toLowerCase():String(e).toLowerCase(),s="string"===o?t.toLowerCase():String(t).toLowerCase(),u=parseFloat(a),c=parseFloat(s),n=isFinite(u)&&isFinite(c)?u===c?0:u<c?-1:1:a===s?0:a<s?-1:1):n=e===t?0:e<t?-1:1,n)}},{key:"IF",value:function(e,t,n){return e?t:n}},{key:"BOOL",value:function(e){return"0"!==e&&e!==1/0||(e=~~e),!!e}},{key:"INT",value:function(t){if(e.BOOL(t)){var n=parseInt(String(t));return!isNaN(n)&&isFinite(n)?n:0}return 0}},{key:"FLOAT",value:function(t){if(e.BOOL(t)){var n=parseFloat(String(t));return!isNaN(n)&&isFinite(n)?n:0}return 0}},{key:"STRING",value:function(e){switch(e){case!1:return"false";case null:return"null";case 0:return"0";default:return String(e||"")}}},{key:"FROM_BASE64",value:function(e){return atob(e)}},{key:"TO_BASE64",value:function(e){return btoa(e)}},{key:"REPLACE",value:function(e,t,n){if(!t)return e;var r=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),i=new RegExp(r,"ig");return String(e).replace(i,String(n))}},{key:"ALERT",value:function(){for(var t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r.length;o<a;o++)(r[o]||0===r[o])&&t.push(String(r[o]));return t.length&&e.INTERFACE_ENABLED&&setTimeout((function(){alert(t.join(" "))}),100),t.length?t.join(" "):null}},{key:"UNIQUE_ID_BASED_ON_DATE_MILISECOND",value:function(){return(+new Date).toString(36)}},{key:"IN",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o;if(!r||!(o=r.length))return!1;for(var a=0;a<o;a++)if(0===e.COMPARE(t,r[a]))return!0;return!1}},{key:"onInterfaceEnabled",value:function(){e.INTERFACE_ENABLED=!0}}]),e}();l()(f,"timeUtils",void 0),l()(f,"DEFAULT_JQL_DATE_FORMAT","%Y-%m-%d"),l()(f,"DEFAULT_JQL_TIME_FORMAT","%H:%i:%s"),l()(f,"INTERFACE_ENABLED",!1),l()(f,"DAYS_MAPPINGS",[0,31,59,90,120,151,181,212,243,273,304,334]),f.timeUtils=h.R.createInstanceInNonSingletonModeWithoutInternationalizationSupport()},11554:function(e,t,n){n.d(t,{r:function(){return Mn}});var r=n(73738),i=n.n(r),o=n(17383),a=n.n(o),s=n(34579),u=n.n(s),c=n(12475),l=n.n(c),h=n(29511),f=n.n(h),d=n(28452),p=n.n(d),g=n(63072),v=n.n(g),m=n(43693),y=n.n(m),b=n(36356),E=n(62768),w=n(23073),T=n.n(w),N=n(42395);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var R=function(){function e(){a()(this,e)}return u()(e,null,[{key:"create",value:function(e,t,n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},{action:e,auth:t},{},n)}}]),e}(),S=n(34919),C=n(6626),O=function(){function e(){a()(this,e),y()(this,"affectedRows",void 0),y()(this,"affectingRows",!1),y()(this,"calcFoundRows",void 0)}return u()(e,[{key:"getAffectedRows",value:function(){return this.affectedRows}},{key:"withAffectedRows",value:function(e){return this.affectedRows=~~e,this}},{key:"withCalcFoundRows",value:function(e){return this.calcFoundRows=e,this}},{key:"getCalcFoundRows",value:function(){return this.calcFoundRows}},{key:"hasRows",value:function(){return!1}},{key:"getRows",value:function(){return[]}},{key:"getRowsAsArray",value:function(){return[]}}]),e}(),D=function(){function e(t,n,r){a()(this,e),y()(this,"statement",void 0),y()(this,"db",void 0),y()(this,"markedRowsForDelete",void 0),y()(this,"bindings",void 0),this.statement=t,this.db=n,this.bindings=r}return u()(e,[{key:"execute",value:function(){var e=this;return function(){return new Promise((function(t,n){try{e.statement.bind(e.bindings,e.db)}catch(r){return void n(r)}e.db.getTable(e.statement.getTable().getName()).fetch().then((function(i){i.isTransactional()&&i.startTransaction();try{e.markedRowsForDelete=[];for(var o,a=i.createIterator(),s=e.statement.getFilter();o=a.next();)(null===s||!!s.compute(o))&&e.markedRowsForDelete.push({rowIndex:o.getRowIndex(),values:o.getDataAsArray()});if(!e.markedRowsForDelete.length)return i.isTransactional()&&i.commitTransaction(),void t((new O).withAffectedRows(0));if(e.applySorting(),e.applyLimits(),!e.markedRowsForDelete.length)return i.isTransactional()&&i.commitTransaction(),void t((new O).withAffectedRows(0));for(var u=0,c=e.markedRowsForDelete.length;u<c;u++)i.deleteRow(e.markedRowsForDelete[u].rowIndex);i.compact(),i.isTransactional()&&i.commitTransaction(),t((new O).withAffectedRows(e.markedRowsForDelete.length))}catch(r){console.error(r),i.isTransactional()&&i.rollbackTransaction(),n(new Error("Failed to execute DELETE statement!"))}})).catch((function(e){console.error(e),n(new Error("Failed to fetch table from server!"))}))}))}}},{key:"applySorting",value:function(){var e=this.statement.getSorter(),t=this.db.getTable(this.statement.getTable().getName());if(e&&!(this.markedRowsForDelete.length<2)){if(e.isRandom())return S.b.shuffleArray(this.markedRowsForDelete);var n=e.getSortExpressions(),r=n.length,i=function(){for(var e=[],i=0;i<r;i++)i===r-1?e.push(function(e){return function(t,r){var i=n[e].getExpression().compute(t),o=n[e].getExpression().compute(r),a=S.b.compare(i,o);return n[e].getDirection()===E.DQ.DESCENDING&&(a=-a),a}}(i)):e.push(function(t){return function(r,i){var o=n[t].getExpression().compute(r),a=n[t].getExpression().compute(i),s=S.b.compare(o,a);return n[t].getDirection()===E.DQ.DESCENDING&&(s=-s),0===s?e[t+1](r,i):s}}(i));return function(n,r){return e[0](C.C.createFromTable(t).withRowData(n.values).withIndex(-1),C.C.createFromTable(t).withRowData(r.values).withIndex(-1))}}();this.markedRowsForDelete.sort(i)}}},{key:"applyLimits",value:function(){var e=this.statement.getLimit();e&&(this.markedRowsForDelete=this.markedRowsForDelete.slice(e.getSkip(),e.getSkip()+e.getLimit()))}}]),e}(),I=function(){function e(t,n,r){a()(this,e),y()(this,"statement",void 0),y()(this,"db",void 0),y()(this,"bindings",void 0),this.statement=t,this.db=n,this.bindings=r}return u()(e,[{key:"execute",value:function(){var e=this;return function(){return new Promise((function(t,n){try{e.statement.bind(e.bindings,e.db)}catch(r){return void n(r)}e.db.getTable(e.statement.getTable().getName()).fetch().then((function(i){i.isTransactional()&&i.startTransaction();try{for(var o=C.C.createFromTable(i),a=0,s=e.statement.getFields(),u=s.length;a<u;a++)o.setColumnValue(s[a].getFieldName(),s[a].getExpression().compute(o));i.insertRow(o.getDataAsArray()),i.reIndex(),i.commitTransaction(),t((new O).withAffectedRows(1))}catch(r){i.isTransactional()&&i.rollbackTransaction(),console.error(r),n(new Error("Failed to execute INSERT statement"))}})).catch((function(e){console.error(e),n(new Error("Failed to fetch table from server!"))}))}))}}}]),e}(),A=n(85715),_=n.n(A),x=n(76075);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var L=function(e){f()(n,e);var t=M(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),y()(l()(e),"lastInsertId",void 0),e}return u()(n,[{key:"getLastInsertId",value:function(){return this.lastInsertId}},{key:"withLastInsertId",value:function(e){return this.lastInsertId=e,this}}]),n}(O);function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var B=function(e){f()(n,e);var t=F(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),y()(l()(e),"rows",[]),e}return u()(n,[{key:"addRows",value:function(e){if(e&&e.length)for(var t=0,n=e.length;t<n;t++)this.rows.push(e[t]);return this}},{key:"hasRows",value:function(){return!0}},{key:"getAffectedRows",value:function(){return this.rows.length}},{key:"getRows",value:function(){return this.rows}},{key:"getRowsAsArray",value:function(){if(!this.rows||!this.rows.length)return[];for(var e,t,n,r,i=[],o=0,a=this.rows.length;o<a;o++){n=[],t=(e=Object.keys(this.rows[o])).length;for(var s=0;s<t;s++)void 0===(r=this.rows[o][e[s]])&&(r=null),n.push(r);i.push(n)}return i}}]),n}(O),P=function(){function e(t,n,r){a()(this,e),y()(this,"statement",void 0),y()(this,"db",void 0),y()(this,"bindings",void 0),this.statement=t,this.db=n,this.bindings=r}return u()(e,[{key:"execute",value:function(){var e=this;return function(){return new Promise((function(t,n){try{e.statement.bind(e.bindings,e.db)}catch(u){return void n(u)}var r=-1!==e.statement.getTable().name.indexOf("salesforcePrefill")?e.db.getRPCEndpointSalesforceName():e.db.getRPCEndpointName(),i=-1!==e.statement.getTable().name.indexOf("salesforcePrefill")?e.db.getAuthorizationTokenSalesforce():e.db.getAuthorizationToken(),o=e.statement.getBindingData()||[],a=Object.entries(o).map((function(e){var t=_()(e,2),n=t[0],r=t[1];return{controlId:n,value:null===r?"":r}})),s=R.create("query",i,{query:btoa(JSON.stringify(e.statement.getTokenizedStatement())),bindings:btoa((0,x.wR)(JSON.stringify(o))),applicationConfig:btoa(e.db.getApplicationConfig()),affectedControls:btoa((0,x.wR)(JSON.stringify(a)))});S.b.makeRequest(r,S.b.REQUEST_METHOD_POST,S.b.REQUEST_CONTENT_TYPE_X_WWW_FORM_URLENCODED,S.b.REQUEST_RESPONSE_TYPE_JSON,S.b.encodeData(s)).then((function(n){t(e.createStatementResult(n))})).catch((function(e){n(new Error(e))}))}))}}},{key:"createStatementResult",value:function(e){if(e){if(!T()(e,Object))throw new Error("Object expected!");if(void 0===e.resultType)throw new Error('Property "resultType" expected!');switch(e.resultType){case E.ko.SELECT:var t=new B;return t.addRows(e.rows),t.withCalcFoundRows(e.foundRows),t;case E.ko.UPDATE:var n=new O;return n.withAffectedRows(parseInt(e.affectedRows)||0),n;case E.ko.INSERT:var r=new L;return r.withLastInsertId(parseInt(e.lastInsertId)||0),r.withAffectedRows(1),r;case E.ko.DELETE:var i=new O;return i.withAffectedRows(parseInt(e.affectedRows)||0),i;default:throw new Error("Invalid server response resultType: ".concat(JSON.stringify(e.resultType)))}}}}]),e}(),U=function(){function e(t,n,r){a()(this,e),y()(this,"statement",void 0),y()(this,"db",void 0),y()(this,"bindings",void 0),this.statement=t,this.db=n,this.bindings=r}return u()(e,[{key:"execute",value:function(){var t=this;return function(){return new Promise((function(n,r){try{t.statement.bind(t.bindings,t.db)}catch(a){return void r(a)}var i;if(t.statement.getTable())t.db.getTable(t.statement.getTable().getName()).fetch().then((function(o){try{i=t.applyLimit(t.applyColumnFiltering(t.applySorting(t.getStatementCandidateRows(o))));var s=(new B).addRows(i);t.statement.getUnion()?new e(t.statement.getUnion(),t.db,t.bindings).execute()().then((function(e){s.addRows(e.getRows()),n(s)})).catch((function(e){r(e)})):n(s)}catch(a){console.error(a),r(new Error("Failed to execute SELECT statement!"))}})).catch((function(e){console.error(e),r(new Error("Failed to fetch table from server!"))}));else try{i=[t.createSingleStatementRow()];var o=(new B).addRows(i);t.statement.getUnion()?new e(t.statement.getUnion(),t.db,t.bindings).execute()().then((function(e){o.addRows(e.getRows()),n(o)})).catch((function(e){r(e)})):n(o)}catch(a){console.error(a),r(new Error("Failed to execute INSERT statement!"))}}))}}},{key:"createSingleStatementRow",value:function(){var e,t,n=Object.create(null),r=new C.C([],[],0),i=this.statement.getFields();if(i.isSelectingAllFields())return n;for(var o=0,a=i.getFields(),s=a.length;o<s;o++)t=a[o].getLiteral(),e=a[o].getExpression().compute(r),null===t&&(t=a[o].getExpression().getLiteral()),n[t]=e;return n}},{key:"getStatementCandidateRows",value:function(e){var t,n,r,i,o,a,s=e.createIterator(),u=[],c=this.statement.getFields(),l=c.isSelectingAllFields(),h=c,f=this.statement.getFilter();for(l||(n=h.getFields());t=s.next();)if(!f||!!f.compute(t))if(l)u.push(t.toObject());else{r=Object.create(null);for(var d=0,p=n.length;d<p;d++)a=n[d].getLiteral(),o=n[d].getExpression().compute(t),null===a&&(a=n[d].getExpression().getLiteral()),r[a]=o;for(var g in(i=t.toObject())["."]=r,r)i[g]=r[g];u.push(i)}return u}},{key:"applySorting",value:function(e){var t=this.statement.getSorter();if(!t||e.length<2)return e;if(t.isRandom())return S.b.shuffleArray(e);var n=t.getSortExpressions(),r=n.length,i=function(){for(var e=[],t=0;t<r;t++)t===r-1?e.push(function(e){return function(t,r){var i=n[e].getExpression().compute(t),o=n[e].getExpression().compute(r),a=S.b.compare(i,o);return n[e].getDirection()===E.DQ.DESCENDING&&(a=-a),a}}(t)):e.push(function(t){return function(r,i){var o=n[t].getExpression().compute(r),a=n[t].getExpression().compute(i),s=S.b.compare(o,a);return n[t].getDirection()===E.DQ.DESCENDING&&(s=-s),0===s?e[t+1](r,i):s}}(t));return function(t,n){return e[0](C.C.createFromObject(t),C.C.createFromObject(n))}}();return e.sort(i)}},{key:"applyLimit",value:function(e){var t=this.statement.getLimit();return t?e.slice(t.getSkip(),t.getSkip()+t.getLimit()):e}},{key:"applyColumnFiltering",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(void 0===e[n]["."]?e[n]:e[n]["."]);return t}}]),e}(),H=function(){function e(t,n,r){a()(this,e),y()(this,"statement",void 0),y()(this,"db",void 0),y()(this,"markedRowsForUpdate",void 0),y()(this,"bindings",void 0),this.statement=t,this.db=n,this.bindings=r}return u()(e,[{key:"execute",value:function(){var e=this;return function(){return new Promise((function(t,n){try{e.statement.bind(e.bindings,e.db)}catch(r){return void n(r)}e.db.getTable(e.statement.getTable().getName()).fetch().then((function(i){i.isTransactional()&&i.startTransaction();try{e.markedRowsForUpdate=[];for(var o,a=i.createIterator(),s=e.statement.getFilter();o=a.next();)(null===s||!!s.compute(o))&&e.markedRowsForUpdate.push({rowIndex:o.getRowIndex(),values:o.getDataAsArray()});if(!e.markedRowsForUpdate.length)return i.isTransactional()&&i.commitTransaction(),void t((new O).withAffectedRows(0));if(e.applySorting(),e.applyLimits(),!e.markedRowsForUpdate.length)return i.isTransactional()&&i.commitTransaction(),void t((new O).withAffectedRows(0));for(var u,c,l=(new O).withAffectedRows(e.markedRowsForUpdate.length),h=C.C.createFromTable(i),f=e.statement.getFields(),d=f.length,p=0,g=e.markedRowsForUpdate.length;p<g;p++){h.withIndex(e.markedRowsForUpdate[p].rowIndex).withRowData(e.markedRowsForUpdate[p].values);for(var v=0;v<d;v++)u=f[v].getFieldName(),c=f[v].getExpression().compute(h),h.setColumnValue(u,c);i.replace(e.markedRowsForUpdate[p].rowIndex,h.getDataAsArray())}i.reIndex(),i.isTransactional()&&i.commitTransaction(),t(l)}catch(r){console.error(r),i.isTransactional()&&i.rollbackTransaction(),n(new Error("Failed to execute UPDATE statement!"))}})).catch((function(e){console.error(e),n(new Error("Failed to fetch table from server!"))}))}))}}},{key:"applySorting",value:function(){var e=this.statement.getSorter(),t=this.db.getTable(this.statement.getTable().getName());if(e&&!(this.markedRowsForUpdate.length<2)){if(e.isRandom())return S.b.shuffleArray(this.markedRowsForUpdate);var n=e.getSortExpressions(),r=n.length,i=function(){for(var e=[],i=0;i<r;i++)i===r-1?e.push(function(e){return function(t,r){var i=n[e].getExpression().compute(t),o=n[e].getExpression().compute(r),a=S.b.compare(i,o);return n[e].getDirection()===E.DQ.DESCENDING&&(a=-a),a}}(i)):e.push(function(t){return function(r,i){var o=n[t].getExpression().compute(r),a=n[t].getExpression().compute(i),s=S.b.compare(o,a);return n[t].getDirection()===E.DQ.DESCENDING&&(s=-s),0===s?e[t+1](r,i):s}}(i));return function(n,r){return e[0](C.C.createFromTable(t).withRowData(n.values).withIndex(-1),C.C.createFromTable(t).withRowData(r.values).withIndex(-1))}}();this.markedRowsForUpdate.sort(i)}}},{key:"applyLimits",value:function(){var e=this.statement.getLimit();e&&(this.markedRowsForUpdate=this.markedRowsForUpdate.slice(e.getSkip(),e.getSkip()+e.getLimit()))}}]),e}(),V=n(19477),G=n(82911),j=function(){function e(t){a()(this,e),y()(this,"queryId",0),y()(this,"database",void 0),y()(this,"queue",[]),y()(this,"isRunning",!1),this.database=t}return u()(e,[{key:"scheduleStatement",value:function(e,t){var n=this;return(0,V.A)(this.queue,(function(t){return t.statement===e}))&&(0,G.A)(this.queue,(function(t){return t.statement===e})),new Promise((function(r,i){n.queryId++,n.queue.push({queryId:n.queryId,statement:e,strategy:t,resolve:r,reject:i}),1!==n.queue.length||n.isRunning||(n.database.trigger("busy"),n.next())}))}},{key:"next",value:function(){var e=this;if(!this.isRunning){var t=this.queue.shift();if(void 0!==t){this.isRunning=!0;var n=function(){t.strategy.execute()().then((function(e){t.resolve(e)})).catch((function(e){t.reject(e)})).finally((function(){e.isRunning=!1,e.queue.length?e.next():e.database.trigger("idle")}))};0===this.queue.length%5?setTimeout(n):n()}else this.database.trigger("idle")}}}]),e}(),W=u()((function e(){a()(this,e)}));function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Y=function(e){f()(n,e);var t=q(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),y()(l()(e),"literal",void 0),e}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.EXPRESSION}},{key:"getLiteral",value:function(){return void 0!==this.literal||(this.literal=this.toString().replace(/["']+/g,"").trim()),this.literal}}]),n}(W);function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var J=function(e){f()(n,e);var t=Q(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"bindingName",void 0),y()(l()(r),"bindingValue",void 0),r.bindingName=e.name,r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.BINDING}},{key:"getBindingName",value:function(){return this.bindingName}},{key:"getBindedValue",value:function(){if(void 0===this.bindingValue)throw new Error("Binding "+JSON.stringify(this.bindingName)+" is not binded!");return this.bindingValue}},{key:"getBindings",value:function(){return[this]}},{key:"getFunctions",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[]}},{key:"bind",value:function(e){return this.bindingValue=e,this}},{key:"unbind",value:function(){return this.bindingValue=void 0,this}},{key:"compute",value:function(e){if(void 0!==this.bindingValue)return this.bindingValue;throw new Error("Failed to compute binding: Binding "+this.bindingName+" is not binded!")}},{key:"toString",value:function(){return":"+this.bindingName}}]),n}(Y);function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var z=function(e){f()(n,e);var t=K(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"value",void 0),r.value=e.value,r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.BOOLEAN}},{key:"getBindings",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[]}},{key:"getFunctions",value:function(){return[]}},{key:"compute",value:function(e){return this.value}},{key:"toString",value:function(){return String(this.value)}}]),n}(Y);function $(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var X=function(e){f()(n,e);var t=$(n);function n(e){var r;a()(this,n),r=t.call(this),y()(l()(r),"functionName",void 0),y()(l()(r),"arguments",[]),y()(l()(r),"database",null),r.functionName=e.function_name;for(var i=0,o=e.arguments.length;i<o;i++)r.arguments.push(At.create(e.arguments[i]));return r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.FUNCTION_CALL}},{key:"getFunctionName",value:function(){return this.functionName}},{key:"getArguments",value:function(){return this.arguments}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.arguments.length;t<n;t++)for(var r=0,i=this.arguments[t].getBindings(),o=i.length;r<o;r++)e.push(i[r]);return e}},{key:"getFunctions",value:function(){for(var e=[this],t=0,n=this.arguments.length;t<n;t++)for(var r=0,i=this.arguments[t].getFunctions(),o=i.length;r<o;r++)e.push(i[r]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.arguments.length;t<n;t++)for(var r=0,i=this.arguments[t].getIdentifiers(),o=i.length;r<o;r++)e.push(i[r]);return e}},{key:"withDatabase",value:function(e){return this.database=e||null,this}},{key:"compute",value:function(e){if(this.database){for(var t=[],n=0,r=this.arguments.length;n<r;n++)t.push(this.arguments[n].compute(e));return this.database.callFunction(this.functionName,t)}throw new Error("Failed to call function "+JSON.stringify(this.functionName)+": Database not binded to function!")}},{key:"toString",value:function(){for(var e=this.functionName+"(",t=0,n=this.arguments.length;t<n;t++)e+=(0===t?"":", ")+this.arguments[t].toString();return e+")"}}]),n}(Y);function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ee=function(e){f()(n,e);var t=Z(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"expression",void 0),r.expression=At.create(e.expression),r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.GROUP}},{key:"getBindings",value:function(){return this.expression.getBindings()}},{key:"getFunctions",value:function(){return this.expression.getFunctions()}},{key:"getIdentifiers",value:function(){return this.expression.getIdentifiers()}},{key:"compute",value:function(e){return this.expression.compute(e)}},{key:"toString",value:function(){return"("+this.expression.toString()+")"}}]),n}(Y);function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ne=function(e){f()(n,e);var t=te(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"identifierName",void 0),r.identifierName=e.name,r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.IDENTIFIER}},{key:"getIdentifierName",value:function(){return this.identifierName}},{key:"getBindings",value:function(){return[]}},{key:"getFunctions",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[this]}},{key:"compute",value:function(e){return e.getColumnValue(this.identifierName)}},{key:"toString",value:function(){return this.identifierName}}]),n}(Y);function re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ie=function(e){f()(n,e);var t=re(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"left",void 0),y()(l()(r),"right",void 0),r.left=At.create(e.left),r.right=null===e.right?null:At.create(e.right),r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.LOGICAL}},{key:"getLeftOperand",value:function(){return this.left}},{key:"getRightOperand",value:function(){return this.right}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.left.getBindings(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getBindings(),a=o.length;i<a;i++)e.push(o[i]);return e}},{key:"getFunctions",value:function(){for(var e=[],t=0,n=this.left.getFunctions(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getFunctions(),a=o.length;i<a;i++)e.push(o[i]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.left.getIdentifiers(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getIdentifiers(),a=o.length;i<a;i++)e.push(o[i]);return e}}]),n}(Y);function oe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ae=function(e){f()(n,e);var t=oe(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.gN.AND}},{key:"compute",value:function(e){return!(!this.left.compute(e)||!this.right.compute(e))}},{key:"toString",value:function(){return this.left.toString()+" and "+this.right.toString()}}]),n}(ie);function se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ue=function(e){f()(n,e);var t=se(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.DIFFERENT}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t!=n||0!==S.b.compareAsStrings(t,n):Number(t)!=Number(n)}},{key:"toString",value:function(){return this.left.toString()+" <> "+this.right.toString()}}]),n}(ie);function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var le=function(e){f()(n,e);var t=ce(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.EQUALS}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t==n||0===S.b.compareAsStrings(t,n):Number(t)==Number(n)}},{key:"toString",value:function(){return this.left.toString()+" = "+this.right.toString()}}]),n}(ie);function he(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var fe=function(e){f()(n,e);var t=he(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.GT}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t>n||S.b.compareAsStrings(t,n)<0:Number(t)>Number(n)}},{key:"toString",value:function(){return this.left.toString()+" > "+this.right.toString()}}]),n}(ie);function de(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var pe=function(e){f()(n,e);var t=de(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.GTE}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t>=n||S.b.compareAsStrings(t,n)<=0:Number(t)>=Number(n)}},{key:"toString",value:function(){return this.left.toString()+" >= "+this.right.toString()}}]),n}(ie);function ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ve=function(e){f()(n,e);var t=ge(n);function n(e){var r;a()(this,n),r=t.call(this,e),y()(l()(r),"haystack",[]);for(var i=0,o=e.haystack.length;i<o;i++)r.haystack.push(At.create(e.haystack[i]));return r}return u()(n,[{key:"getOperator",value:function(){return E.Fb.IN}},{key:"compute",value:function(e){for(var t=this.left.compute(e),n=0,r=this.haystack.length;n<r;n++)if(this.equals(t,this.haystack[n].compute(e)))return!0;return!1}},{key:"equals",value:function(e,t){return isNaN(e)||isNaN(t)?e==t||0===S.b.compareAsStrings(e,t):Number(e)==Number(t)}},{key:"toString",value:function(){for(var e=this.left.toString()+" IN(",t=[],n=0,r=this.haystack.length;n<r;n++)t.push(this.haystack[n].toString());return e+t.join(", ")+")"}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.left.getBindings(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.haystack.length;i<o;i++)for(var a=0,s=this.haystack[i].getBindings(),u=s.length;a<u;a++)e.push(s[a]);return e}},{key:"getFunctions",value:function(){for(var e=[],t=0,n=this.left.getFunctions(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.haystack.length;i<o;i++)for(var a=0,s=this.haystack[i].getFunctions(),u=s.length;a<u;a++)e.push(s[a]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.left.getIdentifiers(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.haystack.length;i<o;i++)for(var a=0,s=this.haystack[i].getIdentifiers(),u=s.length;a<u;a++)e.push(s[a]);return e}}]),n}(ie);function me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ye=function(e){f()(n,e);var t=me(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.LIKE}},{key:"compute",value:function(e){return this.like(this.left.compute(e),this.right.compute(e))}},{key:"like",value:function(e,t){var n=S.b.castToString(e),r=S.b.castToString(t);return this.buildRegularExpression(r).test(n)}},{key:"buildRegularExpression",value:function(e){for(var t="^",n="",r=0,i=e.length;r<i;r++)switch(n=e.charAt(r)){case"%":t+="(.*)";break;case"\n":t+="\\n";break;case"\r":t+="\\r";break;case"\t":t+="\\t";break;case".":case"-":case"[":case"]":case"(":case")":case"?":case"!":case"^":case"$":case"\\":case"/":t+="\\"+n;break;default:t+=n}return new RegExp(t+"$","i")}},{key:"toString",value:function(){return this.left.toString()+" LIKE "+this.right.toString()}}]),n}(ie);function be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ee=function(e){f()(n,e);var t=be(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.LT}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t<n||S.b.compareAsStrings(t,n)>0:Number(t)<Number(n)}},{key:"toString",value:function(){return this.left.toString()+" < "+this.right.toString()}}]),n}(ie);function we(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Te=function(e){f()(n,e);var t=we(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.LTE}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t<=n||S.b.compareAsStrings(t,n)>=0:Number(t)<=Number(n)}},{key:"toString",value:function(){return this.left.toString()+" <= "+this.right.toString()}}]),n}(ie);function Ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ke=function(e){f()(n,e);var t=Ne(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.Fb.NOTEQUAL}},{key:"compute",value:function(e){var t=this.left.compute(e),n=this.right.compute(e);return isNaN(t)||isNaN(n)?t!=n||0!==S.b.compareAsStrings(t,n):Number(t)!=Number(n)}},{key:"toString",value:function(){return"".concat(this.left.toString()," != ").concat(this.right.toString())}}]),n}(ie);function Re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Se=function(e){f()(n,e);var t=Re(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.gN.OR}},{key:"compute",value:function(e){return!(!this.left.compute(e)&&!this.right.compute(e))}},{key:"toString",value:function(){return this.left.toString()+" or "+this.right.toString()}}]),n}(ie);function Ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Oe=function(e){f()(n,e);var t=Ce(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"left",void 0),y()(l()(r),"right",void 0),r.left=At.create(e.left),r.right=At.create(e.right),r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.MATH}},{key:"getLeftOperand",value:function(){return this.left}},{key:"getRightOperand",value:function(){return this.right}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.left.getBindings(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getBindings(),a=o.length;i<a;i++)e.push(o[i]);return e}},{key:"getFunctions",value:function(){for(var e=[],t=0,n=this.left.getFunctions(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getFunctions(),a=o.length;i<a;i++)e.push(o[i]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.left.getIdentifiers(),r=n.length;t<r;t++)e.push(n[t]);for(var i=0,o=this.right.getIdentifiers(),a=o.length;i<a;i++)e.push(o[i]);return e}}]),n}(Y);function De(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ie=function(e){f()(n,e);var t=De(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.tx.ADDITION}},{key:"compute",value:function(e){return Number((Number(this.left.compute(e))+Number(this.right.compute(e))).toFixed(6))}},{key:"toString",value:function(){return this.left.toString()+" + "+this.right.toString()}}]),n}(Oe);function Ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var _e=function(e){f()(n,e);var t=Ae(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.tx.DIFFERENCE}},{key:"compute",value:function(e){return Number((Number(this.left.compute(e))-Number(this.right.compute(e))).toFixed(6))}},{key:"toString",value:function(){return this.left.toString()+" - "+this.right.toString()}}]),n}(Oe);function xe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Me=function(e){f()(n,e);var t=xe(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.tx.DIVISION}},{key:"compute",value:function(e){return Number((Number(this.left.compute(e))/Number(this.right.compute(e))).toFixed(6))}},{key:"toString",value:function(){return this.left.toString()+" / "+this.right.toString()}}]),n}(Oe);function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Fe=function(e){f()(n,e);var t=Le(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.tx.MULTIPLY}},{key:"compute",value:function(e){return Number((Number(this.left.compute(e))*Number(this.right.compute(e))).toFixed(6))}},{key:"toString",value:function(){return this.left.toString()+" * "+this.right.toString()}}]),n}(Oe);function Be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Pe=function(e){f()(n,e);var t=Be(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.NULL}},{key:"getBindings",value:function(){return[]}},{key:"getFunctions",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[]}},{key:"compute",value:function(e){return null}},{key:"toString",value:function(){return"null"}}]),n}(Y);function Ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var He=function(e){f()(n,e);var t=Ue(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"value",void 0),r.value=e.value,r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.NUMBER}},{key:"getBindings",value:function(){return[]}},{key:"getFunctions",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[]}},{key:"compute",value:function(e){return this.value}},{key:"toString",value:function(){return String(this.value)}}]),n}(Y);function Ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ge=function(e){f()(n,e);var t=Ve(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"value",void 0),r.value=e.value,r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.STRING}},{key:"getBindings",value:function(){return[]}},{key:"getFunctions",value:function(){return[]}},{key:"getIdentifiers",value:function(){return[]}},{key:"compute",value:function(e){return this.value}},{key:"toString",value:function(){return JSON.stringify(this.value)}}]),n}(Y);function je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var We=function(e){f()(n,e);var t=je(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"operand",void 0),r.operand=At.create(e.left),r}return u()(n,[{key:"getExpressionType",value:function(){return E.Hg.UNARY}},{key:"getOperand",value:function(){return this.operand}},{key:"getBindings",value:function(){return this.operand.getBindings()}},{key:"getFunctions",value:function(){return this.operand.getFunctions()}},{key:"getIdentifiers",value:function(){return this.operand.getIdentifiers()}}]),n}(Y);function qe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ye=function(e){f()(n,e);var t=qe(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.um.INVERT}},{key:"compute",value:function(e){var t=this.operand.compute(e);return null===t?null:!0===t?-1:!1===t||isNaN(t)?0:-t}},{key:"toString",value:function(){return"-"+this.operand.toString()}}]),n}(We);function Qe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Je=function(e){f()(n,e);var t=Qe(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOperator",value:function(){return E.um.NOT}},{key:"compute",value:function(e){return console.warn('TODO: Properly implement "Unary !" operator'),!this.operand.compute(e)}},{key:"toString",value:function(){return"!"+this.operand.toString()}}]),n}(We);function Ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ze=function(e){f()(n,e);var t=Ke(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"limit",void 0),y()(l()(r),"skip",void 0),r.limit=e.limit,r.skip=e.skip,r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.LIMIT_OPTION}},{key:"getLimit",value:function(){return this.limit}},{key:"getSkip",value:function(){return this.skip}}]),n}(W);function $e(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Xe=function(e){f()(n,e);var t=$e(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"direction",void 0),y()(l()(r),"expression",void 0),r.direction=e.direction,r.expression=At.create(e.expression),r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.ORDER_BY_EXPRESSION}},{key:"getDirection",value:function(){return this.direction}},{key:"getExpression",value:function(){return this.expression}}]),n}(W);function Ze(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var et=function(e){f()(n,e);var t=Ze(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"strategy",void 0),r.strategy=e.type,r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.ORDER_BY_OPTION}}]),n}(W);function tt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var nt=function(e){f()(n,e);var t=tt(n);function n(e){var r;a()(this,n),r=t.call(this,e),y()(l()(r),"expressions",[]);for(var i=0,o=e.fields.length;i<o;i++)r.expressions.push(At.create(e.fields[i]));return r}return u()(n,[{key:"getSortExpressions",value:function(){return this.expressions}},{key:"isRandom",value:function(){return!1}}]),n}(et);function rt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var it=function(e){f()(n,e);var t=rt(n);function n(e){return a()(this,n),t.call(this,e)}return u()(n,[{key:"isRandom",value:function(){return!0}}]),n}(et);function ot(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var at=function(e){f()(n,e);var t=ot(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"remote",void 0),y()(l()(r),"binded",void 0),y()(l()(r),"statement",void 0),r.remote=e.remote,r.statement=e,r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.STATEMENT}},{key:"isRemote",value:function(){return this.remote}},{key:"bind",value:function(e,t){this.binded=!1;for(var n,r=this.getBindings(),i=r.length,o=e?"function"===typeof e?e():e:{},a=0;a<i;a++)r[a].unbind();for(var s=0;s<i;s++)if(void 0===o[n=r[s].getBindingName()]){if(!t||!t.autoBind(n,r[s]))throw new Error("Failed to bind statement: Binding "+JSON.stringify(n)+" is not defined in bind object, and is also not auto bindable!")}else r[s].bind(o[n]);return this.binded=!0,this}},{key:"getBindingData",value:function(){for(var e,t={},n=this.getBindings(),r=0,i=n.length;r<i;r++)void 0===t[e=n[r].getBindingName()]&&(t[e]=n[r].getBindedValue());return t}},{key:"isBinded",value:function(){return this.binded}},{key:"getTokenizedStatement",value:function(){return JSON.parse(JSON.stringify(this.statement))}}]),n}(W);function st(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ut=function(e){f()(n,e);var t=st(n);function n(e){var r;return a()(this,n),r=t.call(this,e),y()(l()(r),"table",void 0),y()(l()(r),"filter",null),y()(l()(r),"sorter",null),y()(l()(r),"limit",null),r.table=At.create(e.table),e.where&&(r.filter=At.create(e.where)),e.orderBy&&(r.sorter=At.create(e.orderBy)),e.limit&&(r.limit=At.create(e.limit)),r}return u()(n,[{key:"getStatementType",value:function(){return E.ko.DELETE}},{key:"getTable",value:function(){return this.table}},{key:"getFilter",value:function(){return this.filter}},{key:"getSorter",value:function(){return this.sorter}},{key:"getLimit",value:function(){return this.limit}},{key:"getBindings",value:function(){var e=[];if(this.filter)for(var t=this.filter.getBindings(),n=0,r=t.length;n<r;n++)e.push(t[n]);if(this.sorter&&!this.sorter.isRandom())for(var i=0,o=this.sorter.getSortExpressions(),a=o.length;i<a;i++)for(var s=0,u=o[i].getExpression().getBindings(),c=u.length;s<c;s++)e.push(u[i]);return e}},{key:"getFunctions",value:function(){var e=[];if(null!==this.filter)for(var t=this.filter.getFunctions(),n=0,r=t.length;n<r;n++)e.push(t[n]);if(null!==this.sorter&&!this.sorter.isRandom())for(var i=0,o=this.sorter.getSortExpressions(),a=o.length;i<a;i++)for(var s=0,u=o[i].getExpression().getFunctions(),c=u.length;s<c;s++)e.push(u[i]);return e}},{key:"getIdentifiers",value:function(){var e=[];if(null!==this.filter)for(var t=this.filter.getIdentifiers(),n=0,r=t.length;n<r;n++)e.push(t[n]);if(null!==this.sorter&&!this.sorter.isRandom())for(var i=0,o=this.sorter.getSortExpressions(),a=o.length;i<a;i++)for(var s=0,u=o[i].getExpression().getIdentifiers(),c=u.length;s<c;s++)e.push(u[s]);return e}}]),n}(at);function ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var lt=function(e){f()(n,e);var t=ct(n);function n(e){var r;a()(this,n),r=t.call(this,e),y()(l()(r),"table",void 0),y()(l()(r),"fields",[]),r.table=At.create(e.table);for(var i=0,o=e.fields.length;i<o;i++)r.fields.push(At.create(e.fields[i]));return r}return u()(n,[{key:"getStatementType",value:function(){return E.ko.INSERT}},{key:"getTable",value:function(){return this.table}},{key:"getFields",value:function(){return this.fields}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getBindings(),o=i.length;r<o;r++)e.push(i[r]);return e}},{key:"getFunctions",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getFunctions(),o=i.length;r<o;r++)e.push(i[r]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getIdentifiers(),o=i.length;r<o;r++)e.push(i[r]);return e}}]),n}(at),ht=n(32395),ft=n.n(ht);function dt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var pt=function(e){f()(n,e);var t=dt(n);function n(e){var r;return a()(this,n),r=t.call(this,e),y()(l()(r),"fields",void 0),y()(l()(r),"table",null),y()(l()(r),"filter",null),y()(l()(r),"sorter",null),y()(l()(r),"limit",null),y()(l()(r),"calcFoundRows",void 0),y()(l()(r),"union",null),y()(l()(r),"previous",null),r.calcFoundRows=e.calcFoundRows,r.fields=At.create(e.fields),e.table&&(r.table=At.create(e.table),e.where&&(r.filter=At.create(e.where)),e.orderBy&&(r.sorter=At.create(e.orderBy)),e.limit&&(r.limit=At.create(e.limit))),e.union&&(r.union=At.create(e.union).withPreviousStatement(l()(r))),r}return u()(n,[{key:"isRemote",value:function(){return this.previous?this.previous.isRemote():ft()(v()(n.prototype),"isRemote",this).call(this)}},{key:"getStatementType",value:function(){return E.ko.SELECT}},{key:"getFields",value:function(){return this.fields}},{key:"getTable",value:function(){return this.table}},{key:"getFilter",value:function(){return this.filter}},{key:"getSorter",value:function(){return this.sorter}},{key:"getLimit",value:function(){return this.limit}},{key:"getUnion",value:function(){return this.union}},{key:"withPreviousStatement",value:function(e){return this.previous=e||null,this}},{key:"getBindings",value:function(){var e=[];if(null!==this.fields&&!this.fields.isSelectingAllFields())for(var t=0,n=this.fields.getFields(),r=n.length;t<r;t++)for(var i=0,o=n[t].getExpression().getBindings(),a=o.length;i<a;i++)e.push(o[i]);if(null!==this.filter)for(var s=this.filter.getBindings(),u=0,c=s.length;u<c;u++)e.push(s[u]);if(null!==this.sorter&&!this.sorter.isRandom())for(var l=0,h=this.sorter.getSortExpressions(),f=h.length;l<f;l++)for(var d=0,p=h[l].getExpression().getBindings(),g=p.length;d<g;d++)e.push(p[l]);return e}},{key:"getFunctions",value:function(){var e=[];if(null!==this.fields&&!this.fields.isSelectingAllFields())for(var t=0,n=this.fields.getFields(),r=n.length;t<r;t++)for(var i=0,o=n[t].getExpression().getFunctions(),a=o.length;i<a;i++)e.push(o[i]);if(null!==this.filter)for(var s=this.filter.getFunctions(),u=0,c=s.length;u<c;u++)e.push(s[u]);if(null!==this.sorter&&!this.sorter.isRandom())for(var l=0,h=this.sorter.getSortExpressions(),f=h.length;l<f;l++)for(var d=0,p=h[l].getExpression().getFunctions(),g=p.length;d<g;d++)e.push(p[l]);if(null!==this.union)for(var v=this.union.getFunctions(),m=0,y=v.length;m<y;m++)e.push(v[m]);return e}},{key:"getIdentifiers",value:function(){var e=[];if(null!==this.fields&&!this.fields.isSelectingAllFields())for(var t=0,n=this.fields.getFields(),r=n.length;t<r;t++)for(var i=0,o=n[t].getExpression().getIdentifiers(),a=o.length;i<a;i++)e.push(o[i]);if(null!==this.filter)for(var s=this.filter.getIdentifiers(),u=0,c=s.length;u<c;u++)e.push(s[u]);if(null!==this.sorter&&!this.sorter.isRandom())for(var l=0,h=this.sorter.getSortExpressions(),f=h.length;l<f;l++)for(var d=0,p=h[l].getExpression().getIdentifiers(),g=p.length;d<g;d++)e.push(p[d]);return e}},{key:"getCalcFoundRows",value:function(){return this.calcFoundRows}}]),n}(at);function gt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var vt=function(e){f()(n,e);var t=gt(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"literal",null),y()(l()(r),"expression",void 0),r.literal=e.literal,r.expression=At.create(e.expression),r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.FIELD}},{key:"getLiteral",value:function(){return this.literal}},{key:"getExpression",value:function(){return this.expression}}]),n}(W);function mt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var yt=function(e){f()(n,e);var t=mt(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.FIELDS_LIST}}]),n}(W);function bt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Et=function(e){f()(n,e);var t=bt(n);function n(e){return a()(this,n),t.call(this)}return u()(n,[{key:"isSelectingAllFields",value:function(){return!0}}]),n}(yt);function wt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Tt=function(e){f()(n,e);var t=wt(n);function n(e){var r;a()(this,n),r=t.call(this),y()(l()(r),"fields",[]);for(var i=0,o=e.fields.length;i<o;i++)r.fields.push(At.create(e.fields[i]));return r}return u()(n,[{key:"getFields",value:function(){return this.fields}},{key:"isSelectingAllFields",value:function(){return!1}}]),n}(yt);function Nt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var kt=function(e){f()(n,e);var t=Nt(n);function n(e){var r;a()(this,n),r=t.call(this,e),y()(l()(r),"table",void 0),y()(l()(r),"fields",[]),y()(l()(r),"filter",null),y()(l()(r),"limit",null),y()(l()(r),"sorter",null),y()(l()(r),"timer",null),r.table=At.create(e.table),e.delayed&&(r.timer=At.create(e.delayed));for(var i=0,o=e.fields.length;i<o;i++)r.fields.push(At.create(e.fields[i]));return e.where&&(r.filter=At.create(e.where)),e.limit&&(r.limit=At.create(e.limit)),e.orderBy&&(r.sorter=At.create(e.orderBy)),r}return u()(n,[{key:"getStatementType",value:function(){return E.ko.UPDATE}},{key:"getTimer",value:function(){return this.timer}},{key:"getTable",value:function(){return this.table}},{key:"getFields",value:function(){return this.fields}},{key:"getFilter",value:function(){return this.filter}},{key:"getSorter",value:function(){return this.sorter}},{key:"getLimit",value:function(){return this.limit}},{key:"getBindings",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getBindings(),o=i.length;r<o;r++)e.push(i[r]);if(this.filter)for(var a=0,s=this.filter.getBindings(),u=s.length;a<u;a++)e.push(s[a]);if(this.sorter&&!this.sorter.isRandom())for(var c=0,l=this.sorter.getSortExpressions(),h=l.length;c<h;c++)for(var f=0,d=l[c].getExpression().getBindings(),p=d.length;f<p;f++)e.push(d[c]);return e}},{key:"getFunctions",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getFunctions(),o=i.length;r<o;r++)e.push(i[r]);if(this.filter)for(var a=0,s=this.filter.getFunctions(),u=s.length;a<u;a++)e.push(s[a]);if(this.sorter&&!this.sorter.isRandom())for(var c=0,l=this.sorter.getSortExpressions(),h=l.length;c<h;c++)for(var f=0,d=l[c].getExpression().getFunctions(),p=d.length;f<p;f++)e.push(d[c]);return e}},{key:"getIdentifiers",value:function(){for(var e=[],t=0,n=this.fields.length;t<n;t++)for(var r=0,i=this.fields[t].getExpression().getIdentifiers(),o=i.length;r<o;r++)e.push(i[r]);if(this.filter)for(var a=0,s=this.filter.getIdentifiers(),u=s.length;a<u;a++)e.push(s[a]);if(null!==this.sorter&&!this.sorter.isRandom())for(var c=0,l=this.sorter.getSortExpressions(),h=l.length;c<h;c++)for(var f=0,d=l[c].getExpression().getIdentifiers(),p=d.length;f<p;f++)e.push(d[f]);return e}}]),n}(at);function Rt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var St=function(e){f()(n,e);var t=Rt(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"timer",void 0),r.timer="number"===typeof e.timer?e.timer:null,r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.DELAYED_OPTION}},{key:"getTimerValueInMilliseconds",value:function(){return this.timer}}]),n}(W);function Ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ot=function(e){f()(n,e);var t=Ct(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"name",void 0),y()(l()(r),"expression",void 0),r.name=e.name,r.expression=At.create(e.expression),r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.UPDATE_FIELD}},{key:"getFieldName",value:function(){return this.name}},{key:"getExpression",value:function(){return this.expression}}]),n}(W);function Dt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var It=function(e){f()(n,e);var t=Dt(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"name",void 0),r.name=e.name,r}return u()(n,[{key:"getOpcodeType",value:function(){return E.$U.TABLE}},{key:"getName",value:function(){return this.name}}]),n}(W),At=function(){function e(){a()(this,e)}return u()(e,null,[{key:"create",value:function(e){switch(e.op){case E.$U.STATEMENT:switch(e.type){case E.ko.SELECT:return new pt(e);case E.ko.INSERT:return new lt(e);case E.ko.UPDATE:return new kt(e);case E.ko.DELETE:return new ut(e);default:throw new Error("Cannot create statement from token: "+JSON.stringify(e))}case E.$U.TABLE:return new It(e);case E.$U.EXPRESSION:switch(e.type){case E.Hg.NUMBER:return new He(e);case E.Hg.BOOLEAN:return new z(e);case E.Hg.NULL:return new Pe;case E.Hg.STRING:return new Ge(e);case E.Hg.UNARY:switch(e.operator){case E.um.INVERT:return new Ye(e);case E.um.NOT:return new Je(e);default:throw new Error("Cannot create unary expression from token: "+JSON.stringify(e))}case E.Hg.LOGICAL:switch(e.operator){case E.gN.AND:return new ae(e);case E.gN.OR:return new Se(e);case E.Fb.EQUALS:return new le(e);case E.Fb.NOTEQUAL:return new ke(e);case E.Fb.DIFFERENT:return new ue(e);case E.Fb.GT:return new fe(e);case E.Fb.GTE:return new pe(e);case E.Fb.LT:return new Ee(e);case E.Fb.LTE:return new Te(e);case E.Fb.LIKE:return new ye(e);case E.Fb.IN:return new ve(e);default:throw new Error("Cannot create logical expression from token: "+JSON.stringify(e))}case E.Hg.MATH:switch(e.operator){case E.tx.ADDITION:return new Ie(e);case E.tx.DIFFERENCE:return new _e(e);case E.tx.DIVISION:return new Me(e);case E.tx.MULTIPLY:return new Fe(e);default:throw new Error("Cannot create math expression from token: "+JSON.stringify(e))}case E.Hg.GROUP:return new ee(e);case E.Hg.IDENTIFIER:return new ne(e);case E.Hg.BINDING:return new J(e);case E.Hg.FUNCTION_CALL:return new X(e);default:throw new Error("Unknown expression type: "+JSON.stringify(e))}case E.$U.FIELDS_LIST:switch(e.type){case E.ll.ALL_FIELDS:return new Et(e);case E.ll.SPECIFIC_FIELDS:return new Tt(e);default:throw new Error("Invalid lexer token select fields type: "+JSON.stringify(e))}case E.$U.FIELD:return new vt(e);case E.$U.UPDATE_FIELD:return new Ot(e);case E.$U.DELAYED_OPTION:return new St(e);case E.$U.LIMIT_OPTION:return new ze(e);case E.$U.ORDER_BY_OPTION:switch(e.type){case E.zN.RANDOM:return new it(e);case E.zN.ORDERED:return new nt(e);default:throw new Error("Invalid lexer token ORDER BY: "+JSON.stringify(e))}case E.$U.ORDER_BY_EXPRESSION:return new Xe(e);default:throw new Error("Invalid lexer token opcode type: "+JSON.stringify(e.op))}}}]),e}(),_t=function(){function e(){a()(this,e)}return u()(e,null,[{key:"assertJQLV1ConfigurationStructure",value:function(e){if(!T()(e,Object))throw new Error("Object expected!");if(void 0===e.controlId)throw new Error('Missing property "controlId"');if("string"!==typeof e.controlId)throw new Error('Property "controlId" type should be string');if(void 0===e.eventType)throw new Error('Missing property "eventType"');if("number"!==typeof e.eventType)throw new Error('Property "eventType" type should be number');if(!Array.isArray(e.actions))throw new Error('Missing property "actions"');if(void 0!==e.isRule&&"boolean"!==typeof e.isRule)throw new Error('Property "isRule" type should be boolean|undefined');for(var t=0,n=e.actions.length;t<n;t++)this.assertJQLV1EventActionStructure(e.actions[t])}},{key:"assertJQLV1EventActionStructure",value:function(e){if(!T()(e,Object))throw new Error("Action object expected!");if(void 0===e.controlId)throw new Error('Action property "controlId" type should be string');if("string"!==typeof e.controlId)throw new Error('Action property "controlId" should be string');if(void 0===e.jql)throw new Error('Action property "jql" should be string');if("string"!==typeof e.jql)throw new Error('Action property "jql" should be string')}}]),e}(),xt=n(29779),Mt=n(52752),Lt=function(){function e(t,n){a()(this,e),y()(this,"identifiers",[]),y()(this,"indexes",[]),y()(this,"remote",void 0),y()(this,"storageEngine",void 0),y()(this,"db",void 0),y()(this,"table",void 0),y()(this,"name",void 0),y()(this,"deferredTable",null),this.db=n,this.name=t.name,this.remote=t.storageEngine===E.Ev.REMOTE,this.storageEngine=t.storageEngine,this.computeIdentifiers(t.schema),this.computeIndexDescriptors(t.indexes)}return u()(e,[{key:"describe",value:function(){return this.identifiers}},{key:"hasIdentifier",value:function(e){for(var t=0,n=this.identifiers.length;t<n;t++)if(this.identifiers[t].name===e)return!0;return!1}},{key:"isRemote",value:function(){return this.remote}},{key:"fetch",value:function(){var e=this;return this.table||(this.isRemote()?this.table=new Promise((function(t,n){e.deferredTable=xt.K.createFromRemoteTableDefinition(e.describe(),e.indexes),t(e.deferredTable)})):this.table=new Promise((function(t,n){var r=-1!==e.name.indexOf("salesforcePrefill")?e.db.getAuthorizationTokenSalesforce():e.db.getAuthorizationToken(),i=R.create("fetch-table",r,{name:e.name,applicationConfig:btoa(e.db.getApplicationConfig())});S.b.makeRequest(-1!==e.name.indexOf("salesforcePrefill")?e.db.getRPCEndpointSalesforceName():e.db.getRPCEndpointName(),S.b.REQUEST_METHOD_POST,S.b.REQUEST_CONTENT_TYPE_X_WWW_FORM_URLENCODED,S.b.REQUEST_RESPONSE_TYPE_JSON,S.b.encodeData(i)).then((function(n){e.deferredTable=xt.K.createFromInMemoryArrayOfObjects(n,e.identifiers,e.indexes),t(e.deferredTable)})).catch((function(e){n(new Error(e))}))}))),this.table}},{key:"getStorageEngine",value:function(){return this.storageEngine}},{key:"computeIdentifiers",value:function(t){for(var n in t)t.hasOwnProperty(n)&&this.identifiers.push({name:n,type:e.castBackendDataTypeToFrontendDataType(t[n]),default:null})}},{key:"computeIndexDescriptors",value:function(e){if(e){if(!Array.isArray(e))throw new Error("Invalid argument: indexes: array expected!");for(var t=0,n=e.length;t<n;t++)this.indexes.push(e[t])}}},{key:"getIndexes",value:function(){if(this.deferredTable)return this.deferredTable.getIndexes();for(var e=[],t=0,n=(this.indexes||[]).length;t<n;t++)e.push(Mt.C.createFromIndexDescriptor(this,this.indexes[t]));return e}},{key:"alterIndexes",value:function(e){var t=this;return new Promise((function(n,r){t.db.alterTableIndexes(t.name,e).then((function(e){t.deferredTable=null,t.indexes=e.indexes,n(!0)})).catch((function(e){r(e)}))}))}},{key:"isIndexable",value:function(){return!this.deferredTable||this.deferredTable.isIndexable()}},{key:"isVirtual",value:function(){return!!this.deferredTable&&this.deferredTable.isVirtual()}},{key:"isTransactional",value:function(){return!this.deferredTable||this.deferredTable.isTransactional()}}],[{key:"castBackendDataTypeToFrontendDataType",value:function(e){switch(e){case E.rp.BOOLEAN:return E.DW.BOOLEAN;case E.rp.FLOAT:case E.rp.INT:return E.DW.NUMBER;case E.rp.STRING:return E.DW.STRING;default:return E.DW.NULL}}}]),e}();function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ut=function(e){f()(n,e);var t=Pt(n);function n(){var e;return a()(this,n),e=t.call(this),y()(l()(e),"functions",{}),y()(l()(e),"tables",{}),y()(l()(e),"planner",void 0),y()(l()(e),"authorizationToken",void 0),y()(l()(e),"authorizationTokenSalesforce",void 0),y()(l()(e),"rpcEndpointName",void 0),y()(l()(e),"rpcEndpointSalesforceName",void 0),y()(l()(e),"bindingProviders",[]),y()(l()(e),"onSchemaChanged",void 0),y()(l()(e),"applicationConfig",void 0),e.onSchemaChanged=N.X.create((function(){e.trigger("schema-changed")}),100),e}return u()(n,[{key:"initPlanner",value:function(){return this.planner=new j(this),this}},{key:"withAuthorizationToken",value:function(e){return this.authorizationToken=e,this}},{key:"getAuthorizationToken",value:function(){return this.authorizationToken}},{key:"withApplicationConfig",value:function(e){return this.applicationConfig=e,this}},{key:"getApplicationConfig",value:function(){return this.applicationConfig}},{key:"withAuthorizationTokenSalesforce",value:function(e){return this.authorizationTokenSalesforce=e,this}},{key:"getAuthorizationTokenSalesforce",value:function(){return this.authorizationTokenSalesforce}},{key:"withRPCEndpointName",value:function(e){return this.rpcEndpointName=e,this}},{key:"getRPCEndpointName",value:function(){return this.rpcEndpointName}},{key:"withRPCEndpointSalesforceName",value:function(e){return this.rpcEndpointSalesforceName=e,this}},{key:"getRPCEndpointSalesforceName",value:function(){return this.rpcEndpointSalesforceName}},{key:"isValidIdentifierName",value:function(e){return"string"===typeof e&&/^[a-zA-Z$_][a-zA-Z0-9_$]+$/.test(e)}},{key:"withFunction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.isValidIdentifierName(e))throw new Error("".concat(JSON.stringify(e)," is not a valid function name!"));if(e=e.toLowerCase(),S.b.isReservedKeyword(e))throw new Error("".concat(JSON.stringify(e)," is a reserved keyword and cannot be used as a function name!"));if(void 0!==this.functions[e])throw new Error("Function ".concat(JSON.stringify(e)," already registered in database!"));return this.functions[e]={func:t,local:n,remote:r},this}},{key:"hasLocalFunction",value:function(e){return!("string"!==typeof e||(e=e.toLowerCase(),void 0===this.functions[e]||!this.functions.hasOwnProperty(e)||!this.functions[e].local))}},{key:"hasRemoteFunction",value:function(e){return!("string"!==typeof e||(e=e.toLowerCase(),void 0===this.functions[e]||!this.functions.hasOwnProperty(e)||!this.functions[e].remote))}},{key:"callFunction",value:function(e,t){if(this.hasLocalFunction(e))return this.functions[e.toLowerCase()].func.apply(this,t);throw new Error("Failed to call function ".concat(JSON.stringify(e),": Function not defined!"))}},{key:"getFunction",value:function(e){if(this.hasLocalFunction(e))return this.functions[e].func;throw new Error("Failed to get function ".concat(JSON.stringify(e),": Function not defined!"))}},{key:"withTable",value:function(e,t){if(!this.isValidTableName(e))throw new Error("".concat(JSON.stringify(e)," is not a valid table name!"));if(void 0!==this.tables[e])throw new Error("Table ".concat(JSON.stringify(e)," already created!"));return this.tables[e]=t,this.onSchemaChanged(),this}},{key:"isValidTableName",value:function(e){return"string"===typeof e&&/^[a-zA-Z0-9_ \-$]+$/.test(e)}},{key:"withTablesList",value:function(e){for(var t=0,n=e.length;t<n;t++)this.withTable(e[t].name,new Lt(e[t],this));return this.onSchemaChanged(),this}},{key:"hasTable",value:function(e){var t=e.replace(/`/g,"");return"string"===typeof t&&void 0!==this.tables[t]&&this.tables.hasOwnProperty(t)}},{key:"enumerateTables",value:function(){var e=[];for(var t in this.tables)this.tables.hasOwnProperty(t)&&e.push({name:t,instance:this.tables[t]});return e}},{key:"getTable",value:function(e){if(this.hasTable(e))return this.tables[e.replace(/`/g,"")];throw new Error("Table ".concat(JSON.stringify(e)," does not exist!"))}},{key:"createStatement",value:function(e){if(!e||"string"!==typeof e)throw new Error("Invalid argument: statement: string expected!");if(!window.JQLGrammar)throw new Error("Cannot load JQLGrammar library!");var t=At.create(window.JQLGrammar.parse(e)),n=t.getTable();if(n){if(!this.hasTable(n.getName()))throw new Error("Failed to create statement: Table ".concat(JSON.stringify(n.getName())," does not exist!"));for(var r=this.getTable(n.getName()),i=t.getIdentifiers(),o=0,a=i.length;o<a;o++)if(!r.hasIdentifier(i[o].getIdentifierName()))throw new Error("Unknown table identifier ".concat(JSON.stringify(i[o].getIdentifierName())));if(r.isRemote()!==t.isRemote()){if(!t.isRemote())throw new Error("REMOTE statement clause is mandatory on encrypted tables");if(t.isRemote()&&r.isVirtual())throw new Error("REMOTE statements are not possible on virtual tables");if(r.isRemote()&&!t.isRemote())throw new Error("ENCRYPTED tables require remote statements")}}else if(t.getIdentifiers().length)throw new Error("A statement which does not affect a table cannot have identifiers!");for(var s=t.getFunctions(),u=0,c=s.length;u<c;u++){var l=s[u].getFunctionName();if(!t.isRemote()&&!this.hasLocalFunction(l)||t.isRemote()&&!this.hasRemoteFunction(l))throw new Error("Failed to create statement: Function ".concat(JSON.stringify(s[u].getFunctionName())," is not declared!"));s[u].withDatabase(this)}return t}},{key:"executeStatement",value:function(e,t){try{return this.planner.scheduleStatement(e,this.createExecutionStrategy(e,t))}catch(n){return Promise.reject(n)}}},{key:"createExecutionStrategy",value:function(e,t){if(e.isRemote())return new P(e,this,t);switch(e.getStatementType()){case E.ko.SELECT:return new U(e,this,t);case E.ko.INSERT:return new I(e,this,t);case E.ko.UPDATE:return new H(e,this,t);case E.ko.DELETE:return new D(e,this,t);default:throw new Error("Failed to create execution strategy: Uknown statement type!")}}},{key:"createTableFromCSVFile",value:function(e){var t=this,n=new FormData;return n.append("action","create-table-from-csv"),n.append("auth",this.authorizationToken),n.append("csvFile",e.csvFile||""),n.append("setting",btoa(JSON.stringify({table:{name:e.tableName,namespace:e.tableNamespace,accessMode:e.tableAccessMode,storageEngine:e.tableStorageEngine},csvParser:{enclosure:S.b.parseString(e.csvFieldEnclosure),encloseAllFields:e.csvEncloseAllFields,delimiter:S.b.parseString(e.csvFieldDelimiter),escapeCharacter:S.b.parseString(e.csvEscapeCharacter),autoTrim:e.csvAutoTrim,lineTerminator:S.b.parseString(e.csvLineTerminator)}}))),new Promise((function(e,r){t.makePostRequest(n).then((function(n){t.withTablesList([n]),e(n)})).catch((function(e){r(new Error(e))}))}))}},{key:"dropTable",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.hasTable(e))return Promise.reject(new Error("Table '".concat(e,"' does not exist!")));var r=R.create("drop-table",this.authorizationToken,Bt({name:e},n));return new Promise((function(n,i){t.makePostRequest(r).then((function(r){delete t.tables[e],t.onSchemaChanged(),n(r)})).catch((function(e){i(new Error(e))}))}))}},{key:"unmountTable",value:function(e){if(!this.hasTable(e))throw new Error("Failed to unmount table ".concat(JSON.stringify(e),": Table not found!"));delete this.tables[e]}},{key:"alterTableIndexes",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hasTable(e))return Promise.reject(new Error("Table '".concat(e,"' does not exist!")));var i=R.create("alter-table-indexes",this.authorizationToken,Bt({name:e,indexes:btoa(JSON.stringify(t||null))},r));return new Promise((function(e,t){n.makePostRequest(i).then((function(t){e(t),n.onSchemaChanged()})).catch((function(e){t(new Error(e))}))}))}},{key:"autoBind",value:function(e,t){for(var n=0,r=this.bindingProviders.length;n<r;n++)if(this.bindingProviders[n].canBind(e))return t.bind(this.bindingProviders[n].getBindedValue(e)),!0;return!1}},{key:"withAutoBindingProvider",value:function(e){return this.bindingProviders.push(e),this}},{key:"getJQLFormConfiguration",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=R.create("fetch-form-events",this.authorizationToken,Bt({},t));return new Promise((function(t,r){e.makePostRequest(n).then((function(e){t(e)})).catch((function(e){r(new Error(e))}))}))}},{key:"saveJQLFormConfiguration",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!Array.isArray(e))throw new Error("Array of IJQLv1FormEventConfiguration expected");for(var r=0,i=e.length;r<i;r++)_t.assertJQLV1ConfigurationStructure(e[r]);for(var o=JSON.parse(JSON.stringify(e)),a=0,s=e.length;a<s;a++)for(var u=0,c=e[a].actions.length;u<c;u++)o[a].actions[u].statement=window.JQLGrammar.parse(e[a].actions[u].jql);var l=R.create("save-jql-configuration",this.authorizationToken,Bt({configuration:btoa(JSON.stringify(o))},n));return new Promise((function(n,r){t.makePostRequest(l).then((function(){n(e)})).catch((function(e){r(new Error(e))}))}))}catch(h){return Promise.reject(h)}}},{key:"deleteAllAssociatedSettingsAndAllTables",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n=R.create("delete-jql-configuration-and-associated-tables",this.authorizationToken,Bt({},t));return new Promise((function(t,r){e.makePostRequest(n).then((function(e){t(e)})).catch((function(e){r(new Error(e))}))}))}catch(r){return Promise.reject(r)}}},{key:"downloadTableAsCSV",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.hasTable(e))return Promise.reject(new Error("Table '".concat(e,"' does not exist!")));var r=R.create("export-table",this.authorizationToken,Bt({name:e},n));return new Promise((function(e,n){t.makePostRequest(r).then((function(t){e(t)})).catch((function(e){n(new Error(e))}))}))}},{key:"makePostRequest",value:function(e){return S.b.makeRequest(this.rpcEndpointName,S.b.REQUEST_METHOD_POST,T()(e,FormData)?S.b.REQUEST_CONTENT_TYPE_MULTIPART:S.b.REQUEST_CONTENT_TYPE_X_WWW_FORM_URLENCODED,S.b.REQUEST_RESPONSE_TYPE_JSON,T()(e,FormData)?e:S.b.encodeData(e))}},{key:"triggerNextQuery",value:function(){this.planner.next()}}]),n}(b.b),Ht=n(92866),Vt=n(30679),Gt=n(41343),jt=n(44757),Wt=n(5414),qt=function(){function e(t,n,r,i){a()(this,e),y()(this,"app",void 0),y()(this,"jq",void 0),y()(this,"notificationsAreaContainer",void 0),y()(this,"mainApplicationNode",void 0),this.app=t,this.jq=n,this.notificationsAreaContainer=r,this.mainApplicationNode=i}return u()(e,[{key:"alert",value:function(e,t,n,r){var i=this.createDialog(String(e||this.app.getI18n().translateText("myforms_UI_dlg_title_ALERT")),[{type:Wt.ML.OK,callback:function(e,t){n&&T()(n,Function)&&n(),t.close()}}],{width:r&&r.width?r.width:"500px",height:r&&r.height?r.height:void 0});i.body.textContent=String(t||"")||this.app.getI18n().translateText("myforms_UI_dlg_title_ALERT"),i.body.setAttribute("data-dialog-role","system-dialog")}},{key:"legacyAlert",value:function(e,t){var n=window.IEpromptbeta;n?n(e):alert(t)}},{key:"prompt",value:function(e,t,n,r){var i=this.createDialog(String(e||this.app.getI18n().translateText("myforms_UI_dlg_title_QUESTION")),[{type:Wt.ML.YES,callback:function(e,t){n&&T()(n,Function)&&n(),t.close()}},{type:Wt.ML.NO,callback:function(e,t){r&&T()(r,Function)&&(r(),Wt.ML.DOWNLOAD),t.close()}}],{width:"600px"});i.body.textContent=String(t||"")||this.app.getI18n().translateText("myforms_UI_dlg_title_QUESTION"),i.body.setAttribute("data-dialog-role","system-dialog")}},{key:"createDialog",value:function(t,n,r){return function(i,o){var a=document.createElement("div"),s=document.createElement("div"),u=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),f=document.createElement("div");a.tabIndex=0,a.className="ui-modal",s.className="ui-dialog",u.className="ui-titlebar",u.textContent=t,c.className="ui-titlebody",h.className="ui-body",f.className="ui-buttons bootstrap-iso",l.className="ui-close i123-close",a.appendChild(s),u.appendChild(c),u.appendChild(l),s.appendChild(u),s.appendChild(h);var d=!1;function p(e){var t;e.preventDefault(),e.stopPropagation(),o(f).find("> button").each((function(){switch(parseInt(o(this).attr("data-role").replace(/^button-type-/,""))){case Wt.ML.OK:case Wt.ML.YES:case Wt.ML.SAVE:case Wt.ML.FORM_MIGRATE:t||(t=this)}})),t&&o(t).click()}var g={close:function(){d||(o(h).find("form").off("submit",p),a.parentNode.removeChild(a),d=!0)},body:h,titlebody:c,dialog:s,setHTML:function(e){h.innerHTML=e,o(h).find("form").on("submit",p)},clearInlineErrors:function(){o(h).find("label.error").text("")},hide:function(){o(a).addClass("hidden")},show:function(){o(a).removeClass("hidden")},isClosed:function(){return d}};l.onclick=function(){if(r&&r.onCloseButtonClick)try{r.onCloseButtonClick()}catch(e){}g.close()},a.addEventListener("keyup",(function(e){27==(e.keyCode||e.charCode)&&(g.close(),r&&r.onCloseButtonClick&&r.onCloseButtonClick())}),!1);for(var v=0,m=n.length;v<m;v++)!function(t){var n=document.createElement("button");n.textContent=i.getDialogButtonLabel(t.type),f.appendChild(n),n.setAttribute("data-role","button-type-".concat(t.type)),n.className="btn ".concat(e.getDialogButtonClass(t.type)),n.onclick=function(){t.callback(t.type,g)}}(n[v]);return s.appendChild(f),r&&(r.width&&(s.style.width=r.width),r.height&&(s.style.height=r.height)),document.body.appendChild(a),a.focus(),a.addEventListener("keydown",(function(e){var t=e.target||e.srcElement;t&&-1===["input","select","textarea"].indexOf(t.nodeName.toLowerCase())&&(t.hasAttribute("data-allow-keyboard")||e.stopPropagation())}),!0),a.addEventListener("keypress",(function(e){var t=e.target||e.srcElement;t&&-1===["input","select","textarea"].indexOf(t.nodeName.toLowerCase())&&e.stopPropagation()}),!0),a.addEventListener("keyup",(function(e){var t=e.target||e.srcElement;t&&-1===["input","select","textarea"].indexOf(t.nodeName.toLowerCase())&&e.stopPropagation()}),!0),g}(this,this.jq)}},{key:"getDialogButtonLabel",value:function(e){switch(e){case Wt.ML.OK:return this.app.getI18n().translateText("myforms_UI_btn_OK");case Wt.ML.YES:return this.app.getI18n().translateText("myforms_UI_btn_YES");case Wt.ML.ABORT:return this.app.getI18n().translateText("myforms_UI_btn_ABORT");case Wt.ML.RETRY:return this.app.getI18n().translateText("myforms_UI_btn_RETRY");case Wt.ML.CANCEL:return this.app.getI18n().translateText("myforms_UI_btn_CANCEL");case Wt.ML.IGNORE:return this.app.getI18n().translateText("myforms_UI_btn_IGNORE");case Wt.ML.NO:return this.app.getI18n().translateText("myforms_UI_btn_NO");case Wt.ML.SAVE:return this.app.getI18n().translateText("myforms_UI_btn_SAVE");case Wt.ML.CHANGE:return this.app.getI18n().translateText("myforms_UI_btn_CHANGE");case Wt.ML.DELETE:return this.app.getI18n().translateText("myforms_UI_btn_DELETE");case Wt.ML.DOWNLOAD:return this.app.getI18n().translateText("myforms_UI_btn_DOWNLOAD");case Wt.ML.CLOSE:return this.app.getI18n().translateText("myforms_UI_btn_CLOSE");case Wt.ML.ENABLE_COMPLIANCE:return this.app.getI18n().translateText("myformsHipaaChangeStatusTitle0");case Wt.ML.DISABLE_COMPLIANCE:return this.app.getI18n().translateText("myformsHipaaChangeStatusTitle1");case Wt.ML.CREATE:return this.app.getI18n().translateText("applications_UI_btn_CREATE");case Wt.ML.DONE:return this.app.getI18n().translateText("applications_UI_btn_DONE");case Wt.ML.TRY_FORM:return this.app.getI18n().translateText("oldEditor_TryFormBtn");case Wt.ML.NO_THANKS:return this.app.getI18n().translateText("editForm_noThanksButton");case Wt.ML.UPDATE:return this.app.getI18n().translateText("Update");case Wt.ML.MAYBE_LATER:return this.app.getI18n().translateText("wix_popupMaybeLater");case Wt.ML.UPGRADE_NOW:return this.app.getI18n().translateText("LinkUpdateNowTitle");case Wt.ML.UPGRADE_NOW_PAYWALL:return this.app.getI18n().translateText("paywall_upgrade_button_1");case Wt.ML.CONTINUE:return this.app.getI18n().translateText("userServeyPopup_continue");case Wt.ML.KEEP_EDITING_FORM:return this.app.getI18n().translateText("edt_UI_btn_keep_editing_form");case Wt.ML.CLOSE_EDITOR:return this.app.getI18n().translateText("edt_UI_btn_close_editor");case Wt.ML.IMPORT:return this.app.getI18n().translateText("edt_UI_btn_import");case Wt.ML.ADD_DOMAIN:return this.app.getI18n().translateText("js_iep_domainalias05");case Wt.ML.VALIDATE:return this.app.getI18n().translateText("edt_UI_btn_validate_smtp");case Wt.ML.FORM_MIGRATE:return"Migrate";case Wt.ML.REQUEST_A_DEMO_CORPORATE_PAYWALL:return this.app.getI18n().translateText("paywall_request_a_demo");case Wt.ML.UPGRADE_TO_ENTERPRISE:return this.app.getI18n().translateText("paywall_upgrade_button_2");case Wt.ML.COPY_ERROR:return this.app.getI18n().translateText("generic_UI_btn_copy_error");case Wt.ML.CONTACT_SUPPORT:return this.app.getI18n().translateText("paywalls_contact_support");case Wt.ML.CONFIRM:return this.app.getI18n().translateTextDefault("generic_UI_btn_confirm","Confirm");default:throw new Error("Invalid button type: ".concat(JSON.stringify(e),". Please use one of EDialogButtonType types"))}}},{key:"getCurrentNotification",value:function(){return this.notificationsAreaContainer.firstElementChild}},{key:"createNotification",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wt.s9.DEFAULT,i=arguments.length>3?arguments[3]:void 0,o=document.createElement("div");if(o.className="notification",o.innerHTML=n?e.escapeHTML(t):t,i||void 0===i){var a=document.createElement("div");a.className="close",o.appendChild(a)}switch(this.notificationsAreaContainer.innerHTML="",r){case Wt.s9.DEFAULT:break;case Wt.s9.ERROR:this.jq(o).prepend('<span class="i123-warning"></span>'),this.jq(o).addClass("ERROR");break;case Wt.s9.SUCCESS:this.jq(o).prepend('<span class="i123-check"></span>'),this.jq(o).addClass("SUCCESS");break;case Wt.s9.INFO:this.jq(o).addClass("INFO")}return this.notificationsAreaContainer.appendChild(o),this.jq(this.mainApplicationNode).addClass("with-notification"),o}},{key:"createResponsiveNotification",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wt.s9.DEFAULT,i=arguments.length>3?arguments[3]:void 0,o=document.createElement("div"),a=n?e.escapeHTML(t):t;if(o.className="notification",o.innerHTML='<span class="notification-content">'.concat(a,"</span>"),i||void 0===i){var s=document.createElement("div");s.className="close",o.appendChild(s)}switch(this.notificationsAreaContainer.innerHTML="",r){case Wt.s9.DEFAULT:break;case Wt.s9.ERROR:this.jq(o).prepend('<span class="i123-warning"></span>'),this.jq(o).addClass("ERROR");break;case Wt.s9.SUCCESS:this.jq(o).prepend('<span class="i123-check"></span>'),this.jq(o).addClass("SUCCESS")}return this.notificationsAreaContainer.appendChild(o),this.jq(this.mainApplicationNode).addClass("with-notification"),o}},{key:"closeAllNotifications",value:function(){this.jq(this.mainApplicationNode).removeClass("with-notification"),this.notificationsAreaContainer.innerHTML=""}},{key:"getRootNode",value:function(){return this.mainApplicationNode}}],[{key:"getDialogButtonClass",value:function(e){switch(e){case Wt.ML.OK:case Wt.ML.YES:case Wt.ML.SAVE:case Wt.ML.CHANGE:case Wt.ML.DOWNLOAD:case Wt.ML.ENABLE_COMPLIANCE:case Wt.ML.CREATE:case Wt.ML.DONE:case Wt.ML.TRY_FORM:case Wt.ML.UPDATE:case Wt.ML.UPGRADE_NOW:case Wt.ML.UPGRADE_NOW_PAYWALL:case Wt.ML.CONTINUE:case Wt.ML.KEEP_EDITING_FORM:case Wt.ML.IMPORT:case Wt.ML.ADD_DOMAIN:case Wt.ML.VALIDATE:case Wt.ML.FORM_MIGRATE:case Wt.ML.REQUEST_A_DEMO_CORPORATE_PAYWALL:case Wt.ML.UPGRADE_TO_ENTERPRISE:case Wt.ML.CONTACT_SUPPORT:return"btn-secondary-cta";case Wt.ML.DELETE:case Wt.ML.CONFIRM:case Wt.ML.DISABLE_COMPLIANCE:return"btn-secondary-red";case Wt.ML.COPY_ERROR:return"btn-outline btn-copy-error";default:return"btn-outline"}}},{key:"escapeHTML",value:function(t){e.HTMLEscaper.textContent=t;var n=e.HTMLEscaper.innerHTML;return e.HTMLEscaper.textContent="",n}}]),e}();y()(qt,"HTMLEscaper",document.createElement("div"));var Yt,Qt=qt,Jt=n(61978),Kt=n(29293),zt=n.n(Kt),$t=function(){function e(t,n){a()(this,e),y()(this,"dataGrid",void 0),y()(this,"rootDOMNode",void 0),y()(this,"gutterNumberDOMNode",void 0),y()(this,"height",28),y()(this,"rowData",void 0),y()(this,"cells",[]),y()(this,"rowIndex",void 0),y()(this,"selected",!1),y()(this,"selectedCellIndex",void 0),this.dataGrid=t,this.rootDOMNode=document.createElement("div"),this.rootDOMNode.setAttribute("data-role","row"),this.gutterNumberDOMNode=document.createElement("div"),this.gutterNumberDOMNode.setAttribute("data-role","gutter-number"),this.rootDOMNode.style.height=this.height+"px",this.gutterNumberDOMNode.style.height=this.height+"px",this.rowData=n||[],this.initCells()}return u()(e,[{key:"getRootDOMNode",value:function(){return this.rootDOMNode}},{key:"getGutterNumberDOMNode",value:function(){return this.gutterNumberDOMNode}},{key:"getHeight",value:function(){return this.height}},{key:"withHeight",value:function(e){return(e=~~e||0)<0&&(e=0),this.height=e,this.rootDOMNode.style.height=e+"px",this.gutterNumberDOMNode.style.height=e+"px",this.dataGrid.updateClientHeightDelayed(),this}},{key:"initCells",value:function(){for(var e=0,t=this.dataGrid.getColumns(),n=t.length;e<n;e++){var r=document.createElement("div");r.setAttribute("data-role","cell"),r.setAttribute("data-index",String(e)),r.innerHTML=t[e].renderValue(void 0===this.rowData[e]?null:this.rowData[e]),this.rootDOMNode.appendChild(r),this.cells.push(r)}}},{key:"getRowIndex",value:function(){return this.rowIndex}},{key:"withRowIndex",value:function(e){return null===e?(this.rowIndex=null,this.gutterNumberDOMNode.innerHTML=""):(e=~~e,this.rowIndex=e,this.gutterNumberDOMNode.appendChild(document.createElement("span")).textContent=String(this.rowIndex)),this}},{key:"getCells",value:function(){return this.cells}},{key:"getSelectedState",value:function(){return this.selected}},{key:"withSelectedState",value:function(e){return this.selected=!!e,this.selected?(this.rootDOMNode.setAttribute("data-selected",""),this.gutterNumberDOMNode.setAttribute("data-selected",""),this.dataGrid.getCollection()&&this.dataGrid.getCollection().setSelectedRowIndex(~~this.rootDOMNode.getAttribute("data-index"))):(this.rootDOMNode.removeAttribute("data-selected"),this.gutterNumberDOMNode.removeAttribute("data-selected"),null!==this.selectedCellIndex&&void 0!==this.selectedCellIndex&&this.withSelectedCellIndex(null)),this}},{key:"getSelectedCellIndex",value:function(){return null===this.selectedCellIndex||void 0===this.selectedCellIndex?null:this.selectedCellIndex}},{key:"withSelectedCellIndex",value:function(e){if(null===e||void 0===e)this.selectedCellIndex=void 0;else{if((e=~~e)<0)throw new Error("Invalid index!");if(e>=this.cells.length)throw new Error("Invalid index!");this.selectedCellIndex=e}for(var t=0,n=this.cells.length;t<n;t++)t===this.selectedCellIndex?this.cells[t].setAttribute("data-selected",""):this.cells[t].hasAttribute("data-selected")&&this.cells[t].removeAttribute("data-selected");return this}},{key:"getDataAt",value:function(e){return this.rowData[e]||null}},{key:"setDataAt",value:function(e,t){this.rowData[e]=t,this.cells[e].innerHTML=this.dataGrid.getColumns()[e].renderValue(void 0===this.rowData[e]?null:this.rowData[e])}}]),e}(),Xt=function(){function e(){a()(this,e)}return u()(e,null,[{key:"renderBooleanValue",value:function(e){return e&&"0"!==e?'<span data-type="boolean">true</span>':null===e?'<span data-type="null">NULL</span>':'<span data-type="boolean">false</span>'}},{key:"renderNumericValue",value:function(e){return null!==e&&!isNaN(e)&&isFinite(e)?'<span data-type="number">'+String(e)+"</span>":null===e?'<span data-type="null">NULL</span>':'<span data-type="number">NaN</span>'}},{key:"renderStringValue",value:function(e){return e||0===e?(this.htmlescaper.textContent=String(e||""),'<span data-type="string">'+this.htmlescaper.innerHTML+"</span>"):null===e?'<span data-type="null">NULL</span>':'<span data-type="string"></span>'}},{key:"renderUnknownDataTypeValue",value:function(e){switch(i()(e)){case"number":return this.renderNumericValue(e);case"string":return isNaN(Number(e))?this.renderStringValue(e):this.renderNumericValue(e);case"boolean":return this.renderBooleanValue(e);default:return this.renderStringValue(e)}}}]),e}();y()(Xt,"htmlescaper",document.createElement("div")),function(e){e[e.NONE=0]="NONE",e[e.ASCENDING=1]="ASCENDING",e[e.DESCENDING=2]="DESCENDING"}(Yt||(Yt={}));var Zt=function(){function e(t){a()(this,e),y()(this,"name",void 0),y()(this,"caption",void 0),y()(this,"width",100),y()(this,"columnType",void 0),y()(this,"rootDOMNode",void 0),y()(this,"captionDOMNode",void 0),y()(this,"dataGrid",void 0),y()(this,"resizerDOMNode",void 0),y()(this,"sortModeDecoration",void 0),y()(this,"sortDirection",void 0),y()(this,"valueRenderer",void 0),y()(this,"editable",void 0),this.dataGrid=t,this.rootDOMNode=document.createElement("div"),this.rootDOMNode.setAttribute("data-role","column"),this.captionDOMNode=document.createElement("span"),this.captionDOMNode.setAttribute("data-role","caption"),this.sortModeDecoration=document.createElement("div"),this.sortModeDecoration.setAttribute("data-role","sort-direction-indicator"),this.rootDOMNode.appendChild(this.captionDOMNode),this.rootDOMNode.appendChild(this.sortModeDecoration),this.rootDOMNode.style.width=this.width+"px",this.resizerDOMNode=document.createElement("div"),this.resizerDOMNode.setAttribute("data-role","column-resizer")}return u()(e,[{key:"getRootDOMNode",value:function(){return this.rootDOMNode}},{key:"getResizerDOMNode",value:function(){return this.resizerDOMNode}},{key:"getColumnName",value:function(){return this.name}},{key:"withColumnName",value:function(e){return this.name=String(e||""),this.rootDOMNode.setAttribute("data-name",String(e||"")),this.onNameOrCaptionChanged(),this}},{key:"withColumnCaption",value:function(e){return this.caption=e,this.onNameOrCaptionChanged(),this}},{key:"getColumnType",value:function(){return this.columnType}},{key:"withColumnType",value:function(e){return this.columnType=e,this}},{key:"onNameOrCaptionChanged",value:function(){this.captionDOMNode.textContent=this.rootDOMNode.title=String(this.caption||this.name)}},{key:"getWidth",value:function(){return this.width}},{key:"withWidth",value:function(e){return(e=~~e||0)<5&&(e=5),this.width=e,this.rootDOMNode.style.width=this.width+"px",this.dataGrid.updateClientWidth(),this}},{key:"getSortDirection",value:function(){return this.sortDirection}},{key:"withSortDirection",value:function(e){switch(e){case Yt.ASCENDING:this.sortDirection=e,this.rootDOMNode.setAttribute("data-sort-direction","ascending");break;case Yt.DESCENDING:this.sortDirection=e,this.rootDOMNode.setAttribute("data-sort-direction","descending");break;case Yt.NONE:default:this.sortDirection=Yt.NONE,this.rootDOMNode.removeAttribute("data-sort-direction")}}},{key:"withValueRenderer",value:function(e){return this.valueRenderer=e||null,this}},{key:"renderValue",value:function(e,t){if(this.valueRenderer)return this.valueRenderer(e,t);switch(this.columnType){case Wt.mF.BOOLEAN:return Xt.renderBooleanValue(e);case Wt.mF.NUMBER:return Xt.renderNumericValue(e);case Wt.mF.STRING:return Xt.renderStringValue(e);case Wt.mF.UNKNOWN:default:return Xt.renderUnknownDataTypeValue(e)}}},{key:"isEditable",value:function(){return this.editable}},{key:"withEditable",value:function(e){return this.editable=!!e,this}}]),e}();function en(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var tn=function(e){f()(n,e);var t=en(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"row",void 0),y()(l()(r),"cell",void 0),y()(l()(r),"columnIndex",void 0),y()(l()(r),"column",void 0),y()(l()(r),"dataGrid",void 0),y()(l()(r),"editInput",void 0),y()(l()(r),"previousCellHTML",void 0),r.dataGrid=e,r}return u()(n,[{key:"getRow",value:function(){return this.row||null}},{key:"getColumnIndex",value:function(){return this.columnIndex||0===this.columnIndex?this.columnIndex:null}},{key:"getColumn",value:function(){return this.column||null}},{key:"getCell",value:function(){return this.cell||null}},{key:"cancelEditing",value:function(){this.isEditing()&&(this.row=void 0,this.cell.innerHTML=this.previousCellHTML,this.cell=void 0,this.column=void 0,this.editInput=void 0)}},{key:"doneEditing",value:function(){if(this.isEditing()){var e;switch(this.column.getColumnType()){case Wt.mF.BOOLEAN:e=this.editInput.checked;break;case Wt.mF.NUMBER:e=parseFloat(this.editInput.value),(isNaN(e)||null===e)&&(e=null);break;default:e=this.editInput.value}var t=this.row.getDataAt(this.columnIndex),n=this.columnIndex,r=this.row;this.cancelEditing(),t!==e&&(r.setDataAt(n,e),this.dataGrid.onRowUpdated(r,n,e,t))}}},{key:"editCell",value:function(e){var t=this;this.isEditing()&&this.doneEditing(),e&&null!==e.columnIndex&&(this.row=this.dataGrid.getRows()[e.rowIndex]||null,this.row&&(this.columnIndex=e.columnIndex,this.column=this.dataGrid.getColumns()[e.columnIndex]||null,this.column&&this.column.isEditable()&&(this.cell=this.row.getCells()[e.columnIndex]||null,this.cell&&(this.previousCellHTML=this.cell.innerHTML,this.cell.innerHTML="",this.editInput=this.createEditorInput(this.column.getColumnType(),this.row.getDataAt(this.columnIndex)),this.cell.appendChild(this.editInput),setTimeout((function(){t.editInput.focus();try{t.editInput.select()}catch(e){}}),10),this.editInput.onblur=function(){t.doneEditing()}))))}},{key:"isEditing",value:function(){return!!this.cell&&!!this.row&&!!this.column}},{key:"createEditorInput",value:function(e,t){var n;switch(e){case Wt.mF.BOOLEAN:(n=document.createElement("input")).setAttribute("type","checkbox"),n.checked=this.castToBoolean(t);break;case Wt.mF.NUMBER:(n=document.createElement("input")).setAttribute("type","number"),n.value=this.castToNumber(t);break;case Wt.mF.STRING:case Wt.mF.UNKNOWN:default:(n=document.createElement("input")).setAttribute("type","text"),n.value=this.castToString(t)}return n.setAttribute("data-role","editor"),n}},{key:"castToBoolean",value:function(e){return"0"!==e&&!!~~e}},{key:"castToNumber",value:function(e){return null===e||isNaN(e)||!isFinite(e)?"":String(e)}},{key:"castToString",value:function(e){return e?String(e):""}}]),n}(b.b);function nn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var rn=function(e){f()(n,e);var t=nn(n);function n(e){var r;return a()(this,n),r=t.call(this),y()(l()(r),"jq",void 0),y()(l()(r),"uniqueGridId",void 0),y()(l()(r),"internalStyleDOMNode",void 0),y()(l()(r),"columns",[]),y()(l()(r),"rows",[]),y()(l()(r),"rootDOMNode",void 0),y()(l()(r),"headerDOMNode",void 0),y()(l()(r),"selectAllColumnsDOMNode",void 0),y()(l()(r),"bodyDOMNode",void 0),y()(l()(r),"gutterDOMNode",void 0),y()(l()(r),"footerDOMNode",void 0),y()(l()(r),"clientDOMNode",void 0),y()(l()(r),"clientWidth",0),y()(l()(r),"clientHeight",0),y()(l()(r),"clientScrollTop",0),y()(l()(r),"clientScrollLeft",0),y()(l()(r),"sortable",!1),y()(l()(r),"selectedRowIndex",void 0),y()(l()(r),"collection",void 0),y()(l()(r),"editor",void 0),y()(l()(r),"emptyStateHTMLDOMNode",void 0),y()(l()(r),"updateClientHeightDelayed",void 0),y()(l()(r),"renderInternalCssDelayed",void 0),n.styleId++,r.uniqueGridId=n.styleId,r.jq=e,r.rootDOMNode=document.createElement("div"),r.rootDOMNode.setAttribute("data-role","data-grid"),r.rootDOMNode.setAttribute("data-grid-uid",String(r.uniqueGridId)),r.rootDOMNode.appendChild(r.internalStyleDOMNode=document.createElement("style")),r.headerDOMNode=r.rootDOMNode.appendChild(document.createElement("div")),r.headerDOMNode.setAttribute("data-role","header"),r.selectAllColumnsDOMNode=r.headerDOMNode.appendChild(document.createElement("div")),r.selectAllColumnsDOMNode.setAttribute("data-role","select-all-columns"),r.gutterDOMNode=r.rootDOMNode.appendChild(document.createElement("div")),r.gutterDOMNode.setAttribute("data-role","gutter"),r.bodyDOMNode=r.rootDOMNode.appendChild(document.createElement("div")),r.bodyDOMNode.setAttribute("data-role","body"),r.clientDOMNode=r.bodyDOMNode.appendChild(document.createElement("div")),r.clientDOMNode.setAttribute("data-role","client"),r.clientDOMNode.setAttribute("data-allow-keyboard",""),r.clientDOMNode.tabIndex=0,r.footerDOMNode=r.rootDOMNode.appendChild(document.createElement("div")),r.footerDOMNode.setAttribute("data-role","footer"),r.emptyStateHTMLDOMNode=document.createElement("div"),r.emptyStateHTMLDOMNode.setAttribute("data-role","empty-state"),r.bodyDOMNode.appendChild(r.emptyStateHTMLDOMNode),r.updateClientHeightDelayed=N.X.create((function(){r.updateClientHeight()}),100),r.renderInternalCssDelayed=N.X.create((function(){r.renderInternalCSS()}),1),r.editor=new tn(l()(r)),r.init(),r}return u()(n,[{key:"getSelectedIndex",value:function(){for(var e=0,t=this.rows.length;e<t;e++)if(this.rows[e].getSelectedState())return e;return-1}},{key:"getRootDOMNode",value:function(){return this.rootDOMNode}},{key:"createColumn",value:function(){var e=new Zt(this);return this.columns.push(e),this.headerDOMNode.appendChild(e.getRootDOMNode()),this.headerDOMNode.appendChild(e.getResizerDOMNode()),this.updateClientWidth(),this.renderInternalCssDelayed(),e}},{key:"createRow",value:function(e){var t=new $t(this,e),n=this.rows.length;return t.getRootDOMNode().setAttribute("data-index",String(n)),t.getGutterNumberDOMNode().setAttribute("data-index",String(n)),this.rows.push(t),this.clientDOMNode.appendChild(t.getRootDOMNode()),this.gutterDOMNode.appendChild(t.getGutterNumberDOMNode()),this.updateClientHeightDelayed(),t}},{key:"getClientWidth",value:function(){return this.clientWidth}},{key:"withClientWidth",value:function(e){return(e=~~e||0)<0&&(e=0),this.clientWidth=e,this.clientDOMNode.style.width=e+"px",this}},{key:"getClientHeight",value:function(){return this.clientHeight}},{key:"withClientHeight",value:function(e){return(e=~~e||0)<0&&(e=0),this.clientHeight=e,this.clientDOMNode.style.height=e+"px",this}},{key:"updateClientWidth",value:function(){for(var e=0,t=0,n=this.columns.length;t<n;t++)e+=this.columns[t].getWidth();this.withClientWidth(e),this.renderInternalCSS()}},{key:"updateClientHeight",value:function(){for(var e=0,t=0,n=this.rows.length;t<n;t++)e+=this.rows[t].getHeight();this.withClientHeight(e)}},{key:"getClientScrollTop",value:function(){return this.clientScrollTop}},{key:"withClientScrollTop",value:function(e){return(e=~~e||0)<0&&(e=0),this.clientScrollTop=e,this.bodyDOMNode.scrollTop=this.clientScrollTop,this.renderInternalCSS(),this}},{key:"getClientScrollLeft",value:function(){return this.clientScrollLeft}},{key:"withClientScrollLeft",value:function(e){return(e=~~e||0)<0&&(e=0),this.clientScrollLeft=e,this.bodyDOMNode.scrollLeft=this.clientScrollLeft,this.renderInternalCSS(),this}},{key:"isSortingEnabled",value:function(){return this.sortable}},{key:"withSortingEnabled",value:function(e){if(this.sortable=!!e,!this.sortable)for(var t=0,n=this.columns.length;t<n;t++)this.columns[t].withSortDirection(Yt.NONE);return this}},{key:"clearRows",value:function(){for(;this.rows.length;){var e=this.rows.shift();this.clientDOMNode.removeChild(e.getRootDOMNode()),this.gutterDOMNode.removeChild(e.getGutterNumberDOMNode())}this.withClientHeight(0),this.withClientScrollTop(0)}},{key:"dispose",value:function(){for(this.emptyStateHTMLDOMNode.innerHTML="",this.rootDOMNode.removeAttribute("data-num-rows");this.columns.length;){var e=this.columns.shift();this.headerDOMNode.removeChild(e.getRootDOMNode()),this.headerDOMNode.removeChild(e.getResizerDOMNode())}this.clearRows(),this.withClientWidth(0),this.withClientScrollLeft(0),this.updateClientWidth()}},{key:"init",value:function(){!function(e,t){e(t.bodyDOMNode).on("scroll",(function(e){t.withClientScrollLeft(this.scrollLeft),t.withClientScrollTop(this.scrollTop)})),e(t.headerDOMNode).on("mousedown","[data-role=column-resizer]",(function(e){for(var n,r=0,i=t.columns.length;r<i;r++)if(t.columns[r].getResizerDOMNode()===this){n=t.columns[r];break}if(n){var o=n.getWidth(),a=e.clientX,s=function(e){var t=e.clientX-a;n.withWidth(o+t)};document.body.addEventListener("mousemove",s,!0),document.body.addEventListener("mouseup",(function e(t){document.body.removeEventListener("mousemove",s,!0),document.body.removeEventListener("mouseup",e,!0)}),!0)}})).on("click","[data-role=column] > [data-role=caption]",(function(e){if(t.sortable){for(var n,r=this.parentNode,i=0,o=t.columns.length;i<o;i++)t.columns[i].getRootDOMNode()===r?n=t.columns[i]:t.columns[i].getSortDirection()!==Yt.NONE&&t.columns[i].withSortDirection(Yt.NONE);if(n){switch(n.getSortDirection()){case Yt.ASCENDING:case Yt.NONE:default:n.withSortDirection(Yt.DESCENDING);break;case Yt.DESCENDING:n.withSortDirection(Yt.ASCENDING)}t.onColumnSorted(n)}}})),e(t.gutterDOMNode).on("mousedown","> [data-role=gutter-number]",(function(){if(!this.hasAttribute("data-selected")){var n=~~this.getAttribute("data-index");e(t.clientDOMNode).find("> [data-role=row][data-selected]").each((function(){t.rows[~~this.getAttribute("data-index")].withSelectedState(!1)})),t.rows[n].withSelectedState(!0),setTimeout((function(){t.clientDOMNode.focus()}),100)}})),e(t.clientDOMNode).on("mousedown","> [data-role=row]",(function(){if(!this.hasAttribute("data-selected")){var n=~~this.getAttribute("data-index");e(t.clientDOMNode).find("> [data-role=row][data-selected]").each((function(){t.rows[~~this.getAttribute("data-index")].withSelectedState(!1)})),t.rows[n].withSelectedState(!0)}})).on("mousedown","> [data-role=row] > [data-role=cell]",(function(){var e=~~this.getAttribute("data-index"),n=~~this.parentNode.getAttribute("data-index");t.rows[n].withSelectedCellIndex(e)})).on("dblclick","> [data-role=row] > [data-role=cell]",(function(){t.editor.isEditing()||t.editor.editCell(t.getActiveCellCoordinates())})),t.clientDOMNode.addEventListener("keydown",(function(e){var n=e.keyCode||e.charCode,r=e.srcElement||e.target,i=!1;if(r&&-1===["input","select","textarea"].indexOf(r.nodeName.toLowerCase()))switch(n){case 37:t.editor.isEditing()||(i=!0,t.focusPreviousSiblingCell());break;case 39:t.editor.isEditing()||(i=!0,t.focusNextSiblingCell());break;case 38:t.editor.isEditing()||(i=!0,t.focusPreviousRowCell());break;case 40:t.editor.isEditing()||(i=!0,t.focusNextRowCell());break;case 36:t.editor.isEditing()||(i=!0,t.focusFirstColumnCell());break;case 35:t.editor.isEditing()||(i=!0,t.focusLastColumnCell());break;case 33:t.editor.isEditing()||(i=!0,t.focusPageUpCell());break;case 34:t.editor.isEditing()||(i=!0,t.focusPageDownCell());break;case 9:t.editor.isEditing()?(t.editor.doneEditing(),e.shiftKey?t.focusPreviousCell():t.focusNextCell(),t.editor.editCell(t.getActiveCellCoordinates()),i=!0):(i=!0,e.shiftKey?t.focusPreviousCell():t.focusNextCell());break;case 13:t.editor.isEditing()||(t.editor.editCell(t.getActiveCellCoordinates()),i=!0);break;case 27:t.editor.isEditing()&&(t.editor.cancelEditing(),setTimeout((function(){t.clientDOMNode.focus()}),10),i=!0)}else 27===n&&t.editor.isEditing()&&(t.editor.cancelEditing(),setTimeout((function(){t.clientDOMNode.focus()}),10),i=!0),13===n&&t.editor.isEditing()&&(t.editor.doneEditing(),setTimeout((function(){t.clientDOMNode.focus()}),10),i=!0),9===n&&(t.editor.isEditing()?(t.editor.doneEditing(),e.shiftKey?t.focusPreviousCell():t.focusNextCell(),t.editor.editCell(t.getActiveCellCoordinates()),i=!0):(i=!0,e.shiftKey?t.focusPreviousCell():t.focusNextCell(),setTimeout((function(){t.clientDOMNode.focus()}),10)));i&&(e.stopPropagation(),e.preventDefault())}),!0)}(this.jq,this)}},{key:"renderInternalCSS",value:function(){for(var e="",t=0,n=this.columns.length;t<n;t++)e+='\n                [data-role=data-grid][data-grid-uid="'.concat(this.uniqueGridId,'"] > [data-role=body] > [data-role=client] > [data-role=row] > [data-role=cell]:nth-child(').concat(t+1,") {\n                    width: ").concat(this.columns[t].getWidth(),"px\n                }\n            ");this.internalStyleDOMNode.textContent='\n\n            [data-role=data-grid][data-grid-uid="'.concat(this.uniqueGridId,'"] > [data-role=gutter] > [data-role=gutter-number]:first-child {\n                margin-top: -').concat(this.clientScrollTop,'px;\n            }\n\n            [data-role=data-grid][data-grid-uid="').concat(this.uniqueGridId,'"] > [data-role=header] > [data-role=select-all-columns] + [data-role=column] {\n                margin-left: -').concat(this.clientScrollLeft,"px;\n            }\n\n        ")+e}},{key:"getColumns",value:function(){return this.columns}},{key:"withCollection",value:function(e){var t=this;if(this.dispose(),this.collection&&this.collection.dispose(),this.collection=e||null,!this.collection)return this.rootDOMNode.removeAttribute("data-has-footer"),void(this.footerDOMNode.innerHTML="");this.rootDOMNode.setAttribute("data-has-footer",""),this.footerDOMNode.innerHTML=this.collection.getGridFooterHTMLMarkup();for(var n=e.getColumnDescriptors(),r=n.length,i=0;i<r;i++)this.createColumn().withColumnType(n[i].type).withColumnName(n[i].name).withColumnCaption(n[i].caption).withEditable(n[i].editable);return setTimeout((function(){t.collection.setPage(1).fail((function(e){console.error(e)}))}),10),this.collection.onCollectionEmbedded(this.footerDOMNode),this.collection.on("change",(function(){t.clearRows();for(var e=0,n=t.collection.getNumberOfItemsOnCurrentPage();e<n;e++)t.createRow(t.collection.getRowAt(e)).withRowIndex(t.collection.getFirstRowOffsetStart()+e)})),this.collection.on("insert-row",(function(e){for(var n=t.createRow(e),r=0,i=t.rows.length;r<i;r++)t.rows[r]===n?t.rows[r].withSelectedState(!0):t.rows[r].getSelectedState()&&t.rows[r].withSelectedState(!1);t.maintainFocusCellViewportPosition()})),this.collection.on("commit-row",(function(e){t.rows[e].withRowIndex(t.collection.getFirstRowOffsetStart()+e)})),this}},{key:"withEmptyStateHTML",value:function(e){return this.emptyStateHTMLDOMNode.innerHTML=String(e||""),this}},{key:"getCollection",value:function(){return this.collection||null}},{key:"onColumnSorted",value:function(e){this.collection&&this.collection.setSortedColumn(e.getColumnName(),e.getSortDirection())}},{key:"getActiveCellCoordinates",value:function(){for(var e=0,t=0,n=0,r=this.rows.length;n<r;n++){if(this.rows[n].getSelectedState()){for(var i=0,o=Math.min(this.columns.length-1,~~this.rows[n].getSelectedCellIndex());i<o;i++)t+=this.columns[i].getWidth();return{rowIndex:n,columnIndex:this.rows[n].getSelectedCellIndex(),top:e,left:t}}e+=this.rows[n].getHeight()}return null}},{key:"focusPreviousSiblingCell",value:function(){var e=this.getActiveCellCoordinates();e&&0!==e.columnIndex&&(this.rows[e.rowIndex].withSelectedCellIndex(null===e.columnIndex?0:e.columnIndex-1),this.maintainFocusCellViewportPosition())}},{key:"focusNextSiblingCell",value:function(){var e=this.getActiveCellCoordinates();e&&e.columnIndex!==this.columns.length-1&&(this.rows[e.rowIndex].withSelectedCellIndex(null===e.columnIndex?0:e.columnIndex+1),this.maintainFocusCellViewportPosition())}},{key:"focusPreviousRowCell",value:function(){var e=this.getActiveCellCoordinates();e&&0!==e.rowIndex&&null!==e.columnIndex&&(this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null),e.rowIndex--,this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition())}},{key:"focusNextRowCell",value:function(){var e=this.getActiveCellCoordinates();if(e&&e.rowIndex!==this.rows.length-1&&null!==e.columnIndex){this.clientDOMNode.offsetHeight;this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null),e.rowIndex++,this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition()}}},{key:"focusFirstColumnCell",value:function(){var e=this.getActiveCellCoordinates();e&&0!==e.columnIndex&&(this.rows[e.rowIndex].withSelectedCellIndex(0),this.maintainFocusCellViewportPosition())}},{key:"focusLastColumnCell",value:function(){var e=this.getActiveCellCoordinates();e&&e.columnIndex!==this.columns.length-1&&(this.rows[e.rowIndex].withSelectedCellIndex(this.columns.length-1),this.maintainFocusCellViewportPosition())}},{key:"focusPageUpCell",value:function(){var e=this.getActiveCellCoordinates();if(e&&0!==e.rowIndex&&null!==e.columnIndex){var t=this.clientDOMNode.offsetHeight;for(this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null);e.rowIndex>0&&t>0;)t-=this.rows[e.rowIndex].getHeight(),e.rowIndex--;this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition()}}},{key:"focusPageDownCell",value:function(){var e=this.getActiveCellCoordinates();if(e&&e.rowIndex!==this.rows.length-1&&null!==e.columnIndex){var t=this.clientDOMNode.offsetHeight;for(this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null);e.rowIndex<this.rows.length-1&&t>0;)t-=this.rows[e.rowIndex].getHeight(),e.rowIndex++;this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition()}}},{key:"focusNextCell",value:function(){var e=this.getActiveCellCoordinates();e&&(null!==e.columnIndex?e.columnIndex<this.columns.length-1?this.focusNextSiblingCell():(this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null),e.rowIndex++,e.rowIndex>=this.rows.length&&(e.rowIndex=0),e.columnIndex=0,this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition()):this.focusNextSiblingCell())}},{key:"focusPreviousCell",value:function(){var e=this.getActiveCellCoordinates();e&&(null!==e.columnIndex?e.columnIndex>0?this.focusPreviousSiblingCell():(this.rows[e.rowIndex].withSelectedState(!1),this.rows[e.rowIndex].withSelectedCellIndex(null),e.rowIndex--,e.rowIndex<0&&(e.rowIndex=this.rows.length-1),e.columnIndex=this.columns.length-1,this.rows[e.rowIndex].withSelectedState(!0),this.rows[e.rowIndex].withSelectedCellIndex(e.columnIndex),this.maintainFocusCellViewportPosition()):this.focusPreviousSiblingCell())}},{key:"maintainFocusCellViewportPosition",value:function(){var e=this.getActiveCellCoordinates();if(e){var t=this.rows[e.rowIndex].getRootDOMNode(),n=t.offsetTop;if(n<this.bodyDOMNode.scrollTop)this.bodyDOMNode.scrollTop=n;else{var r=t.offsetHeight,i=this.bodyDOMNode.offsetHeight-20;this.bodyDOMNode.scrollTop+i<n+r&&(this.bodyDOMNode.scrollTop=n+r-i)}if(null!==e.columnIndex){var o=this.rows[e.rowIndex].getCells()[e.columnIndex],a=o.offsetLeft;if(a<this.bodyDOMNode.scrollLeft)this.bodyDOMNode.scrollLeft=a;else{var s=o.offsetWidth,u=this.bodyDOMNode.offsetWidth-20;this.bodyDOMNode.scrollLeft+u<a+s&&(this.bodyDOMNode.scrollLeft=a+s-u)}}}}},{key:"getRows",value:function(){return this.rows}},{key:"onRowUpdated",value:function(e,t,n,r){if(this.trigger("row-updated",e,t,n,r),this.collection){for(var i=null,o=0,a=this.rows.length;o<a;o++)if(this.rows[o]===e){i=o;break}this.collection.updateRow(i,t,n).then((function(){})).fail((function(n){e.setDataAt(t,r),console.error(n)}))}}}]),n}(b.b);y()(rn,"styleId",0);var on=n(48156),an=n(88042);function sn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var un=function(e){f()(n,e);var t=sn(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n)}(b.b);function cn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ln=function(e){f()(n,e);var t=cn(n);function n(e,r,i){var o;return a()(this,n),o=t.call(this),y()(l()(o),"numberOfPages",0),y()(l()(o),"numberOfItemsPerPage",14),y()(l()(o),"rows",[]),y()(l()(o),"currentPage",null),y()(l()(o),"jq",void 0),y()(l()(o),"tableName",void 0),y()(l()(o),"database",void 0),y()(l()(o),"sortColumnName",void 0),y()(l()(o),"sortColumnDirection",void 0),y()(l()(o),"embeddedRootNode",void 0),y()(l()(o),"rowOffsetStart",0),y()(l()(o),"selectedRowIndex",void 0),y()(l()(o),"newRows",[]),o.jq=e,o.tableName=/^`(\S+)`$/.test(r)?r:"`".concat(r,"`"),o.database=i,"controls"===o.tableName&&(o.numberOfItemsPerPage=99999),o}return u()(n,[{key:"getNumberOfPages",value:function(){return this.numberOfPages}},{key:"getNumberOfItemsPerPage",value:function(){return this.numberOfItemsPerPage}},{key:"getColumnDescriptors",value:function(){for(var e=this.database.getTable(this.tableName).describe(),t=[],r=0,i=e.length;r<i;r++)t.push({caption:e[r].name,name:e[r].name,type:n.convertJQLColumnTypeToGridColumnType(e[r].type),editable:!0});return t}},{key:"getCurrentPageNumber",value:function(){return this.currentPage}},{key:"setPage",value:function(e){return function(t,n){return n.Deferred((function(n){var r=t.getUncomittedRows();try{var i=t.database.createStatement(t.computePageFetchSQL(e,t.numberOfItemsPerPage,t.sortColumnName,t.sortColumnDirection));t.database.executeStatement(i).then((function(n){t.setSelectedRowIndex(null),t.onNumberOfPagesChanged(t.computeNumberOfPages(n.getCalcFoundRows())),t.rowOffsetStart=(e-1)*t.numberOfItemsPerPage+1,t.onCurrentPageChanged(e),t.rows=[];for(var i=0,o=n.getRowsAsArray(),a=o.length;i<a;i++)t.rows.push(o[i]);t.newRows=[];for(var s=0,u=r.length;s<u;s++)t.rows.push(r[s]),t.newRows.push(t.rows.length-1);t.trigger("change")})).catch((function(e){n.reject(e)}))}catch(o){n.reject(o)}})).promise()}(this,this.jq)}},{key:"getNumberOfItemsOnCurrentPage",value:function(){return this.rows.length}},{key:"getRowAt",value:function(e){return JSON.parse(JSON.stringify(this.rows[e]))}},{key:"setSortedColumn",value:function(e,t){return this.sortColumnName=e,this.sortColumnDirection=t,this.setPage(this.currentPage)}},{key:"getGridFooterHTMLMarkup",value:function(){return'\n            <button data-role="previous-page"><span class="i-md i123-arrow_left"></span></button>\n            <label data-role="current-page"><span>Page: </span><input type="number" name="current-page" value="1" min="1" max="1" /></label>\n            <label data-role="total-pages"><span>of&nbsp;</span><span data-role="total-pages">0</span></label>\n            <button data-role="next-page"><span class="i-md i123-arrow_right"></span></button>\n            <span style="width: 20px"></span>\n            <button data-role="refresh" title="Refresh"><span class="i-md i123-refresh"></span></button>\n            <span style="width: 20px"></span>\n            <button data-role="insert-row" title="Insert row"><span class="i-md i123-add"></span></button>\n            <button data-role="delete-current-row" disabled title="Delete row"><span class="i-md i123-delete"></span></button>\n        '}},{key:"onCollectionEmbedded",value:function(e){!function(t,n){n.embeddedRootNode=e,t(e).find("input[name=current-page]").on("change",(function(){var e=~~this.value;e>=1&&e<=n.getNumberOfPages()?n.setPage(e):this.value=n.getCurrentPageNumber()})),t(e).find("button[data-role=previous-page]").on("click",(function(){n.getCurrentPageNumber()<=1||n.setPage(n.getCurrentPageNumber()-1)})),t(e).find("button[data-role=next-page]").on("click",(function(){n.getCurrentPageNumber()>=n.getNumberOfPages()||n.setPage(n.getCurrentPageNumber()+1)})),t(e).find("button[data-role=delete-current-row]").on("click",(function(){null!==n.selectedRowIndex&&n.deleteRow(n.selectedRowIndex)})),t(e).find("button[data-role=insert-row]").on("click",(function(){var e=n.createRow();n.rows.push(e),n.newRows.push(n.rows.length-1),n.trigger("insert-row",e)})),t(e).find("button[data-role=refresh]").on("click",(function(){n.setPage(n.getCurrentPageNumber())}))}(this.jq,this)}},{key:"dispose",value:function(){this.events=void 0}},{key:"computePageFetchSQL",value:function(e,t,n,r){var i="";return this.database.getTable(this.tableName).isVirtual()||"session"===this.tableName||(i+="REMOTE "),i+="SELECT SQL_CALC_FOUND_ROWS * FROM "+this.tableName,!n||r!==Yt.DESCENDING&&r!==Yt.ASCENDING||(i+=" ORDER BY "+n,this.sortColumnDirection==Yt.ASCENDING?i+=" ASC":i+=" DESC"),i+=" LIMIT "+(e-1)*t+","+t,console.warn(i),i}},{key:"computeNumberOfPages",value:function(e){return e%this.numberOfItemsPerPage===0?~~(e/this.numberOfItemsPerPage):1+~~(e/this.numberOfItemsPerPage)}},{key:"onNumberOfPagesChanged",value:function(e){this.numberOfPages=e,function(t,n){t(n.embeddedRootNode).find("span[data-role=total-pages]").each((function(){this.textContent=String(e)})),t(n.embeddedRootNode).find("input[name=current-page]").attr("max",String(e))}(this.jq,this)}},{key:"getFirstRowOffsetStart",value:function(){return this.rowOffsetStart}},{key:"onCurrentPageChanged",value:function(e){this.currentPage=e,function(t,n){t(n.embeddedRootNode).find("input[name=current-page]").each((function(){this.value!=e&&(this.value=e)}))}(this.jq,this)}},{key:"updateRow",value:function(e,t,n){return function(r,i){if(i.isUncommitedRow(e))return i.rows[e][t]=n,i.attemptToInsertRow(e),r.Deferred((function(e){e.resolve(!0)}));try{var o=i.database.getTable(i.tableName),a=o.describe(),s=[],u="";o.isVirtual()||"session"===i.tableName||(u+="REMOTE "),u+="UPDATE "+i.tableName+" SET `"+a[t].name+"` = :____new_value____ WHERE ";for(var c={____new_value____:n},l=0,h=a.length;l<h;l++)a[t].name!=a[l].name&&(null!==i.castBinding(i.rows[e][l],a[l].type)?(s.push("`"+a[l].name+"` = :"+a[l].name),c[a[l].name]=i.castBinding(i.rows[e][l],a[l].type)):s.push("`"+a[l].name+"` IS NULL"));u+=s.join(" AND "),u+=" LIMIT 1";var f=i.database.createStatement(u);return console.warn(u),r.Deferred((function(r){i.database.executeStatement(f,c).then((function(o){1===o.getAffectedRows()?(i.rows[e][t]=n,r.resolve(!0)):r.reject(new Error("No rows affected!"))})).catch((function(e){r.reject(e)}))}))}catch(d){return r.Deferred((function(e){e.reject(d)}))}}(this.jq,this)}},{key:"setSelectedRowIndex",value:function(e){this.selectedRowIndex=0===e?0:e||null,function(e,t,n){e(t).find("button[data-role=delete-current-row]").each((function(){this.disabled=null===n}))}(this.jq,this.embeddedRootNode,this.selectedRowIndex)}},{key:"deleteRow",value:function(e){return function(t,n){if(n.isUncommitedRow(e))return n.deleteUncommitedRow(e),n.setPage(n.getCurrentPageNumber());try{var r=n.database.getTable(n.tableName).describe(),i="";"session"!==n.tableName&&(i+="REMOTE "),i+="DELETE FROM "+n.tableName+" WHERE ";for(var o={},a=0,s=r.length;a<s;a++)null!==n.castBinding(n.rows[e][a],r[a].type)?(i+=(a>0?" AND ":"")+"`"+r[a].name+"` = :"+r[a].name,o[r[a].name]=n.castBinding(n.rows[e][a],r[a].type)):i+=(a>0?" AND ":"")+"`"+r[a].name+"` IS NULL";i+=" LIMIT 1";var u=n.database.createStatement(i);return console.warn(i),t.Deferred((function(e){n.database.executeStatement(u,o).then((function(t){1===t.getAffectedRows()?(n.setPage(n.getCurrentPageNumber()),e.resolve(!0)):e.reject(new Error("No rows affected!"))})).catch((function(t){e.reject(t)}))}))}catch(c){return console.error(c),t.Deferred((function(e){e.reject(c)}))}}(this.jq,this)}},{key:"castBinding",value:function(e,t){switch(t){case E.DW.BOOLEAN:return null===e?null:"0"!==e&&!!~~e;case E.DW.NUMBER:if(null===e)return null;var n=parseFloat(String(e));return!isNaN(n)&&isFinite(n)?n:null;default:return e}}},{key:"createRow",value:function(){for(var e=[],t=this.database.getTable(this.tableName).describe(),n=0,r=t.length;n<r;n++)switch(t[n].type){case E.DW.BOOLEAN:e.push(!1);break;case E.DW.STRING:e.push("");break;case E.DW.NUMBER:e.push(0);break;default:case E.DW.NULL:e.push(null)}return e}},{key:"isUncommitedRow",value:function(e){return this.newRows.indexOf(e)>-1}},{key:"deleteUncommitedRow",value:function(e){this.rows.splice(e,1);for(var t=0,n=this.newRows.length;t<n;t++)if(this.newRows[t]===e){this.newRows.splice(t,1);break}for(var r=0,i=this.newRows.length;r<i;r++)if(this.newRows[r]>e){this.newRows[r]--;break}}},{key:"markRowAsComitted",value:function(e){for(var t=0,n=this.newRows.length;t<n;t++)if(this.newRows[t]===e){this.newRows.splice(t,1);break}this.trigger("commit-row",e)}},{key:"getUncomittedRows",value:function(){for(var e=[],t=0,n=this.newRows.length;t<n;t++)e.push(this.rows[this.newRows[t]]);return e}},{key:"attemptToInsertRow",value:function(e){return function(t,n){if(!n.isUncommitedRow(e))return t.Deferred((function(e){e.reject(new Error("Row is already in comitted state!"))})).promise();try{var r=n.database.getTable(n.tableName).describe(),i="";i+="REMOTE ",i+="INSERT INTO "+n.tableName+" SET ";for(var o={},a=0,s=r.length;a<s;a++)null!==n.castBinding(n.rows[e][a],r[a].type)?(i+=(a>0?" , ":"")+"`"+r[a].name+"` = :"+r[a].name,o[r[a].name]=n.castBinding(n.rows[e][a],r[a].type)):i+=(a>0?" , ":"")+"`"+r[a].name+"` = NULL";var u=n.database.createStatement(i);return console.warn(i),t.Deferred((function(t){n.database.executeStatement(u,o).then((function(r){n.markRowAsComitted(e),t.resolve(!0)})).catch((function(e){t.reject(e)}))}))}catch(c){return t.Deferred((function(e){e.reject(c)}))}}(this.jq,this)}}],[{key:"convertJQLColumnTypeToGridColumnType",value:function(e){switch(e){case E.DW.STRING:return Wt.mF.STRING;case E.DW.NUMBER:return Wt.mF.NUMBER;case E.DW.BOOLEAN:return Wt.mF.BOOLEAN;case E.DW.NULL:default:return Wt.mF.UNKNOWN}}}]),n}(un);function hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var fn=function(e){f()(n,e);var t=hn(n);function n(){return a()(this,n),t.apply(this,arguments)}return u()(n,[{key:"getGridFooterHTMLMarkup",value:function(){return'\n            <button data-role="previous-page"><span class="i-md i123-arrow_left"></span></button>\n            <label data-role="current-page"><span>Page: </span><input type="number" name="current-page" value="1" min="1" max="1" /></label>\n            <label data-role="total-pages"><span>of&nbsp;</span><span data-role="total-pages">0</span></label>\n            <button data-role="next-page"><span class="i-md i123-arrow_right"></span></button>\n        '}}]),n}(ln),dn=function(){function e(t,n,r,i){var o=this;a()(this,e),y()(this,"uniqueId",void 0),y()(this,"rootDOMNode",void 0),y()(this,"actionTypeDOMNode",void 0),y()(this,"formControlsList",void 0),y()(this,"targetControlDOMNode",void 0),y()(this,"sqlTextEditor",void 0),y()(this,"sql",""),y()(this,"db",void 0),y()(this,"errorDOMNode",void 0),y()(this,"error",null),y()(this,"statement",null),y()(this,"toolbarDOMNode",void 0),y()(this,"jq",void 0),y()(this,"carretCharIndex",0),y()(this,"carretLineIndex",0),y()(this,"commandDispatcher",void 0),y()(this,"onCursorPositionChangedThrottled",void 0),y()(this,"editorInited",!1),y()(this,"parentRule",void 0),y()(this,"active",!1),this.db=n,this.jq=r,this.commandDispatcher=i,e.UID++,this.uniqueId=e.UID,this.rootDOMNode=document.createElement("div"),this.rootDOMNode.setAttribute("data-role","action"),this.rootDOMNode.setAttribute("data-action-uid",String(this.uniqueId)),this.actionTypeDOMNode=document.createElement("select"),this.actionTypeDOMNode.setAttribute("data-role","action-type"),this.rootDOMNode.appendChild(this.actionTypeDOMNode),this.formControlsList=t,this.targetControlDOMNode=document.createElement("select"),this.targetControlDOMNode.setAttribute("data-role","target-control"),this.rootDOMNode.appendChild(this.targetControlDOMNode),this.toolbarDOMNode=document.createElement("div"),this.toolbarDOMNode.setAttribute("data-role","toolbar"),this.rootDOMNode.appendChild(this.toolbarDOMNode),this.iniToolbar(),this.errorDOMNode=document.createElement("div"),this.errorDOMNode.setAttribute("data-role","error"),this.onCursorPositionChangedThrottled=N.X.create((function(){o.onCursorPositionChanged()}),300),this.initActionTypeDOMNode(),this.initTargetControlDOMNode(),this.actionTypeDOMNode.onchange=function(){o.onCursorPositionChangedThrottled(),o.onErrorStateChanged()},this.targetControlDOMNode.onchange=function(){o.onCursorPositionChangedThrottled(),o.onErrorStateChanged()}}return u()(e,[{key:"asyncInitCodeMirrorEditor",value:function(){this.editorInited||(!function(e,t,n,r,i,o){e.sqlTextEditor=null===(t=CodeMirror)||void 0===t?void 0:t(e.rootDOMNode,{value:"asd",mode:"text/x-mariadb",lineNumbers:!0}),e.rootDOMNode.appendChild(e.errorDOMNode),null===(n=e.sqlTextEditor)||void 0===n||n.setSize("100%","80px"),null===(r=e.sqlTextEditor)||void 0===r||r.setValue(e.sql),null===(i=e.sqlTextEditor)||void 0===i||i.on("change",(function(){var t,n;e.sql=null!==(t=null===(n=e.sqlTextEditor)||void 0===n?void 0:n.getValue())&&void 0!==t?t:"",e.onSQLQueryChanged()})),null===(o=e.sqlTextEditor)||void 0===o||o.on("cursorActivity",(function(t){var n=t.getCursor();e.carretCharIndex=n.ch,e.carretLineIndex=n.line,e.onCursorPositionChangedThrottled()}))}(this),this.editorInited=!0)}},{key:"getRootDOMNode",value:function(){return this.rootDOMNode}},{key:"getUniqueId",value:function(){return this.uniqueId}},{key:"initActionTypeDOMNode",value:function(){var e=document.createElement("option");e.text="Execute SQL using:",e.value="run",this.actionTypeDOMNode.add(e),(e=document.createElement("option")).text="Set value of control:",e.value="set",this.actionTypeDOMNode.add(e)}},{key:"initTargetControlDOMNode",value:function(){var e=document.createElement("option");e.text="[Select]",e.value="",this.targetControlDOMNode.add(e);for(var t=0,n=this.formControlsList.length;t<n;t++)(e=document.createElement("option")).text=this.formControlsList[t].name,e.value=this.formControlsList[t].id,this.targetControlDOMNode.appendChild(e)}},{key:"getError",value:function(){return this.error}},{key:"getStatement",value:function(){return this.statement}},{key:"onSQLQueryChanged",value:function(){try{if(""===String(this.sql).trim())return this.rootDOMNode.removeAttribute("data-error-state"),this.errorDOMNode.textContent="",this.error=null,this.statement=null,void this.onErrorStateChanged();this.statement=this.db.createStatement(this.sql),this.errorDOMNode.textContent="",this.error=null,this.onErrorStateChanged()}catch(e){this.errorDOMNode.textContent=String(e).replace(/^Error: /g,"").replace(/^Failed to create statement: /g,""),this.error=e,this.statement=null,this.onErrorStateChanged()}}},{key:"iniToolbar",value:function(){this.toolbarDOMNode.innerHTML='\n            <button data-role="insert-table" title="Insert table"><span class="i-md i123-memory" ></span></button>\n            <button data-role="insert-column" title="Insert column"><span class="i-md i123-reports" ></span></button>\n            <button data-role="insert-control" title="Insert form control"><span class="i-md i123-input_area" ></span></button>\n            <div data-role="editor-selection-feedback"></div>\n        ',function(e,t){e(t.toolbarDOMNode).on("click","button[data-role]",(function(){switch(this.getAttribute("data-role")){case"insert-table":t.commandDispatcher.browserForDatabaseTablesDialog().then((function(e){var n;null===(n=t.sqlTextEditor)||void 0===n||n.replaceSelection(e,!0)}));break;case"insert-column":t.commandDispatcher.browserForDatabaseTableColumnsDialog().then((function(e){var n;null===(n=t.sqlTextEditor)||void 0===n||n.replaceSelection(e,!0)}));break;case"insert-control":t.commandDispatcher.browseForFormsControlDialog().then((function(e){var n;null===(n=t.sqlTextEditor)||void 0===n||n.replaceSelection(e,!0)}))}}))}(this.jq,this)}},{key:"onCursorPositionChanged",value:function(){var e=this.sql.split("\n")[this.carretLineIndex],t=this.getIdentifierFromStringPosition(e,this.carretCharIndex);!function(e){/^control_[\d]+(_[\d]+)?$/.test(t)?e.jq(e.toolbarDOMNode).find("[data-role=editor-selection-feedback]").each((function(){for(var n="<b>UNKNOWN</b> control <b>:"+t+"</b>",r=0,i=e.formControlsList.length;r<i;r++)if(e.formControlsList[r].id==t){n="<b>:"+t+"</b> => <b>"+e.formControlsList[r].name+"</b>";break}this.innerHTML=n})):"this"===t?e.jq(e.toolbarDOMNode).find("[data-role=editor-selection-feedback]").each((function(){if(e.getParentRule().getControlId()){for(var t="",n=e.getParentRule().getControlId(),r=0,i=e.formControlsList.length;r<i;r++)e.formControlsList[r].id===n&&(t=e.formControlsList[r].name);this.innerHTML=t?"<b>:this</b> => <b>"+t+"</b> (:"+n+")":"<b>:this</b> => Select a control on the rule"}else this.innerHTML="<b>:this</b> => Select a control on the rule"})):e.jq(e.toolbarDOMNode).find("[data-role=editor-selection-feedback]").text("")}(this)}},{key:"getIdentifierFromStringPosition",value:function(t,n){var r,i,o="",a="",s=t.length;for(i=n-1;i>=0&&e.IDENTIFIER_CHARS.indexOf(r=t.charAt(i))>-1;)o=r+o,i--;for(i=n;i<s&&e.IDENTIFIER_CHARS.indexOf(r=t.charAt(i))>-1;)a+=r,i++;return(o+a).replace(/^[0-9]+/g,"")}},{key:"withSQL",value:function(e){return this.sql=e||"",this.carretLineIndex=0,this.carretCharIndex=0,this.onSQLQueryChanged(),this.onErrorStateChanged(),this}},{key:"withControlId",value:function(e){for(var t=0,n=this.formControlsList.length;t<n;t++)if(this.formControlsList[t].id===e)return this.targetControlDOMNode.value=e,this;var r=document.createElement("option");return r.value=e,r.text="DELETED "+e,this.targetControlDOMNode.add(r),this.targetControlDOMNode.value=e,this}},{key:"getControlId",value:function(){return this.targetControlDOMNode.value}},{key:"getSQL",value:function(){return this.sql}},{key:"onErrorStateChanged",value:function(){this.statement&&(this.statement.getStatementType()===E.ko.SELECT?"set"!==this.actionTypeDOMNode.value&&(this.actionTypeDOMNode.value="set"):"run"!==this.actionTypeDOMNode.value&&(this.actionTypeDOMNode.value="run"));var e=this.rootDOMNode.hasAttribute("data-has-errors");this.error||!this.statement?e||(this.rootDOMNode.setAttribute("data-has-errors",""),this.parentRule&&this.parentRule.onErrorStateChanged()):e&&(this.rootDOMNode.removeAttribute("data-has-errors"),this.parentRule&&this.parentRule.onErrorStateChanged())}},{key:"getParentRule",value:function(){return this.parentRule}},{key:"withParentRule",value:function(e){return this.parentRule=e,this}},{key:"setActive",value:function(e){return this.active=!!e,this.active?this.rootDOMNode.setAttribute("data-selected",""):this.rootDOMNode.removeAttribute("data-selected"),this}},{key:"isActive",value:function(){return this.active}}]),e}();y()(dn,"IDENTIFIER_CHARS","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789"),y()(dn,"UID",0);var pn=function(){function e(t){var n=this;a()(this,e),y()(this,"uniqueId",void 0),y()(this,"rootDOMNode",void 0),y()(this,"controlsDOMNode",void 0),y()(this,"eventsDOMNode",void 0),y()(this,"controlId",null),y()(this,"eventTypeId",null),y()(this,"index",null),y()(this,"selected",!1),y()(this,"formControlsList",void 0),y()(this,"actions",[]),e.UID++,this.uniqueId=e.UID,this.rootDOMNode=document.createElement("div"),this.rootDOMNode.setAttribute("data-role","rule"),this.controlsDOMNode=document.createElement("select"),this.controlsDOMNode.setAttribute("data-role","control"),this.rootDOMNode.appendChild(this.controlsDOMNode),this.eventsDOMNode=document.createElement("select"),this.eventsDOMNode.setAttribute("data-role","event"),this.formControlsList=t,this.initFormControlsList(),this.controlsDOMNode.onchange=function(){n.controlId=""===n.controlsDOMNode.value?null:n.controlsDOMNode.value,n.initEventsDOMNodeDropdown(n.controlsDOMNode.value),n.onErrorStateChanged()},this.eventsDOMNode.onchange=function(){n.eventTypeId=""===n.eventsDOMNode.value?null:parseInt(n.eventsDOMNode.value),n.onErrorStateChanged()},this.initEventsDOMNodeDropdown(this.eventsDOMNode.value),this.rootDOMNode.appendChild(this.eventsDOMNode),this.rootDOMNode.setAttribute("data-rule-uid",String(this.uniqueId)),this.onErrorStateChanged()}return u()(e,[{key:"getControlId",value:function(){return this.controlId}},{key:"withControlId",value:function(e){if(this.controlId=e||null,!this.controlId)return this.controlsDOMNode.value="",this;for(var t=-1,n=0,r=this.formControlsList.length;n<r;n++)if(this.formControlsList[n].id===e){t=n;break}if(-1===t&&"control_0"!==e){var i=document.createElement("option");i.value=e,i.text="DELETED "+this.controlId,this.controlsDOMNode.add(i)}return this.controlsDOMNode.value=this.controlId,this.initEventsDOMNodeDropdown(this.controlsDOMNode.value),this.onErrorStateChanged(),this}},{key:"getEventTypeId",value:function(){return this.eventTypeId}},{key:"withEventTypeId",value:function(e){return this.eventTypeId=e,this.eventsDOMNode.value=null===e?"":String(e),this.onErrorStateChanged(),this}},{key:"getRootDOMNode",value:function(){return this.rootDOMNode}},{key:"initEventsDOMNodeDropdown",value:function(e){for(var t=this.eventsDOMNode.value;this.eventsDOMNode.options.length;)this.eventsDOMNode.remove(0);var n=document.createElement("option");n.value="",n.text="[Select]",this.eventsDOMNode.add(n),"control_0"!==e?((n=document.createElement("option")).value=JSON.stringify(E.a4.ALL_EVENTS),n.text="* Any",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.INIT),n.text="Initialized",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.CHANGE),n.text="Changed",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.CHECK),n.text="Checked",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.UNCHECK),n.text="Unchecked",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.TEXT_INPUT),n.text="Edited",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.INIT),n.text="Initialized",(n=document.createElement("option")).value=JSON.stringify(E.a4.REINITIALIZE),n.text="Reloaded",this.eventsDOMNode.add(n)):((n=document.createElement("option")).value=JSON.stringify(E.a4.SUBMITTED),n.text="Submitted",this.eventsDOMNode.add(n),(n=document.createElement("option")).value=JSON.stringify(E.a4.APPROVED),n.text="Approved",this.eventsDOMNode.add(n)),this.eventsDOMNode.value=t,-1===this.eventsDOMNode.selectedIndex&&(this.eventsDOMNode.selectedIndex=0)}},{key:"initFormControlsList",value:function(){for(;this.controlsDOMNode.options.length;)this.controlsDOMNode.remove(0);var e=document.createElement("option");e.value="",e.text="[Select]",this.controlsDOMNode.add(e),(e=document.createElement("option")).value="control_0",e.text="[This Form]",this.controlsDOMNode.add(e);for(var t=0,n=this.formControlsList.length;t<n;t++)(e=document.createElement("option")).value=this.formControlsList[t].id,e.text=this.formControlsList[t].name,this.controlsDOMNode.add(e)}},{key:"isSelected",value:function(){return this.selected}},{key:"setSelected",value:function(e){this.selected=!!e,this.selected?this.rootDOMNode.setAttribute("data-selected",""):this.rootDOMNode.removeAttribute("data-selected")}},{key:"getUniqueId",value:function(){return this.uniqueId}},{key:"addAction",value:function(e){return this.actions.push(e),e.withParentRule(this),e}},{key:"deleteAction",value:function(e){for(var t=0,n=this.actions.length;t<n;t++)if(this.actions[t]===e)return this.actions.splice(t,1)[0];return null}},{key:"getActions",value:function(){return this.actions.slice(0)}},{key:"getActionByUniqueId",value:function(e){for(var t=0,n=this.actions.length;t<n;t++)if(this.actions[t].getUniqueId()===e)return this.actions[t];return null}},{key:"onErrorStateChanged",value:function(){if(this.controlId&&null!==this.eventTypeId){for(var e=0,t=this.actions.length;e<t;e++)if(this.actions[e].getRootDOMNode().hasAttribute("data-has-errors"))return void this.rootDOMNode.setAttribute("data-has-errors","");this.rootDOMNode.removeAttribute("data-has-errors")}else this.rootDOMNode.setAttribute("data-has-errors","")}},{key:"getSelectedAction",value:function(){for(var e=0,t=this.actions.length;e<t;e++)if(this.actions[e].isActive())return this.actions[e];return null}},{key:"setSelectedAction",value:function(e){for(var t=0,n=this.actions.length;t<n;t++)this.actions[t]===e?this.actions[t].setActive(!0):this.actions[t].isActive()&&this.actions[t].setActive(!1)}},{key:"moveActionUp",value:function(e){var t=null;if(!(this.actions.length<2)){for(var n=0,r=this.actions.length;n<r;n++)if(this.actions[n]===e){t=n;break}if(0!==t&&null!==t){this.actions.splice(t,1);var i=e.getRootDOMNode().previousSibling;e.getRootDOMNode().parentNode.removeChild(e.getRootDOMNode()),this.actions.splice(t-1,0,e),i.parentNode.insertBefore(e.getRootDOMNode(),i)}}}},{key:"moveActionDown",value:function(e){var t=null;if(!(this.actions.length<2)){for(var n=0,r=this.actions.length;n<r;n++)if(this.actions[n]===e){t=n;break}if(t!==this.actions.length-1&&null!==t){this.actions.splice(t,1);var i=e.getRootDOMNode().nextSibling;e.getRootDOMNode().parentNode.removeChild(e.getRootDOMNode()),this.actions.splice(t+1,0,e),i.parentNode.insertBefore(e.getRootDOMNode(),i.nextSibling)}}}}]),e}();function gn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}y()(pn,"UID",0);var vn=function(e){f()(n,e);var t=gn(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),y()(l()(e),"rules",[]),e}return u()(n,[{key:"addRule",value:function(e){this.rules.length;return this.rules.push(e),this.trigger("change"),e}},{key:"deleteRule",value:function(e){for(var t=0,n=this.rules.length;t<n;t++)if(this.rules[t]===e){var r=this.rules.splice(t,1)[0];return this.trigger("change"),r}return null}},{key:"setSelectedRule",value:function(e){for(var t=0,n=this.rules.length;t<n;t++)this.rules[t]===e?this.rules[t].setSelected(!0):this.rules[t].isSelected()&&this.rules[t].setSelected(!1)}},{key:"getSelectedRule",value:function(){for(var e=0,t=this.rules.length;e<t;e++)if(this.rules[e].isSelected())return this.rules[e];return null}},{key:"getRuleByUniqueId",value:function(e){for(var t=0,n=this.rules.length;t<n;t++)if(this.rules[t].getUniqueId()===e)return this.rules[t];return null}},{key:"getRules",value:function(){return this.rules}},{key:"getJQLConfiguration",value:function(){for(var e=[],t=0,n=this.rules.length;t<n;t++){for(var r={actions:[],eventType:this.rules[t].getEventTypeId(),controlId:this.rules[t].getControlId()},i=0,o=this.rules[t].getActions(),a=o.length;i<a;i++)r.actions.push({controlId:o[i].getControlId(),jql:o[i].getSQL()});e.push(r)}return e}},{key:"moveRuleUp",value:function(e){var t=null;if(!(this.rules.length<2)){for(var n=0,r=this.rules.length;n<r;n++)if(this.rules[n]===e){t=n;break}if(0!==t&&null!==t){this.rules.splice(t,1);var i=e.getRootDOMNode().previousSibling;e.getRootDOMNode().parentNode.removeChild(e.getRootDOMNode()),this.rules.splice(t-1,0,e),i.parentNode.insertBefore(e.getRootDOMNode(),i)}}}},{key:"moveRuleDown",value:function(e){var t=null;if(!(this.rules.length<2)){for(var n=0,r=this.rules.length;n<r;n++)if(this.rules[n]===e){t=n;break}if(t!==this.rules.length-1&&null!==t){this.rules.splice(t,1);var i=e.getRootDOMNode().nextSibling;e.getRootDOMNode().parentNode.removeChild(e.getRootDOMNode()),this.rules.splice(t+1,0,e),i.parentNode.insertBefore(e.getRootDOMNode(),i.nextSibling)}}}}],[{key:"createFromJQLFormRulesConfiguration",value:function(e,t,r,i,o){for(var a=new n,s=0,u=e.length;s<u;s++){var c=a.addRule(new pn(t));c.withControlId(e[s].controlId).withEventTypeId(e[s].eventType);for(var l=0,h=(e[s].actions||[]).length;l<h;l++){c.addAction(new dn(t,r,i,o)).withSQL(e[s].actions[l].jql).withControlId(e[s].actions[l].controlId)}}return setTimeout((function(){for(var e=0,t=a.getRules(),n=t.length;e<n;e++)t[e].onErrorStateChanged()}),100),a}}]),n}(b.b);function mn(){mn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(I){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&T()(t.prototype,d)?t:d,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:N(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(I){return{type:"throw",arg:I}}}e.wrap=l;var f={};function d(){}function p(){}function g(){}var v={};c(v,a,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(O([])));y&&y!==t&&n.call(y,a)&&(v=y);var b=g.prototype=d.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(r,a,s,u){var c=h(e[r],e,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i()(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,s,u)}),(function(e){o("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return o("throw",e,s,u)}))}u(c.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function N(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function O(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:D}}function D(){return{value:void 0,done:!0}}return p.prototype=g,r(b,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:p,configurable:!0}),p.displayName=c(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},E(w.prototype),c(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(b),c(b,u,"Generator"),c(b,a,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=O,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}var yn=function(){function e(t){a()(this,e),y()(this,"app",void 0),y()(this,"csvParserOptions",{endOfLineCharacter:"\r\n",columnsEnclosedBy:'"',columnsTerminatedBy:",",fieldsEscapedBy:"",autoTrimAllFields:!0,allColumnsAreEnclosed:!1}),this.app=t}return u()(e,[{key:"setApplicationEnabledStateAction",value:function(e){var t,n,r;t=this.app.getJQuery(),n=this.app,r=this.app,this.app.getResourceManager(),t.ajax("/sf_applications_actions.php",{type:"POST",data:{someaction:"applications_csvconnector_enable_disable",appid:String(r.getApplicationId()),formid:String(r.getFormId()),a_enabled:e?"1":"0"}}).then((function(t){"OK"===String(t||"").trim()&&(e?n.createNotification("Virtual Database & SQL Manager application settings saved successfully",!1,Wt.s9.SUCCESS,!0):n.createNotification("Virtual Database & SQL Manager application was successfully disabled for this form",!1,Wt.s9.SUCCESS,!0))})).fail((function(){n.createNotification("Failed to change Virtual Database & SQL Manager enabled state",!1,Wt.s9.ERROR,!0)}))}},{key:"createNewTableAction",value:function(){!function(e,t,n,r,i){r.get("/modules/RulesV3/resources/create-new-table-action.html").then((function(n){var r=new an.a(n),o=null,a=t.createDialog("Create new table",[{type:Wt.ML.CREATE,callback:function(){var n=a.dialog.getElementsByClassName("ui-buttons")[0],r=Array.from(n.children).filter((function(e){return e.dataset.role==="button-type-".concat(Wt.ML.CREATE.toString())}))[0],s=e(a.dialog).find("[data-role=create-new-table-loader]"),u=function(){r.disabled=!1,s.hide()};try{var c={csvFile:o,tableName:e(a.body).find("label[data-role=database-name] input").val(),tableNamespace:e(a.body).find("label[data-role=database-global-flag] input").is(":checked")?E.W.GLOBAL:E.W.FORM,tableAccessMode:e(a.body).find("label[data-role=table-write-access] input").is(":checked")?E.yo.READ_WRITE:E.yo.READ,tableStorageEngine:e(a.body).find("label[data-role=table-storage-engine] input").is(":checked")?E.Ev.REMOTE:E.Ev.IN_MEMORY,csvFieldEnclosure:i.csvParserOptions.columnsEnclosedBy,csvEncloseAllFields:i.csvParserOptions.allColumnsAreEnclosed,csvFieldDelimiter:i.csvParserOptions.columnsTerminatedBy,csvEscapeCharacter:i.csvParserOptions.fieldsEscapedBy,csvAutoTrim:i.csvParserOptions.autoTrimAllFields,csvLineTerminator:i.csvParserOptions.endOfLineCharacter};if(!c.tableName)throw new Error("Please input a Database table name");if(!o)throw new Error("Please select a CSV file first");if(!o.size)throw new Error("Selected file is empty. Please select a non-empty file");if(!/^([\s\S]+)\.csv$/i.test(o.name))throw new Error('Selected file seems not to be a csv file ("'.concat(o.type,'"). Please select a CSV file'));if(o.size>15728640)throw new Error("Selected file size is greater than 15Mb, which is the maximum csv file size");r.disabled=!0,s.show(),i.app.getDatabase().createTableFromCSVFile(c).then((function(){u(),t.alert("Table created","Table '".concat(c.tableName,"' was successfully created!"),(function(){a.close()}))})).catch((function(e){u(),t.alert("Failed to create table",'There was an error encountered while trying to create your table. Please inspect if the "Advanced options" settings are set up correctly.')}))}catch(l){u(),t.alert("Error creating database table",String(l||"").replace(/^Error: /g,""))}}},{type:Wt.ML.CANCEL,callback:function(){a.close()}}],{width:"600px"});a.body.innerHTML=r.parse({}),a.body.setAttribute("data-dialog-role","csv-connector-create-table-dialog");e(a.body).each((function(){e(this).on("click","label[data-role=database-source] a",(function(){i.editAdvancedCSVSettingsPreferencesAction()})),e(this).find("label[data-role=csv-file] input[type=file]").on("change",(function(){o=this.files[0],e(a.body).find("label[data-role=csv-file]").addClass("has-file").find("span.file-name").text(o.name),this.value=null})),e(this).find("label[data-role=csv-file] a").on("click",(function(){e(a.body).find("label[data-role=csv-file]").removeClass("has-file").find("span.file-name").text(""),o=null}))}))})).fail((function(e){t.createNotification('Failed to load "modules/RulesV3/resources/create-new-table-action.html',!1,Wt.s9.ERROR,!0)}))}(this.app.getJQuery(),this.app,this.app,this.app.getResourceManager(),this)}},{key:"editAdvancedCSVSettingsPreferencesAction",value:function(){!function(e,t,n,r,i){r.get("/modules/RulesV3/resources/edit-csv-import-file-options.html").then((function(n){var r=new an.a(n),o=JSON.parse(JSON.stringify(i.csvParserOptions)),a=t.createDialog("Advanced options",[{type:Wt.ML.DONE,callback:function(){e(a.body).each((function(){e(this).find("label[data-role=auto-trim-all-fields] input").each((function(){i.csvParserOptions.autoTrimAllFields=this.checked})),e(this).find("label[data-role=enclose-all-fields] input").each((function(){i.csvParserOptions.allColumnsAreEnclosed=this.checked})),e(this).find("label[data-role=end-of-line] select").each((function(){i.csvParserOptions.endOfLineCharacter=i.html2RawString(this.value)})),e(this).find("label[data-role=columns-terminated-by] select").each((function(){i.csvParserOptions.columnsTerminatedBy=i.html2RawString(this.value)})),e(this).find("label[data-role=fields-escaped-by] select").each((function(){i.csvParserOptions.fieldsEscapedBy=i.html2RawString(this.value)})),e(this).find("label[data-role=columns-enclosed-by] select").each((function(){i.csvParserOptions.columnsEnclosedBy=i.html2RawString(this.value)}))})),a.close()}},{type:Wt.ML.CANCEL,callback:function(){a.close()}}],{width:"700px"});a.body.innerHTML=r.parse(o),a.body.setAttribute("data-dialog-role","csv-connector-edit-csv-options"),e(a.body).each((function(){e(this).find("label[data-role=auto-trim-all-fields] input").each((function(){this.checked=o.autoTrimAllFields})),e(this).find("label[data-role=enclose-all-fields] input").each((function(){this.checked=o.allColumnsAreEnclosed})),e(this).find("label[data-role=end-of-line] select").each((function(){this.value=i.rawString2HTML(o.endOfLineCharacter)})),e(this).find("label[data-role=columns-terminated-by] select").each((function(){this.value=i.rawString2HTML(o.columnsTerminatedBy)})),e(this).find("label[data-role=fields-escaped-by] select").each((function(){this.value=i.rawString2HTML(o.fieldsEscapedBy)})),e(this).find("label[data-role=columns-enclosed-by] select").each((function(){this.value=i.rawString2HTML(o.columnsEnclosedBy)})),e(this).find("form").on("submit",(function(e){e.preventDefault(),e.stopPropagation()}))}))})).fail((function(e){t.createNotification('Failed to load "modules/RulesV3/resources/edit-csv-import-file-options.html',!0,Wt.s9.ERROR,!0)}))}(this.app.getJQuery(),this.app,this.app,this.app.getResourceManager(),this)}},{key:"exploreDatabasesAction",value:function(){!function(e,t,n,r,o){r.get("/modules/RulesV3/resources/explore-database-dialog.html").then((function(r){var a,s,u={tables:function(){for(var e=[],t=n.getDatabase().enumerateTables(),r=0,i=t.length;r<i;r++){var o=n.getDatabase().getTable(t[r].name);e.push({name:t[r].name,isRemote:o.isRemote(),isInMemory:!o.isRemote()&&!o.isVirtual(),isVirtual:o.isVirtual(),isTransactional:o.isTransactional(),isIndexable:o.isIndexable()})}return e}()},c=new an.a(r),l=t.createDialog("Explore database",[],{width:"920px",height:"600px"});l.body.innerHTML=c.parse(u),l.dialog.setAttribute("data-dialog-role","explore-database-dialog");e(l.body).on("click","[data-role=table]",(function(){!function(t){console.warn("set view: ",t),t!==s&&(e(l.dialog).attr("data-has-selected-table",""),e(l.body).find("[data-role=tables-list] > [data-role=table]").each((function(){e(this).attr("data-selected",this.getAttribute("data-name")===t?"":null)})),s=t,0,a=a||new rn(o.app.getJQuery()).withSortingEnabled(!0),window.g=a,e(l.body).find("[data-role=selected-table]").each((function(){this.appendChild(a.getRootDOMNode()),n.getDatabase().getTable(t).isVirtual()?a.withCollection(new fn(e,t,n.getDatabase())).withEmptyStateHTML("Table <b>".concat(t,"</b> is a virtual table, which is only available ")+"in <b>view form</b> mode."):a.withCollection(new ln(e,t,n.getDatabase())).withEmptyStateHTML("There are no items to show in this view")})))}(this.getAttribute("data-name"))})),e(l.body).on("click","[data-role=tables-operations] button[data-role=drop-database]",(function(){var n=null;e(l.body).find("[data-role=tables-list] > [data-role=table][data-selected]").each((function(){n=this.getAttribute("data-name")})),n&&t.prompt("Confirm table deletion",'Are you sure you want to delete table "'.concat(n,'"?'),(function(){o.app.getDatabase().dropTable(n,{applicationConfig:btoa(o.app.getDatabase().getApplicationConfig())}).then((function(){e(l.body).find("[data-role=tables-list] > [data-role=table][data-selected]").remove(),a&&a.getRootDOMNode()&&a.getRootDOMNode().parentNode.removeChild(a.getRootDOMNode()),e(l.dialog).attr("data-has-selected-table",null)})).catch((function(e){t.alert("Failed to delete table",'Failed to delete table "'.concat(s,'"'))}))}))})).on("click","[data-role=tables-operations] button[data-role=download-database]",(function(){var r=null;e(l.body).find("[data-role=tables-list] > [data-role=table][data-selected]").each((function(){r=this.getAttribute("data-name")})),r&&(n.getDatabase().getTable(r).isVirtual()?t.alert("Table not exportable",'Table "'.concat(r,'" is a virtual table, and cannot be exported to CSV!')):o.app.getDatabase().downloadTableAsCSV(r,{applicationConfig:btoa(o.app.getDatabase().getApplicationConfig())}).then((function(e){"string"===typeof e?on.i.download(e,"".concat(r,".csv"),"text/csv"):"object"===i()(e)&&e.value?on.i.download(e.value,"".concat(r,".csv"),"text/csv"):t.alert("Table export failed!","There was an error exporting your table as CSV!")})).catch((function(e){t.alert("Table export failed!","There was an error exporting your table as CSV!"),console.error(e)})))})).on("click","[data-role=tables-operations] button[data-role=database-indexes]",(function(){var t=null;e(l.body).find("[data-role=tables-list] > [data-role=table][data-selected]").each((function(){t=this.getAttribute("data-name")})),t&&o.editTableIndexes(t)}))})).fail((function(e){t.createNotification('Failed to load "modules/RulesV3/resources/explore-database-dialog.html"',!0,Wt.s9.ERROR,!0)}))}(this.app.getJQuery(),this.app,this.app,this.app.getResourceManager(),this)}},{key:"editFormRulesAction",value:function(){!function(e,t,n,r,i){e.when(r.get("/modules/RulesV3/resources/edit-rules-dialog.html")).then((function(r){n.getDatabase().getJQLFormConfiguration({applicationConfig:btoa(n.getDatabase().getApplicationConfig())}).then((function(o){var a,s,u,c=new an.a(r),l=vn.createFromJQLFormRulesConfiguration(o||[],n.getFormControlsList(),n.getDatabase(),e,i),h=t.createDialog("Edit SQL rules",[{type:Wt.ML.SAVE,callback:function(){n.getDatabase().saveJQLFormConfiguration(l.getJQLConfiguration(),{applicationConfig:btoa(n.getDatabase().getApplicationConfig())}).then((function(){h.close()})).catch((function(){t.alert("Error saving configuration","There was an error saving configuration. Please fix errors, and try again")}))}},{type:Wt.ML.CANCEL,callback:function(){h.close()}}],{width:"800px",height:"800px"});h.dialog.setAttribute("data-dialog-role","edit-sql-rules"),h.body.innerHTML=c.parse({});var f=function(e){for(;u.firstChild;)u.removeChild(u.firstChild);if(e){u.setAttribute("data-rule-uid",String(e.getUniqueId()));for(var t=e.getActions(),n=t.length,r=0;r<n;r++)u.appendChild(t[r].getRootDOMNode()),t[r].asyncInitCodeMirrorEditor();e.setSelectedAction(e.getActions()[0]||null)}else u.removeAttribute("data-rule-id")};e(h.body).find("[data-role=rules]").each((function(){e(a=this).on("click","> [data-role=rule]",(function(){var e=~~this.getAttribute("data-rule-uid"),t=l.getRuleByUniqueId(e);l.setSelectedRule(t),f(t)}))})),e(h.body).find("[data-role=actions]").each((function(){e(u=this).on("mousedown","> [data-role=action]",(function(){var e=l.getSelectedRule();e.setSelectedAction(e.getActionByUniqueId(~~this.getAttribute("data-action-uid")))}))})),e(h.body).find("[data-role=rules-toolbar]").each((function(){s=this})),e(h.body).find("[data-role=actions-toolbar]").each((function(){e(this).on("click","button[data-role=create-action]",(function(){var t,r,o=~~u.getAttribute("data-rule-uid"),a=l.getRuleByUniqueId(o);t=a,r=new dn(n.getFormControlsList(),n.getDatabase(),e,i),t.addAction(r),u.appendChild(r.getRootDOMNode()),r.asyncInitCodeMirrorEditor(),t.setSelectedAction(r),t.onErrorStateChanged()})).on("click","button[data-role=delete-action]",(function(){var e=~~u.getAttribute("data-rule-uid"),n=l.getRuleByUniqueId(e);if(n){var r,i,o=n.getSelectedAction();if(o)r=n,i=o,t.prompt("Delete action","Are you sure you want to delete this action?",(function(){u.removeChild(i.getRootDOMNode()),r.deleteAction(i),r.setSelectedAction(null),r.onErrorStateChanged()}))}})).on("click","button[data-role=move-up]",(function(){var e=l.getSelectedRule();if(e){var t=e.getSelectedAction();t&&e.moveActionUp(t)}})).on("click","button[data-role=move-down]",(function(){var e=l.getSelectedRule();if(e){var t=e.getSelectedAction();t&&e.moveActionDown(t)}}))})),e(s).on("click","button[data-role=create-rule]",(function(){var e;e=new pn(n.getFormControlsList()),l.addRule(e),a.appendChild(e.getRootDOMNode()),l.setSelectedRule(e),f(e)})).on("click","button[data-role=delete-rule]",(function(){var e=l.getSelectedRule();e&&function(e){t.prompt("Delete rule","Are you sure you want to delete this rule containing ".concat(e.getActions().length," actions?"),(function(){for(l.deleteRule(e),a.removeChild(e.getRootDOMNode());u.firstChild;)u.removeChild(u.firstChild)}))}(e)})).on("click","button[data-role=move-up]",(function(){l.moveRuleUp(l.getSelectedRule())})).on("click","button[data-role=move-down]",(function(){l.moveRuleDown(l.getSelectedRule())})),function(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var e=0,t=l.getRules(),n=t.length;e<n;e++)a.appendChild(t[e].getRootDOMNode());if(l.getRules().length){var r=l.getRules()[0];l.setSelectedRule(r),f(r)}}()})).catch((function(e){throw e}))}))}(this.app.getJQuery(),this.app,this.app,this.app.getResourceManager(),this)}},{key:"getTestConnectionButton",value:function(){return this.app.getJQuery()("[data-role=csv-remote-connection-dialog] #connection-test-button")}},{key:"getConnectionDialogFormSerializedData",value:function(){return btoa(this.app.getJQuery()("#form-connection-dialog").serialize())}},{key:"getDialogSaveButton",value:function(){return this.app.getJQuery()(".ui-dialog .ui-buttons button.btn-secondary-cta")}},{key:"disableDialogSaveButton",value:function(){var e=this.getDialogSaveButton();e&&e.attr("disabled","disabled")}},{key:"enableDialogSaveButton",value:function(){var e=this.getDialogSaveButton();e&&e.removeAttr("disabled")}},{key:"disableDialogTestConnectionButton",value:function(){var e=this.getTestConnectionButton();e&&e.attr("disabled","disabled")}},{key:"enableDialogTestConnectionButton",value:function(){var e=this.getTestConnectionButton();e&&e.removeAttr("disabled")}},{key:"setTextConnectionValue",value:function(e){this.getObjectConnectionTestInput().val(e)}},{key:"getDialogCopyErrorButton",value:function(){return document.querySelector(".ui-dialog .ui-buttons button.btn-copy-error")}},{key:"testConnection",value:function(){var e,t,n=this,r=(this.getTestConnectionButton(),this.getDialogCopyErrorButton()),i=this.getObjectTestConnectionMessageContainer(),o=this.getObjectTestConnectionMessageExtraDetailsContainer(),a=this.getObjectTestConnectionLoaderContainer(),s=this.getConnectionDialogFormSerializedData();r.innerHTML='\n            <i class="i123-duplicate" style="margin-right: 5px;"></i><span>'.concat(r.innerText,"</span>\n            "),this.disableDialogTestConnectionButton(),e=this.app.getJQuery(),this.app,t=this.app,this.app.getResourceManager(),i.hide(),i.removeClass("errorInDialog"),o.html(""),a.show(),e.when(e.ajax("/sf_applications_actions.php",{type:"POST",data:{someaction:"applications_csvconnector_remote_test_connection",formid:String(t.getFormId()),appid:String(t.getApplicationId()),application_service:"36",formData:s}})).then((function(e,t){n.enableDialogTestConnectionButton();var s=JSON.parse(e);a.hide(),i.parent().show(),s.success?(i.removeClass("errorInDialog"),n.setTextConnectionValue(1),n.enableDialogSaveButton(),n.disableDialogTestConnectionButton()):(i.addClass("errorInDialog"),s.errorDetails?(o.html("".concat(s.errorDetails,".")),o.addClass("errorInDialog").css("display","-webkit-box"),r.style.setProperty("display","block")):(o.removeClass("errorInDialog").html(""),r.style.setProperty("display","none")),n.setTextConnectionValue(0),n.disableDialogSaveButton(),n.enableDialogTestConnectionButton()),i.css("display","-webkit-box"),i.html(s.message)})).fail((function(e){a.hide(),i.parent().show(),i.css("display","-webkit-box"),i.html(e.toString),n.enableDialogTestConnectionButton()}))}},{key:"getObjectTestConnectionLoaderContainer",value:function(){return this.app.getJQuery()(".ui-dialog .ui-body  [data-role=test-connection-loader]")}},{key:"getObjectTestConnectionMessageContainer",value:function(){return this.app.getJQuery()(".ui-dialog .ui-body  [data-role=csv-remote-test-connection-message]")}},{key:"getObjectTestConnectionMessageExtraDetailsContainer",value:function(){return this.app.getJQuery()(".ui-dialog .ui-body  [data-role=csv-remote-test-connection-message-extra-details]")}},{key:"getObjectConnectionTestInput",value:function(){return this.app.getJQuery()("#connection-test")}},{key:"isConnectionTested",value:function(){return Boolean(1==this.getObjectConnectionTestInput().val())}},{key:"applyOriginalState",value:function(){this.setTextConnectionValue(0),this.getObjectTestConnectionMessageContainer().parent().hide(),this.getObjectTestConnectionMessageContainer().hide(),this.getObjectTestConnectionMessageExtraDetailsContainer().hide(),this.getDialogCopyErrorButton().style.setProperty("display","none"),this.disableDialogSaveButton(),this.enableDialogTestConnectionButton(),this.getObjectTestConnectionMessageContainer().attr("title","")}},{key:"fillConnectionFields",value:function(){var e={};try{e=JSON.parse(window["CSVConnectorApplicationBox".concat(String(this.app.getApplicationId()))].config)}catch(t){}e&&e.connection&&(e.connection.dbType&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-type').val(e.connection.dbType),e.connection.host&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-host').val(e.connection.host),e.connection.port&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-port').val(e.connection.port),e.connection.username&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-username').val(e.connection.username),e.connection.dbname&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-database-name').val(e.connection.dbname),e.connection.isPublicConnection&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-is-public').val(e.connection.isPublicConnection),e.connection.charset&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-charset').val(e.connection.charset),e.connection.collation&&this.app.getJQuery()('form[name="form-connection-dialog"] #connection-collation').val(e.connection.collation))}},{key:"useExternalDbAction",value:function(){var e,t,n,r=this;e=this.app.getJQuery(),t=this.app,n=this.app,this.app.getResourceManager().get("/modules/RulesV3/resources/connect-external-db-dialog.html").then((function(i){var o,a=t.createDialog("Connect to external database",[{type:Wt.ML.SAVE,callback:function(){if(r.isConnectionTested()){var t=r.getConnectionDialogFormSerializedData();e.when(e.ajax("/sf_applications_actions.php",{type:"POST",data:{someaction:"applications_csvconnector_remote_save_connection",formid:String(n.getFormId()),appid:String(n.getApplicationId()),application_service:"36",formData:t}})).then((function(t,r){var i=JSON.parse(t);i&&i.data&&i.data.useRemoteDatabaseText&&e("#CSVAppBoxConnectionSetExternalDBText-".concat(String(n.getApplicationId()))).html(i.data.useRemoteDatabaseText),window["CSVConnectorApplicationBox".concat(String(n.getApplicationId()))].withConfig(i.config),window["CSVConnectorApplicationBox".concat(String(n.getApplicationId()))].updateRulesV3Data(i),window["CSVConnectorApplicationBox".concat(String(n.getApplicationId()))].applyUseConnectionExternalDB(),a.close(),window.location.reload()})).fail((function(e){}))}}},{type:Wt.ML.CANCEL,callback:function(){a.close()}},{type:Wt.ML.COPY_ERROR,callback:(o=zt()(mn().mark((function e(t,n){var r,i;return mn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.dialog.querySelector("#form-connection-dialog")){e.next=2;break}return e.abrupt("return");case 2:return r=document.querySelector('[data-role="csv-remote-test-connection-message-extra-details"]').textContent,i=function(){var e=zt()(mn().mark((function e(t){var n,r,i;return mn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=navigator)||void 0===n||null===(r=n.clipboard)||void 0===r?void 0:r.writeText)){e.next=5;break}return e.next=3,navigator.clipboard.writeText(t);case 3:e.next=16;break;case 5:(i=document.createElement("textarea")).value=t,i.setAttribute("readonly",""),i.setAttribute("aria-hidden","true"),i.style.position="absolute",i.style.left="-9999px",document.body.appendChild(i),i.select(),i.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(i);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=6,i(r);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})}],{width:"600px"});a.body.innerHTML=i,r.applyOriginalState(),r.fillConnectionFields()}))}},{key:"removeApplicationAction",value:function(){var e,t,n;e=this.app.getJQuery(),t=this.app,n=this.app,this.app.getResourceManager().get("/modules/RulesV3/resources/remove-application-dialog.html").then((function(r){var i=t.createDialog("Remove application",[{type:Wt.ML.DELETE,callback:function(){var t=e(i.body).find("[name=delete-sql-rules]").is(":checked");e.when(e.ajax("/sf_applications_actions.php",{type:"POST",data:{someaction:"applications_remove",formid:String(n.getFormId()),application_id:String(n.getApplicationId()),application_service:"36",withRules:t}}),n.getDatabase().deleteAllAssociatedSettingsAndAllTables({applicationconfig:btoa(n.getDatabase().getApplicationConfig())})).then((function(e,t){i.close()})).fail((function(e){}))}},{type:Wt.ML.CANCEL,callback:function(){i.close()}}],{width:"500px"});i.body.innerHTML=r}))}},{key:"rawString2HTML",value:function(e){return JSON.stringify(e||"").replace(/(^"|"$)/g,"").replace(/^\\\\$/g,"\\").replace(/^\\"$/g,'"')}},{key:"html2RawString",value:function(e){return'"'===e?'"':JSON.parse('"'.concat(e.replace(/^\\$/g,"\\\\"),'"'))}},{key:"convertJQLColumnTypeToGridColumnType",value:function(e){switch(e){case E.DW.STRING:return Wt.mF.STRING;case E.DW.NUMBER:return Wt.mF.NUMBER;case E.DW.BOOLEAN:return Wt.mF.BOOLEAN;case E.DW.NULL:default:return Wt.mF.UNKNOWN}}},{key:"editTableIndexes",value:function(e){var t,n,r,i;t=this.app.getJQuery(),n=this.app,r=this.app,i=this.app.getResourceManager(),r.getDatabase().getTable(e).isIndexable()?i.get("/modules/RulesV3/resources/edit-table-indexes-dialog.html").then((function(i){var o,a=r.getDatabase().getTable(e),s=new an.a(i),u=n.createDialog("Edit indexes",[{type:Wt.ML.SAVE,callback:function(){for(var t=[],i=0,a=o.getRows(),s=a.length;i<s;i++)(a[i].getDataAt(2)||a[i].getDataAt(3))&&t.push({autoIncrement:a[i].getDataAt(3),unique:a[i].getDataAt(2),name:a[i].getDataAt(0)});r.getDatabase().getTable(e).alterIndexes(t).then((function(){u.close()})).catch((function(e){console.error(e),n.alert("Error modifying indexes","There was an error while trying to modify the table indexes!")}))}},{type:Wt.ML.CANCEL,callback:function(){u.close()}}],{width:"500px",height:"500px"});u.dialog.setAttribute("data-dialog-role","edit-table-indexes"),u.body.innerHTML=s.parse({}),(o=new rn(t).withSortingEnabled(!1)).createColumn().withColumnName("Column").withColumnType(Wt.mF.STRING).withEditable(!1).withWidth(165),o.createColumn().withColumnName("Type").withColumnType(Wt.mF.STRING).withEditable(!1).withWidth(70),o.createColumn().withColumnName("Unique").withColumnType(Wt.mF.BOOLEAN).withEditable(!0).withWidth(60).withValueRenderer((function(e){return e?'<span class="i-md i123-key icon"></span>':""})),o.createColumn().withColumnName("Auto").withColumnType(Wt.mF.BOOLEAN).withEditable(!0).withWidth(60).withValueRenderer((function(e){return e?'<span class="i-md i123-input_number icon"></span>':""}));for(var c=0,l=a.describe(),h=l.length;c<h;c++){var f=function(e){for(var t=[!1,!1],n=0,r=a.getIndexes(),i=r.length;n<i;n++){var o=r[n].getDescriptors();if(1===o.length&&o[0].name===e){t[0]=r[n].isUnique(),t[1]=r[n].isAutoIncrement();break}}return t}(l[c].name);o.createRow([l[c].name,l[c].type,f[0],f[1]]).withRowIndex(c+1)}o.on("row-updated",(function(e,t,r,i){if(3===t)if(e.getDataAt(1)===E.DW.NUMBER){if(r){e.setDataAt(2,!0);for(var a=0,s=o.getRows(),u=s.length;a<u;a++)s[a]!==e&&s[a].getDataAt(3)&&s[a].setDataAt(3,!1)}}else r&&(e.setDataAt(3,!1),n.alert("Not supported","Only columns of type number can be Auto Incremented"))})),u.body.appendChild(o.getRootDOMNode())})):n.alert("Table not indexable",'Table "'.concat(e,'" does not support indexes!'))}},{key:"browserForDatabaseTablesDialog",value:function(){return e=this.app.getJQuery(),t=this.app.getDatabase(),n=this.app.getResourceManager(),r=this.app,e.Deferred((function(i){n.get("/modules/RulesV3/resources/browse-for-database-table-dialog.html").then((function(n){var o=new an.a(n),a=r.createDialog("Insert table in SQL query",[{type:Wt.ML.OK,callback:function(){a.close();var e=s.getSelectedIndex();if(-1!==e){var t=s.getRows()[e].getDataAt(0);i.resolve(t)}else i.reject(new Error("Canceled"))}},{type:Wt.ML.CANCEL,callback:function(){a.close(),i.reject(new Error("Close button pressed"))}}],{width:"500px",height:"500px",onCloseButtonClick:function(){i.reject(new Error("Dialog closed by user"))}});a.dialog.setAttribute("data-dialog-role","browse-for-table-dialog"),a.body.innerHTML=o.parse({});var s=new rn(e).withEmptyStateHTML("There are no database tables created").withSortingEnabled(!1);a.body.appendChild(s.getRootDOMNode()),s.createColumn().withColumnName("table").withWidth(300).withColumnType(Wt.mF.STRING);for(var u=0,c=t.enumerateTables(),l=c.length;u<l;u++)s.createRow([c[u].name])}))})).promise();var e,t,n,r}},{key:"browserForDatabaseTableColumnsDialog",value:function(){return e=this.app.getJQuery(),t=this.app.getDatabase(),n=this.app.getResourceManager(),r=this.app,e.Deferred((function(i){n.get("/modules/RulesV3/resources/browse-for-database-table-dialog.html").then((function(n){var o=new an.a(n),a=r.createDialog("Insert table column in SQL query",[{type:Wt.ML.OK,callback:function(){a.close();var e=s.getSelectedIndex();if(-1!==e){var t=s.getRows()[e].getDataAt(1);i.resolve(t)}else i.reject(new Error("Canceled"))}},{type:Wt.ML.CANCEL,callback:function(){a.close(),i.reject(new Error("Close button pressed"))}}],{width:"500px",height:"500px",onCloseButtonClick:function(){i.reject(new Error("Dialog closed by user"))}});a.dialog.setAttribute("data-dialog-role","browse-for-table-dialog"),a.body.innerHTML=o.parse({});var s=new rn(e).withEmptyStateHTML("There are no database tables created").withSortingEnabled(!1);a.body.appendChild(s.getRootDOMNode()),s.createColumn().withColumnName("table").withWidth(100).withColumnType(Wt.mF.STRING),s.createColumn().withColumnName("column").withWidth(150).withColumnType(Wt.mF.STRING),s.createColumn().withColumnName("type").withWidth(100).withColumnType(Wt.mF.STRING);for(var u=0,c=t.enumerateTables(),l=c.length;u<l;u++)for(var h=t.getTable(c[u].name).describe(),f=0,d=h.length;f<d;f++)s.createRow([c[u].name,h[f].name,h[f].type])}))})).promise();var e,t,n,r}},{key:"browseForFormsControlDialog",value:function(){return e=this.app.getJQuery(),t=this.app.getFormControlsList(),n=this.app.getResourceManager(),r=this.app,e.Deferred((function(i){n.get("/modules/RulesV3/resources/browse-for-form-control-dialog.html").then((function(n){var o=new an.a(n),a=r.createDialog("Insert control in SQL query",[{type:Wt.ML.OK,callback:function(){a.close();var t=s.getSelectedIndex();if(-1!==t){var n=s.getRows()[t].getDataAt(0),r=e(a.body).find("input[name=insert-as-binding]").is(":checked");i.resolve((r?":":"")+n)}else i.reject(new Error("Canceled"))}},{type:Wt.ML.CANCEL,callback:function(){a.close(),i.reject(new Error("Close button pressed"))}}],{width:"500px",height:"500px",onCloseButtonClick:function(){i.reject(new Error("Dialog closed by user"))}});a.dialog.setAttribute("data-dialog-role","browse-for-control-dialog"),a.body.innerHTML=o.parse({});var s=new rn(e).withEmptyStateHTML("There are no database tables created").withSortingEnabled(!1);e(a.body).find("[data-role=grid-placeholder]").get(0).appendChild(s.getRootDOMNode()),s.createColumn().withColumnName("control_id").withColumnCaption("ID").withWidth(180).withColumnType(Wt.mF.STRING),s.createColumn().withColumnName("control_label").withColumnCaption("Label").withWidth(200).withColumnType(Wt.mF.STRING);for(var u=0,c=t.length;u<c;u++)s.createRow([t[u].id,t[u].name])}))})).promise();var e,t,n,r}},{key:"queryDatabaseAction",value:function(){var e,t,n;e=this.app.getJQuery(),t=this.app,n=this.app,this.app.getResourceManager().get("/modules/RulesV3/resources/query-database-dialog.html").then((function(r){var i,o,a=new an.a(r),s=t.createDialog("Database console",[],{width:"800px"});s.dialog.setAttribute("data-dialog-role","database-console"),s.body.innerHTML=a.parse({});var u=function(t){var r=+new Date;e(s.body).find("[data-role=query-result]").each((function(){var i;(i=this).innerHTML="<div data-role=loading>Loading</div>",e(s.body).find("[data-role=query-statistics]").each((function(){!function(a){a.innerHTML="";try{var s=n.getDatabase().createStatement(t);n.getDatabase().executeStatement(s,{}).then((function(t){i.innerHTML="";var n=+new Date;switch(s.getStatementType()){case E.ko.SELECT:!function(t,n,r,i){if(o?o.dispose():o=new rn(e).withSortingEnabled(!1).withEmptyStateHTML("Query returned no rows"),t.appendChild(o.getRootDOMNode()),r.getRows().length){var a=r.getRows()[0],s=0;for(var u in a)o.createColumn().withColumnName("col_".concat(s)).withColumnCaption(u).withWidth(100).withColumnType(Wt.mF.UNKNOWN),s++;for(var c=0,l=r.getRowsAsArray().length,h=r.getRowsAsArray(),f=0,d=h.length;f<d;f++)if(o.createRow(h[f]).withRowIndex(f+1),f>=49){c=d-50;break}e(n).append('<div data-role="info">'.concat(l," row(s) found in ").concat((i/1e3).toFixed(3)," seconds</div>")),0!=c&&e(n).append('<div data-role="info">'.concat(c," row(s) were not displayed</div>"))}}(i,a,t,n-r);break;case E.ko.DELETE:case E.ko.UPDATE:case E.ko.INSERT:!function(t,n,r){e(t).append('<div data-role="info">'.concat(n.getAffectedRows()," row(s) affected in ").concat((r/1e3).toFixed(3)," seconds</div>"))}(a,t,n-r)}})).catch((function(e){var t;i.innerHTML="",t=T()(e,Error)?String(e):"string"===typeof e?e:JSON.stringify(e,void 0,4);var n=document.createElement("div");n.setAttribute("data-role","error"),n.textContent=t.replace(/^Error: /g,""),i.appendChild(n)}))}catch(c){i.innerHTML="";var u=document.createElement("div");u.setAttribute("data-role","error"),u.textContent=c.toString().replace(/^Error: /g,""),i.appendChild(u)}}(this)}))}))};e(s.body).find("[data-role=query-builder]").each((function(){var e,t;null===(t=i=null===(e=CodeMirror)||void 0===e?void 0:e(this,{value:"",mode:"text/x-mariadb",lineNumbers:!0}))||void 0===t||t.setSize("100%","80px")})),e(s.body).on("click","button[data-role=run-query]",(function(){var e,t,n=null!==(e=null===(t=i)||void 0===t?void 0:t.getValue())&&void 0!==e?e:"";u(n)}))}))}},{key:"onChangeConnectionCredentials",value:function(){this.applyOriginalState()}}]),e}(),bn=n(69046),En=function(){function e(t){a()(this,e),y()(this,"jq",void 0),y()(this,"i18n",void 0),this.jq=t,this.i18n=new bn.W,this.i18n.setTranslations({myforms_UI_btn_SAVE:"Save",myforms_UI_btn_CANCEL:"Cancel",myforms_UI_btn_OK:"Ok",myforms_UI_btn_CLOSE:"Close",myforms_UI_btn_YES:"Yes",myforms_UI_btn_NO:"No",applications_UI_btn_CREATE:"Create",applications_UI_btn_DONE:"Done",myforms_UI_btn_DELETE:"Delete",generic_UI_btn_copy_error:"Copy Error"})}return u()(e,[{key:"getI18n",value:function(){return this.i18n}},{key:"getJQuery",value:function(){return this.jq}}]),e}(),wn=function(){function e(){a()(this,e)}return u()(e,null,[{key:"create",value:function(e){return xt.K.createVirtualTable([{name:"index",type:E.DW.NUMBER,default:0},{name:"name",type:E.DW.STRING,default:0},{name:"label",type:E.DW.STRING,default:""},{name:"readOnly",type:E.DW.BOOLEAN,default:!1},{name:"disabled",type:E.DW.BOOLEAN,default:!1},{name:"value",type:E.DW.STRING,default:""},{name:"checked",type:E.DW.BOOLEAN,default:!1},{name:"visible",type:E.DW.BOOLEAN,default:!1},{name:"calculated",type:E.DW.BOOLEAN,default:!1}])}}]),e}(),Tn=function(){function e(){a()(this,e)}return u()(e,null,[{key:"create",value:function(e){return xt.K.createVirtualTable([{name:"userId",type:E.DW.NUMBER,default:0},{name:"userEmail",type:E.DW.STRING,default:""}])}}]),e}();function Nn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var kn,Rn,Sn=function(e){f()(n,e);var t=Nn(n);function n(e,r,i,o,s){var u;return a()(this,n),u=t.call(this,new En(i),i,null,null),y()(l()(u),"applicationId",void 0),y()(l()(u),"formId",void 0),y()(l()(u),"jq",void 0),y()(l()(u),"db",void 0),y()(l()(u),"resourceManager",void 0),y()(l()(u),"formControlsList",[]),y()(l()(u),"commandDispatcher",void 0),y()(l()(u),"onApplicationEnableCheckboxClick",void 0),y()(l()(u),"onCreateNewDatabaseButtonClick",void 0),y()(l()(u),"onExploreDatabaseButtonClick",void 0),y()(l()(u),"onCreateSQLRuleButtonClick",void 0),y()(l()(u),"onRemoveApplicationButtonClick",void 0),y()(l()(u),"onQueryDatabaseButtonClick",void 0),y()(l()(u),"sessionVirtualTable","session"),y()(l()(u),"controlsVirtualTable","controls"),u.jq=i,u.db=o,u.resourceManager=new Jt.Q(u.jq,{}),u.applicationId=e,u.formId=r,u.formControlsList=s,u.commandDispatcher=new yn(l()(u)),function(e,t){e.db.hasTable("controls")||e.db.withTable("controls",wn.create(e.db)),e.db.hasTable("session")||e.db.withTable("session",Tn.create(e.db)),e.onApplicationEnableCheckboxClick=function(t){e._onApplicationEnableCheckboxClick(this)},e.onCreateNewDatabaseButtonClick=function(t){e._onCreateNewTableButtonClick(this)},e.onExploreDatabaseButtonClick=function(t){e._onExploreDatabaseButtonClick(this)},e.onCreateSQLRuleButtonClick=function(t){e._onCreateSQLRuleButtonClick(this)},e.onRemoveApplicationButtonClick=function(t){e._onRemoveApplicationButtonClick(this)},e.onQueryDatabaseButtonClick=function(t){e._onQueryDatabaseButtonClick(this)},t(document).on("click","#app_isenabled_".concat(e.applicationId),e.onApplicationEnableCheckboxClick).on("click","#csvConnectorAppCreateDatabaseButton-".concat(e.applicationId),e.onCreateNewDatabaseButtonClick).on("click","#csvConnectorAppExploreDatabaseButton-".concat(e.applicationId),e.onExploreDatabaseButtonClick).on("click","#csvConnectorAppCustomizeButton-".concat(e.applicationId),e.onCreateSQLRuleButtonClick).on("click","#csvConnectorAppRemoveButton-".concat(e.applicationId),e.onRemoveApplicationButtonClick).on("click","#csvConnectorAppQueryDatabaseButton-".concat(e.applicationId),e.onQueryDatabaseButtonClick).on("click","#csvConnectorAppUseExternalDBButton-".concat(e.applicationId),e._onUseExternalDbButtonClick.bind(e)).on("click","[data-role=csv-remote-connection-dialog] #connection-test-button",e._onTestConnectionButtonClick.bind(e)),t(document).on("change",".ui-dialog select[name=connection-type]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-host]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-port]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-username]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-password]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-database-name]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-charset]",e._onChangeConnectionCredentials.bind(e)).on("change",".ui-dialog input[name=connection-collation]",e._onChangeConnectionCredentials.bind(e))}(l()(u),u.jq),u}return u()(n,[{key:"getApplicationId",value:function(){return this.applicationId}},{key:"getFormId",value:function(){return this.formId}},{key:"getResourceManager",value:function(){return this.resourceManager}},{key:"getJQuery",value:function(){return this.jq}},{key:"getDatabase",value:function(){return this.db}},{key:"getFormControlsList",value:function(){return this.formControlsList}},{key:"destroy",value:function(){!function(e,t){e(document).off("click","#app_isenabled_"+t.applicationId,t.onApplicationEnableCheckboxClick).off("click","#csvConnectorAppCreateDatabaseButton-"+t.applicationId,t.onCreateNewDatabaseButtonClick).off("click","#csvConnectorAppExploreDatabaseButton-"+t.applicationId,t.onExploreDatabaseButtonClick).off("click","#csvConnectorAppCustomizeButton-"+t.applicationId,t.onCreateSQLRuleButtonClick).off("click","#csvConnectorAppRemoveButton-"+t.applicationId,t.onRemoveApplicationButtonClick)}(this.jq,this),this.db=null,this.jq=null}},{key:"_onApplicationEnableCheckboxClick",value:function(e){this.commandDispatcher.setApplicationEnabledStateAction(e.checked)}},{key:"_onCreateNewTableButtonClick",value:function(e){this.commandDispatcher.createNewTableAction()}},{key:"_onExploreDatabaseButtonClick",value:function(e){this.commandDispatcher.exploreDatabasesAction()}},{key:"_onCreateSQLRuleButtonClick",value:function(e){this.commandDispatcher.editFormRulesAction()}},{key:"_onRemoveApplicationButtonClick",value:function(e){this.commandDispatcher.removeApplicationAction()}},{key:"_onQueryDatabaseButtonClick",value:function(e){this.commandDispatcher.queryDatabaseAction()}},{key:"_onUseExternalDbButtonClick",value:function(){this.commandDispatcher.useExternalDbAction()}},{key:"_onTestConnectionButtonClick",value:function(){this.commandDispatcher.testConnection()}},{key:"_onChangeConnectionCredentials",value:function(){this.commandDispatcher.onChangeConnectionCredentials()}},{key:"createNotification",value:function(e){arguments.length>2&&void 0!==arguments[2]||Wt.s9.DEFAULT;console.warn("NOTIFICATION: ",e);try{messages_to_user_push_message(e,0,this.applicationId)}catch(t){}return null}},{key:"getVirtualTables",value:function(){this.db.hasTable(this.controlsVirtualTable)||this.db.withTable(this.controlsVirtualTable,wn.create(this.db)),this.db.hasTable(this.sessionVirtualTable)||this.db.withTable(this.sessionVirtualTable,Tn.create(this.db))}}]),n}(Qt);!function(e){e[e.BY_SETTING_THE_VALUE_ATTRIBUTE=0]="BY_SETTING_THE_VALUE_ATTRIBUTE",e[e.BY_SETTING_THE_CHECKED_ATTRIBUTE=1]="BY_SETTING_THE_CHECKED_ATTRIBUTE",e[e.BY_SETTING_OPTIONS_AND_THEN_VALUE=2]="BY_SETTING_OPTIONS_AND_THEN_VALUE",e[e.BY_CUSTOM_PLUGIN_WHICH_CAN_FAIL=3]="BY_CUSTOM_PLUGIN_WHICH_CAN_FAIL",e[e.BY_USING_PROPRIETARY_DOM_ABSTRACTION_LAYER_METHOD=4]="BY_USING_PROPRIETARY_DOM_ABSTRACTION_LAYER_METHOD"}(kn||(kn={})),function(e){e[e.LEGACY_EDITOR=0]="LEGACY_EDITOR",e[e.LATEST_EDITOR_VERSION=1]="LATEST_EDITOR_VERSION",e[e.LEGACY_SALESFORCE_EDITOR=2]="LEGACY_SALESFORCE_EDITOR",e[e.LATEST_SALESFORCE_EDITOR_VERSION=3]="LATEST_SALESFORCE_EDITOR_VERSION"}(Rn||(Rn={}));var Cn=n(56087);function On(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Dn=function(e){f()(n,e);var t=On(n);function n(e,r){var i;return a()(this,n),i=t.call(this),y()(l()(i),"jq",void 0),y()(l()(i),"controls",[]),y()(l()(i),"formRules",void 0),i.jq=e,i.formRules=r,i.initializeControlMappings(),i.initializeNativeDOMEventsBridge(),function(e){e.on("initialize-platform-specific-tasks",(function(t){setTimeout((function(){e.initializePlatformSpecificTasks(t)}),500)})),setTimeout((function(){for(var t=0,n=e.controls.length;t<n;t++)e.formRules.getLogger().log('Trigger "control-event" EFormRuleEventType.INIT for',e.controls[t].controlId),e.trigger("control-event",E.a4.INIT,e.controls[t].domNode,e.controls[t].controlId)}),100),setTimeout((function(){var t;if(null!==e.formRules.getPreviouslySubmittedFormData())for(var n=0,r=e.controls.length;n<r;n++)t=e.formRules.getSubmissionValueForControlId(e.controls[n].controlId),e.formRules.getLogger().log('Trigger "control-event" EFormRuleEventType.REINITIALIZE for',e.controls[n].controlId,"with value: ",JSON.stringify(t)),e.trigger("control-event",E.a4.REINITIALIZE,e.controls[n].domNode,e.controls[n].controlId,t)}),110),setTimeout((function(){e.formRules.getLogger().log("Enabling user interface"),Cn.M.onInterfaceEnabled()}),500)}(l()(i)),i}return u()(n,[{key:"clearControlsCache",value:function(){}},{key:"getControlValueById",value:function(e){var t,n,r=this.getControlById(e);if(null!==r)switch(n=r.nodeName.toLowerCase()){case"label":case"span":t=this.jq(r).text();break;default:t=this.jq(r).val()}else n="NULL";return this.formRules.getLogger().log("getControlValueById("+e+", "+n+" ) => ",JSON.stringify(t)),t}},{key:"castAnyToString",value:function(e){switch(i()(e)){case"string":return e;case"boolean":return e?"1":"0";case"number":return isFinite(e)?String(e):"0";default:return null===e?"":T()(e,Array)?this.castAnyToString(String(e.join("\t"))||""):String(JSON.stringify(e))}}},{key:"setupTextarea",value:function(e,t){var n=[];if(t)if("string"===typeof t)t&&(n=[String(t)]);else if(t&&T()(t,Array))for(var r=0,i=t.length;r<i;r++)if(t[r]){var o=this.castAnyToString(t[r]);o&&n.push(o)}e.value=n.join("\n")}},{key:"setupDropdown",value:function(e,t){var n,r,i=[];if(t)if("string"===typeof t)t&&(i=[String(t)]);else if(t&&T()(t,Array))for(var o=0,a=t.length;o<a;o++)if(t[o]){var s=this.castAnyToString(t[o]);s&&i.push(s)}for(;e.options.length;)e.remove(0);for(var u=0,c=i.length;u<c;u++)n=document.createElement("option"),r=i[u].split("\t"),n.text=r[0],n.value=r[1]||r[0],e.add(n);e.selectedIndex=i.length?0:-1,this.jq(e).parent().find(".select2-container > a > span:nth-child(1)").text(String(i[0]||"").split("\t")[0])}},{key:"setControlValueById",value:function(e,t){var r=this.getControlById(e);if(null!==r){var i,o=r.nodeName.toLowerCase();switch(o){case"input":switch(i=r.getAttribute("type")){case"checkbox":case"radio":r.checked=n.castAnyToCheckboxOrRadioValue(t),this.formRules.getLogger().log("setControlValueById("+e+" <"+i+">, "+JSON.stringify(n.castAnyToCheckboxOrRadioValue(t)));break;default:r.value=this.castAnyToString(t),this.reinitializeControlThirdPartyPluginsAfterItsValueHasBeenUpdated(r),this.formRules.getLogger().log("setControlValueById("+e+" <"+i+">, "+JSON.stringify(t))}break;case"textarea":this.setupTextarea(r,t),this.formRules.getLogger().log("setControlValueById("+e+" <"+o+">, "+JSON.stringify(t));break;case"select":this.setupDropdown(r,t),this.formRules.getLogger().log("setControlValueById("+e+" <"+o+">, "+JSON.stringify(t));break;case"label":case"span":this.formRules.getLogger().log("setControlValueById("+e+" <"+o+">, "+JSON.stringify(t)+": IGNORED");break;default:console.warn("AbstractionLayer: I don't know how to set the value for a input of type "+JSON.stringify(o))}}else this.formRules.getLogger().log("setControlValueById("+e+"): control not found!")}},{key:"getControlById",value:function(e){for(var t=String(e),n=0,r=this.controls.length;n<r;n++)if(this.controls[n].controlId===t)return this.controls[n].domNode;return null}},{key:"controlExistsInForm",value:function(e){var t=String(e);if(e){for(var n=0,r=this.controls.length;n<r;n++)if(t===this.controls[n].controlId)return!0;return!1}return!1}},{key:"isControl",value:function(e){return function(t,n){switch(e.nodeName.toLowerCase()){case"label":case"span":return n(e).closest(".uberfieldlat").hasClass("uberfieldlat");default:return!0}}(0,this.jq)}},{key:"initializeControlMappings",value:function(){!function(e,t){t("form#mainform123 [id^=id123-control], form#mainform123 #id123-button-send, form#mainform123 [id^=id123-title]").each((function(){e.isControl(this)&&e.controls.push({controlId:n.getControlIdFromDOMNode(this),domNode:this})}))}(this,this.jq)}},{key:"initializeNativeDOMEventsBridge",value:function(){!function(e,t){t("form#mainform123").on("click","input[type=radio], input[type=checkbox]",(function(){e.trigger("control-event",this.checked?E.a4.CHECK:E.a4.UNCHECK,this,n.getControlIdFromDOMNode(this))})).on("change","select, input[type=text], input[type=number],input[type=email], input[type=password], textarea",(function(){e.trigger("control-event",E.a4.CHANGE,this,n.getControlIdFromDOMNode(this))})).on("input","input:not([type=radio]):not([type=checkbox])",(function(){e.trigger("control-event",E.a4.TEXT_INPUT,this,n.getControlIdFromDOMNode(this))}))}(this,this.jq)}},{key:"getControlUpdateValueStrategy",value:function(e){var t=this.getControlById(e);if(null===t)return null;switch(t.nodeName.toLowerCase()){case"input":switch(t.getAttribute("type")){case"checkbox":case"radio":return kn.BY_SETTING_THE_CHECKED_ATTRIBUTE;default:return kn.BY_SETTING_THE_VALUE_ATTRIBUTE}case"textarea":return kn.BY_SETTING_THE_VALUE_ATTRIBUTE;case"select":return kn.BY_SETTING_OPTIONS_AND_THEN_VALUE;default:return kn.BY_CUSTOM_PLUGIN_WHICH_CAN_FAIL}}},{key:"initializeControlValueWhenTheFormIsPrefillingASubmission",value:function(e,t){var r,i=this.getControlUpdateValueStrategy(e);if(null!==i&&null!==t&&void 0!==t)switch(r=this.getControlById(e),i){case kn.BY_SETTING_THE_CHECKED_ATTRIBUTE:r.checked=n.castAnyToCheckboxOrRadioValue(t);break;case kn.BY_SETTING_THE_VALUE_ATTRIBUTE:r.value=String(t||"")||"";break;case kn.BY_SETTING_OPTIONS_AND_THEN_VALUE:this.setupDropdown(r,String(t||"")||""),r.selectedIndex=0;break;case kn.BY_USING_PROPRIETARY_DOM_ABSTRACTION_LAYER_METHOD:console.warn("DOMAbstractionLayer v1: Proprietary dom setters are not implemented by this abstraction layer");case kn.BY_CUSTOM_PLUGIN_WHICH_CAN_FAIL:}}},{key:"getControls",value:function(){return this.controls}},{key:"getJQuery",value:function(){return this.jq}},{key:"reinitializeControlThirdPartyPluginsAfterItsValueHasBeenUpdated",value:function(e){try{"datepicker"==e.dataset.toggle&&this.jq(e).datepicker("update",e.value)}catch(t){}}},{key:"initializePlatformSpecificTasks",value:function(e){if(e&&e.nextPreviewFormData)for(var t=function(t){return e.nextPreviewFormData[t||""]||null},n=this.getControls(),r=this.jq,i=0,o=n.length;i<o;i++)if(null!==t(n[i].controlId)&&""!=t(n[i].controlId)){var a=n[i].domNode;if("SELECT"==a.tagName){for(var s=r(a),u=0,c=s[0].options.length;u<c;u++)s[0].options[u].selected=s[0].options[u].value==t(n[i].controlId);-1!==a.className.indexOf("js-dropdown-searchable")?s.select2():s.trigger("change")}}}},{key:"getCurrentLanguage",value:function(){return"en"}}],[{key:"castAnyToCheckboxOrRadioValue",value:function(e){switch(!0){case"yes"===e:case!0===e:return!0;case"no"===e:case 0===e:return!1;default:return!!e}}},{key:"getControlIdFromDOMNode",value:function(e){return"id123-button-send"===e.id?"submit":String(e.id||e.name||"").replace(/^(id123-)?(control|title)/g,"").replace(/[^\d]+/g,"_")||null}}]),n}(b.b),In=function(){function e(){a()(this,e)}return u()(e,null,[{key:"initDatabaseFunctions",value:function(e){return e.hasLocalFunction("DATE_DIFF")||e.withFunction("DATE_DIFF",Cn.M.DATE_DIFF,!0,!1),e.hasLocalFunction("DATE_BETWEEN")||e.withFunction("DATE_BETWEEN",Cn.M.DATE_BETWEEN,!0,!1),e.hasLocalFunction("DATE_GET_NUMBER_OF_DAYS")||e.withFunction("DATE_GET_NUMBER_OF_DAYS",Cn.M.DATE_GET_NUMBER_OF_DAYS,!0,!1),e.hasLocalFunction("TIME_GET_NUMBER_OF_MINUTES")||e.withFunction("TIME_GET_NUMBER_OF_MINUTES",Cn.M.TIME_GET_NUMBER_OF_MINUTES,!0,!1),e.hasLocalFunction("DATE_FORMAT")||e.withFunction("DATE_FORMAT",Cn.M.DATE_FORMAT,!0,!1),e.hasLocalFunction("CURRENT_DATE")||e.withFunction("CURRENT_DATE",Cn.M.CURRENT_DATE,!0,!1),e.hasLocalFunction("DATE_COMPARE")||e.withFunction("DATE_COMPARE",Cn.M.DATE_COMPARE,!0,!1),e.hasLocalFunction("TIME_COMPARE")||e.withFunction("TIME_COMPARE",Cn.M.TIME_COMPARE,!0,!1),e.hasLocalFunction("DATE_ADD_INTERVAL")||e.withFunction("DATE_ADD_INTERVAL",Cn.M.DATE_ADD_INTERVAL,!0,!1),e.hasLocalFunction("CONCAT")||e.withFunction("CONCAT",Cn.M.CONCAT,!0,!0),e.hasLocalFunction("SUM")||e.withFunction("SUM",Cn.M.SUM,!0,!1),e.hasLocalFunction("EQUALS")||e.withFunction("EQUALS",Cn.M.EQUALS,!0,!1),e.hasLocalFunction("COMPARE")||e.withFunction("COMPARE",Cn.M.COMPARE,!0,!1),e.hasLocalFunction("IF")||e.withFunction("IF",Cn.M.IF,!0,!1),e.hasLocalFunction("BOOL")||e.withFunction("BOOL",Cn.M.BOOL,!0,!1),e.hasLocalFunction("INT")||e.withFunction("INT",Cn.M.INT,!0,!1),e.hasLocalFunction("FLOAT")||e.withFunction("FLOAT",Cn.M.FLOAT,!0,!1),e.hasLocalFunction("STRING")||e.withFunction("STRING",Cn.M.STRING,!0,!1),e.hasLocalFunction("ALERT")||e.withFunction("ALERT",Cn.M.ALERT,!0,!1),e.hasLocalFunction("DATE_UID")||e.withFunction("DATE_UID",Cn.M.UNIQUE_ID_BASED_ON_DATE_MILISECOND,!0,!1),e.hasLocalFunction("WORKING_DAYS_BETWEEN")||e.withFunction("WORKING_DAYS_BETWEEN",null,!1,!0),e.hasLocalFunction("RESERVATION_DATE_INTERSECT")||e.withFunction("RESERVATION_DATE_INTERSECT",null,!1,!0),e.hasLocalFunction("FROM_BASE64")||e.withFunction("FROM_BASE64",Cn.M.FROM_BASE64,!0,!0),e.hasLocalFunction("TO_BASE64")||e.withFunction("TO_BASE64",Cn.M.TO_BASE64,!0,!0),e.hasLocalFunction("REPLACE")||e.withFunction("REPLACE",Cn.M.REPLACE,!0,!0),e}}]),e}(),An=function(){function e(){a()(this,e),y()(this,"enabled",!1);try{window.localStorage&&window.localStorage.getItem&&window.localStorage.getItem("FormRulesDebugging")?(console.log("Rules v3 Logger enabled"),this.enabled=!0):console.log("Rules v3 Logger disabled")}catch(t){console.log("Rules v3 Logger disabled")}}return u()(e,[{key:"log",value:function(){if(!this.enabled&&!window.FormRulesDebugging)return this;for(var e=new Date,t=["[LOG]["+e.getDate()+"."+(e.getMonth()+1)+"."+e.getFullYear()+"@"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+","+e.getMilliseconds()+"]"],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r.length;o<a;o++)t.push("string"===typeof r[o]?r[o]:JSON.stringify(r[o]));return console.log(t.join(" ")),this}}]),e}(),_n=function(){function e(){a()(this,e),y()(this,"queries",{}),y()(this,"active",!1)}return u()(e,[{key:"setActive",value:function(e){return this.active=e,this.active||(this.queries={}),this}},{key:"isActive",value:function(){return this.active}},{key:"isQueryDuplicate",value:function(e){if(!this.active)return!1;if("number"===typeof this.queries[e]&&+new Date-this.queries[e]<50)return!0;return!1}},{key:"storeQuery",value:function(e){this.active&&(this.queries[e]=+new Date)}}]),e}();function xn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Mn=function(e){f()(n,e);var t=xn(n);function n(){var e;return a()(this,n),e=t.call(this),y()(l()(e),"jq",void 0),y()(l()(e),"rpcEndpointName",void 0),y()(l()(e),"rpcEndpointSalesforceName",void 0),y()(l()(e),"authorizationToken",void 0),y()(l()(e),"authorizationTokenSalesforce",void 0),y()(l()(e),"db",void 0),y()(l()(e),"adminApplication",void 0),y()(l()(e),"rules",[]),y()(l()(e),"domAbstractionLayer",void 0),y()(l()(e),"logger",void 0),y()(l()(e),"initialized",!1),y()(l()(e),"previouslySubmittedData",null),y()(l()(e),"duplicateQueryDiscarder",void 0),y()(l()(e),"salesforceAffectedControlsTriggers",void 0),y()(l()(e),"salesforceAffectedControls",void 0),y()(l()(e),"statementCache",{}),y()(l()(e),"applicationConfig",void 0),e.db=In.initDatabaseFunctions(new Ut),e.logger=new An,e.duplicateQueryDiscarder=new _n,e}return u()(n,[{key:"getDatabase",value:function(){return this.db}},{key:"withJQuery",value:function(e){return this.jq=e,this.db.initPlanner(),this}},{key:"withRPCEndpointName",value:function(e){return this.db.withRPCEndpointName(this.rpcEndpointName=e),this}},{key:"withRPCEndpointSalesforceName",value:function(e){return this.db.withRPCEndpointSalesforceName(this.rpcEndpointSalesforceName=e),this}},{key:"withAuthorizationToken",value:function(e){return this.db.withAuthorizationToken(this.authorizationToken=e),this}},{key:"withApplicationConfig",value:function(e){return this.db.withApplicationConfig(this.applicationConfig=e),this}},{key:"withAuthorizationTokenSalesforce",value:function(e){return this.db.withAuthorizationTokenSalesforce(this.authorizationTokenSalesforce=e),this}},{key:"withJQLBackendTables",value:function(e){if(null===e)return this;for(var t=this.db.enumerateTables(),n=0,r=t.length;n<r;n++)this.db.unmountTable(t[n].name);return this.db.withTablesList(e),this}},{key:"withJQLTable",value:function(e,t){return this.db.withTable(e,t),this}},{key:"exploreDatabase",value:function(e){if(!this.domAbstractionLayer)throw new Error("This operation is only available in view-form page!");new yn(e).exploreDatabasesAction()}},{key:"bootstrapCSVConnectorApplication",value:function(e,t,n){var r=/^applications_box_([\d]+)$/.exec(e);if(r){var i=parseInt(r[1]);if(!isNaN(i)){if(this.adminApplication){if(this.adminApplication.getApplicationId()===i&&this.adminApplication.getFormId()===t)return void this.adminApplication.getVirtualTables();this.adminApplication.destroy()}this.adminApplication=new Sn(i,t,window.$||window.$x,this.getDatabase(),n),console.warn("Bootstrapped admin application #".concat(i))}}}},{key:"withDOMAbstractionLayer",value:function(e){return this.domAbstractionLayer=e,this}},{key:"getRules",value:function(){return this.rules}},{key:"resetRules",value:function(e){this.rules=e}},{key:"withRules",value:function(e){for(var t=0,n=(e||[]).length;t<n;t++)this.rules.push(e[t]);return this.logger.log("Added ".concat((e||[]).length," rules in RulesV3 engine")),this}},{key:"initializeInFormViewMode",value:function(){var e=this;if(this.initialized)throw new Error("RulesV3: Engine already initialized!");if(!this.domAbstractionLayer)throw new Error("Cannot initialize RulesV3 engine: No DOMAbstraction layer provided at this point!");return this.domAbstractionLayer.on("control-event",(function(t,n,r,i){e.dispatchControlEvent(t,r,n,i)})),this.domAbstractionLayer.trigger("initialize"),this.initialized=!0,this.logger.log("Initialized RulesV3 in view form mode"),this.markUsedSalesforceControls(),this}},{key:"dispatchControlEvent",value:function(e,t,n,r){var i=this,o=t;if(e===E.a4.REINITIALIZE&&this.initializeControlValueWithPreviouslySubmittedData(t,n,r),this.rules&&this.rules.length){var a=null,s=null,u=null;n&&(!function(e){try{var t=e(n).parents('div[data-type="repeatable-group"]')[0];a=e(t).data("repeatable-path")}catch(r){}}(window.jQuery||window.$||window.$x),a&&(u="".concat(t,"_rp").concat(String(a)),s=n.value));for(var c=0,l=this.rules.length;c<l;c++){var h,f;null!==(t="undefined"!==typeof this.rules[c].repeatablePath&&a?u:o)&&((null===(h=this.rules[c])||void 0===h?void 0:h.isSalesforce)&&this.areTheSameControlIDs(String(this.rules[c].controlId),t)||!(null===(f=this.rules[c])||void 0===f?void 0:f.isSalesforce)&&this.areTheSameControlIDsStrict(String(this.rules[c].controlId),t.replace(/-/g,"_")))&&null!==e&&(e===this.rules[c].eventType&&E.a4.REINITIALIZE!==e||E.a4.ALL_EVENTS===this.rules[c].eventType&&E.a4.REINITIALIZE!==e||E.a4.INIT===e&&this.rules[c].isRule)&&null!==this.rules[c].actions&&this.rules[c].actions.length&&this.executeControlEventActions(this.rules[c].actions,(function(){return s||i.domAbstractionLayer.getControlValueById(t)}),r,e,a)}this.trigger("dispatch",t)}}},{key:"initializeControlValueWithPreviouslySubmittedData",value:function(e,t,n){null!==this.domAbstractionLayer&&this.domAbstractionLayer.initializeControlValueWhenTheFormIsPrefillingASubmission(e,n)}},{key:"areTheSameControlIDsStrict",value:function(e,t){return e.replace(/^control_/g,"")===t.replace(/^control_/g,"")}},{key:"areTheSameControlIDs",value:function(e,t){var n=/^control_[\d]+_[\d]+/,r=e.replace("-","_"),i=t.replace("-","_");return r.match(n)&&(r=r.split("_")[1]),i.match(n)&&(i=i.split("_")[1]),(r=r.replace(/^control_/g,""))===(i=i.replace(/^control_/g,""))}},{key:"executeControlEventActions",value:function(e,t,n,r,i){var o=this;i=i||null;for(var a,s,u,c=+new Date,l=0,h=e.length;l<h;l++)if((a=e[l].jql)&&!/^([\s]+)?$/.test(a))if(this.duplicateQueryDiscarder.isQueryDuplicate(a)||i&&this.hasSalesforceRule())this.logger.log("DISCARD: ",a),setTimeout((function(){o.db.triggerNextQuery()}));else if(this.duplicateQueryDiscarder.storeQuery(a),!e[l].controlId||this.domAbstractionLayer.controlExistsInForm(String(e[l].controlId))){s=function(){return{this:r!==E.a4.REINITIALIZE?t():n}},this.logger.log("SQL: ".concat(a));try{var f=a+e[l].controlId;(u=this.statementCache[f])||(u=this.db.createStatement(a),this.statementCache[f]=u),function(e,t){o.db.executeStatement(e,s).then((function(n){if(n){var r=+new Date;e.getStatementType()===E.ko.SELECT?(o.logger.log("".concat(e.getStatementType()," statement (").concat(((r-c)/1e3).toFixed(3),"s): "),JSON.stringify(n.getRowsAsArray()),"to control: ",String(t.controlId)),o.domAbstractionLayer.setControlValueById(String(t.controlId),n.getRowsAsArray(),null,i)):o.logger.log("".concat(e.getStatementType()," statement (").concat(((r-c)/1e3).toFixed(3),"s): "),n.getAffectedRows(),"rows were affected")}})).catch((function(e){console.warn("SQL failed: ".concat(String(a),": ").concat(e.toString())),console.error(e)}))}(u,e[l])}catch(d){this.logger.log("JQL failed: ","".concat(String(a),": ").concat(d.toString())),console.error(d)}}else console.warn("SKIP QUERY: ","".concat(a," => control id ").concat(JSON.stringify(e[l].controlId)," not found in form")),setTimeout((function(){o.db.triggerNextQuery()}));else setTimeout((function(){o.db.triggerNextQuery()}))}},{key:"getLogger",value:function(){return this.logger}},{key:"getDOMAbstractionLayer",value:function(){return this.domAbstractionLayer}},{key:"getPreviouslySubmittedFormData",value:function(){return this.previouslySubmittedData}},{key:"getSubmissionValueForControlId",value:function(e){return null!==this.previouslySubmittedData&&e&&this.previouslySubmittedData.hasOwnProperty(e)?this.previouslySubmittedData[e]:null}},{key:"createDOMAbstractionLayer",value:function(e){switch(e){case Rn.LEGACY_EDITOR:return new Dn(this.jq,this);case Rn.LATEST_EDITOR_VERSION:return new window.AbstractionLayerV2(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);default:throw new Error("Sorry, but RulesV3 engine don't know how to create a DOM Abstraction layer of type ".concat(JSON.stringify(this.domAbstractionLayer)))}}},{key:"getDuplicateQueryDiscarder",value:function(){return this.duplicateQueryDiscarder}},{key:"markUsedSalesforceControls",value:function(){for(var e=[],t=[],n=0,r=this.rules||[],o=r.length;n<o;n++)if(r[n].isSalesforce){e.push(r[n].controlId);for(var a=0,s=r[n].actions||[],u=s.length;a<u;a++){t.push(s[a].controlId);var c="object"!==i()(s[a].affectedControls)||Array.isArray(s[a].affectedControls)?s[a].affectedControls:(0,Ht.A)(s[a].affectedControls);null===c||void 0===c||c.forEach((function(e){t.push(e)}))}}this.salesforceAffectedControlsTriggers=(0,Vt.A)((0,Gt.A)(e)),this.salesforceAffectedControls=(0,Vt.A)((0,Gt.A)((0,jt.A)(t,this.salesforceAffectedControlsTriggers)))}},{key:"getSalesforceAffectedControlsTriggers",value:function(){return this.salesforceAffectedControlsTriggers}},{key:"getSalesforceAffectedControls",value:function(){return this.salesforceAffectedControls}},{key:"hasSalesforceRule",value:function(){return this.rules.some((function(e){return!0===e.isSalesforce}))}},{key:"isSalesforceWithPrefillTriggerRule",value:function(){var e=[E.a4.REINITIALIZE,E.a4.CHANGE];return this.rules.every((function(t){return e.includes(t.eventType)}))}},{key:"shouldShowLoaderOnSalesforce",value:function(){return this.hasSalesforceRule()&&!this.isSalesforceWithPrefillTriggerRule()}},{key:"shouldShowLoader",value:function(){return 0!==this.rules.length&&(this.rules.length>n.SHOW_LOADER_RULES_COUNT||this.shouldShowLoaderOnSalesforce())}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new n)}}]),n}(b.b);y()(Mn,"SHOW_LOADER_RULES_COUNT",100),y()(Mn,"instance",void 0)},6626:function(e,t,n){n.d(t,{C:function(){return l}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(43693),u=n.n(s),c=n(62768),l=function(){function e(t,n,r){i()(this,e),u()(this,"numColumns",void 0),u()(this,"columns",{}),u()(this,"data",[]),u()(this,"rowIndex",void 0),this.numColumns=t.length;for(var o=0;o<this.numColumns;o++)this.columns[t[o].name]={type:t[o].type,index:o};this.data=n,this.rowIndex=r}return a()(e,[{key:"withIndex",value:function(e){return this.rowIndex=e,this}},{key:"withRowData",value:function(e){return this.data=e,this}},{key:"getDataAsArray",value:function(){return this.data}},{key:"getColumnValue",value:function(e){return this.data[this.columns[e].index]}},{key:"setColumnValue",value:function(e,t){this.data[this.columns[e].index]=t}},{key:"toObject",value:function(){var e,t=Object.create(null);for(var n in this.columns)void 0===(e=this.data[this.columns[n].index])&&(e=null),t[n]=e;return t}},{key:"getRowIndex",value:function(){return this.rowIndex}}],[{key:"createFromObject",value:function(t){var n=[],r=[];for(var i in t)n.push({type:c.DW.NULL,name:i}),r.push(t[i]);return new e(n,r,0)}},{key:"createFromTable",value:function(t){return new e(t.describe(),t.createEmptyRow(),void 0)}}]),e}()},52752:function(e,t,n){n.d(t,{C:function(){return N}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(62768),u=n(29511),c=n.n(u),l=n(28452),h=n.n(l),f=n(63072),d=n.n(f),p=n(43693),g=n.n(p),v=function(){function e(t,n){i()(this,e),g()(this,"descriptors",void 0),g()(this,"table",void 0),this.table=t,this.descriptors=(n||[]).slice(0)}return a()(e,[{key:"getDescriptors",value:function(){return this.descriptors}},{key:"getTable",value:function(){return this.table}}]),e}();function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var y=function(e){c()(n,e);var t=m(n);function n(e,r){return i()(this,n),t.call(this,e,[r])}return a()(n,[{key:"isUnique",value:function(){return!0}},{key:"isAutoIncrement",value:function(){return null}},{key:"getNextAutoIncrementValue",value:function(){return null}},{key:"index",value:function(){}}]),n}(v),b=n(12475),E=n.n(b);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var T=function(e){c()(n,e);var t=w(n);function n(e,r){var o;return i()(this,n),o=t.call(this,e,[r]),g()(E()(o),"unique",void 0),g()(E()(o),"autoIncrement",void 0),g()(E()(o),"values",void 0),g()(E()(o),"maxAutoIncrement",0),o.unique=!!r.unique,o.autoIncrement=!!r.autoIncrement,o}return a()(n,[{key:"isUnique",value:function(){return this.unique}},{key:"isAutoIncrement",value:function(){return this.autoIncrement}},{key:"getNextAutoIncrementValue",value:function(){if(this.autoIncrement)return this.maxAutoIncrement+1;throw new Error("Index is not auto-increment!")}},{key:"index",value:function(){this.values=[];var e,t,n=this.table.createIterator();for(this.maxAutoIncrement=0;e=n.next();){var r=e.getColumnValue(this.descriptors[0].name);if(null!==r){var i=String(r).toLowerCase();if(this.values.indexOf(t=i)>-1)throw new Error("Duplicate key "+JSON.stringify(this.descriptors[0].name)+" found with value "+JSON.stringify(t)+" found!");this.values.push(t),this.autoIncrement&&(this.maxAutoIncrement=Math.max(this.maxAutoIncrement,Number(t)))}}}}]),n}(v),N=function(){function e(){i()(this,e)}return a()(e,null,[{key:"createFromIndexDescriptor",value:function(e,t){return e.getStorageEngine()===s.Ev.IN_MEMORY?new T(e,t):new y(e,t)}}]),e}()},29779:function(e,t,n){n.d(t,{K:function(){return I}});var r=n(17383),i=n.n(r),o=n(34579),a=n.n(o),s=n(62768),u=n(12475),c=n.n(u),l=n(29511),h=n.n(l),f=n(28452),d=n.n(f),p=n(63072),g=n.n(p),v=n(43693),m=n.n(v),y=n(52752),b=function(){function e(t){i()(this,e),m()(this,"identifiers",[]),m()(this,"emptyRow",[]),m()(this,"indexes",[]),m()(this,"autoIncrementColumnIndex",null),m()(this,"autoIncrementValue",1);for(var n=0,r=t||[],o=r.length;n<o;n++)if(this.identifiers.push(r[n]),void 0!==r[n].default)this.emptyRow.push(r[n].default);else switch(t[n].type){case s.DW.NULL:this.emptyRow.push(null);break;case s.DW.NUMBER:this.emptyRow.push(0);break;case s.DW.STRING:this.emptyRow.push("");break;case s.DW.BOOLEAN:this.emptyRow.push(!1);break;default:this.emptyRow.push(null)}}return a()(e,[{key:"withSingleColumnIndex",value:function(e){var t,n=0;if(this.indexes)for(var r=0,i=this.indexes.length;r<i;r++)this.indexes[r].isAutoIncrement()&&n++;if(void 0!==e.unique&&e.unique||void 0!==e.autoIncrement&&e.autoIncrement){if((t=y.C.createFromIndexDescriptor(this,e)).isAutoIncrement()){if(n++,t.getDescriptors().length>1)throw new Error("Auto-increment indexes must refer to a single column only!");if(n>1)throw new Error("There can be only a single auto-increment index!");if(!t.isUnique())throw new Error("Auto-increment indexes must be unique!");for(var o=!1,a=0,u=this.identifiers.length;a<u;a++)if(this.identifiers[a].name===e.name){if(this.autoIncrementColumnIndex=a,o=!0,this.identifiers[a].type!==s.DW.NUMBER)throw new Error("Auto-increment index column type must be NUMBER!");break}if(!o)throw new Error("Cannot add a index on a non-existing column!")}this.indexes.push(t)}return this}},{key:"describe",value:function(){return this.identifiers.slice(0)}},{key:"hasIdentifier",value:function(e){for(var t=0,n=this.identifiers.length;t<n;t++)if(this.identifiers[t].name===e)return!0;return!1}},{key:"createEmptyRow",value:function(){return this.emptyRow.slice(0)}},{key:"getIndexes",value:function(){return this.indexes}},{key:"reIndex",value:function(){for(var e=0,t=this.indexes.length;e<t;e++)this.indexes[e].index(),this.indexes[e].isAutoIncrement()&&this.setNextAutoIncrementValue(this.indexes[e].getNextAutoIncrementValue())}},{key:"fetch",value:function(){return Promise.resolve(this)}}]),e}(),E=n(6626),w=function(){function e(t){i()(this,e),m()(this,"table",void 0),m()(this,"index",0),m()(this,"row",void 0),this.table=t,this.row=new E.C(t.describe(),null,null)}return a()(e,[{key:"next",value:function(){var e=this.table.getRowAt(this.index);return null===e?null:(this.row.withIndex(this.index),this.row.withRowData(e),this.index++,this.row)}}]),e}();function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var N=function(e){h()(n,e);var t=T(n);function n(e,r,o){var a;i()(this,n),a=t.call(this,e),m()(c()(a),"rows",[]),m()(c()(a),"lastTransactionSnapshot",void 0);for(var s=0,u=r.length;s<u;s++)a.rows.push(r[s]);if(o){if(!Array.isArray(o))throw new Error("Invalid class constructor argument: indexes: Expected array!");for(var l=0,h=o.length;l<h;l++)a.withSingleColumnIndex(o[l]);a.reIndex()}return a}return a()(n,[{key:"isRemote",value:function(){return!1}},{key:"getStorageEngine",value:function(){return s.Ev.IN_MEMORY}},{key:"getRowAt",value:function(e){return this.rows[e]||null}},{key:"createIterator",value:function(){return new w(this)}},{key:"replace",value:function(e,t){if(!this.rows[e])throw new Error("Undefined table index: "+JSON.stringify(e));for(var n=0,r=this.rows[e].length;n<r;n++)this.rows[e][n]=t[n]}},{key:"deleteRow",value:function(e){this.rows[e]&&(this.rows[e]=null)}},{key:"insertRow",value:function(e){if(!e||void 0===e.length)throw new Error("Invalid argument row: array expected!");if(e.length!==this.identifiers.length)throw new Error("Row mismatch: Expected "+this.identifiers.length+" values, got "+e.length+" values!");null!==this.autoIncrementColumnIndex&&null===e[this.autoIncrementColumnIndex]&&(e[this.autoIncrementColumnIndex]=this.autoIncrementValue,this.autoIncrementValue++),this.rows.push(e)}},{key:"compact",value:function(){for(var e=this.rows.length-1;e>=0;e--)null===this.rows[e]&&this.rows.splice(e,1)}},{key:"isTransactional",value:function(){return!0}},{key:"startTransaction",value:function(){this.lastTransactionSnapshot=JSON.stringify(this.rows)}},{key:"commitTransaction",value:function(){if(void 0===this.lastTransactionSnapshot)throw new Error('No transaction started before!"');this.lastTransactionSnapshot=void 0}},{key:"rollbackTransaction",value:function(){if(void 0===this.lastTransactionSnapshot)throw new Error("Failed to rollback transaction: No transaction started before!");this.rows=JSON.parse(this.lastTransactionSnapshot)}},{key:"getNextAutoIncrementValue",value:function(){return this.autoIncrementValue+1}},{key:"setNextAutoIncrementValue",value:function(e){if("number"!==typeof e||!isFinite(e))throw new Error("Value is not finite!");if(e%1!==0)throw new Error("Value must be integer!");if(e<1)throw new Error("Value must be greater than 0!");this.autoIncrementValue=e}},{key:"alterIndexes",value:function(e){return Promise.reject()}},{key:"isIndexable",value:function(){return!0}},{key:"isVirtual",value:function(){return!1}}]),n}(b),k=function(){function e(t){i()(this,e),m()(this,"table",void 0),m()(this,"cols",void 0),m()(this,"data",void 0),this.table=t,this.data=Object.create(null);for(var n=0,r=this.table.describe(),o=r.length;n<o;n++)!function(e,t,n){Object.defineProperty(n,String(e),{get:function(){return void 0===n.data[t]||void 0===n.data[t].get?void 0:n.data[t].get()},set:function(e){if(void 0===n.data[t]||void 0===n.data[t].set)throw new Error('Value "'+t+'" is read-only!');n.data[t].set(e)},enumerable:!0,configurable:!1})}(n,r[n].name,this),this.cols=n+1}return a()(e,[{key:"length",get:function(){return this.cols}},{key:"withPropertySetter",value:function(e,t){if(!this.table.hasIdentifier(e))throw new Error('Property "'+e+'" is not allowed!');return this.data[e]=this.data[e]||Object.create(null),this.data[e].set=t,this}},{key:"withPropertyGetter",value:function(e,t){if(!this.table.hasIdentifier(e))throw new Error('Property "'+e+'" is not allowed!');return this.data[e]=this.data[e]||Object.create(null),this.data[e].get=t,this}}]),e}();function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var S=function(e){h()(n,e);var t=R(n);function n(e){return i()(this,n),t.call(this,e,[],void 0)}return a()(n,[{key:"createRow",value:function(){var e=new k(this);return this.rows.push(e),e}},{key:"withSingleColumnIndex",value:function(e){throw new Error("Cannot add indexes on virtual tables!")}},{key:"replace",value:function(e,t){}},{key:"insertRow",value:function(e){throw new Error("Cannot insert rows on virtual tables!")}},{key:"deleteRow",value:function(e){throw new Error("Cannot delete rows from virtual tables!")}},{key:"isTransactional",value:function(){return!1}},{key:"startTransaction",value:function(){throw new Error("Transactions are not supported on virtual tables!")}},{key:"commitTransaction",value:function(){throw new Error("Transactions are not supported on virtual tables!")}},{key:"rollbackTransaction",value:function(){throw new Error("Transactions are not supported on virtual tables!")}},{key:"getNextAutoIncrementValue",value:function(){return 1}},{key:"isIndexable",value:function(){return!1}},{key:"isVirtual",value:function(){return!0}}]),n}(N);function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var O=function(e){h()(n,e);var t=C(n);function n(e,r){var o;if(i()(this,n),o=t.call(this,e),r){if(!Array.isArray(r))throw new Error("Invalid class constructor argument: indexes: Expected array!");for(var a=0,s=r.length;a<s;a++)o.withSingleColumnIndex(r[a])}return o}return a()(n,[{key:"isRemote",value:function(){return!0}},{key:"getStorageEngine",value:function(){return s.Ev.REMOTE}},{key:"isTransactional",value:function(){return!1}},{key:"startTransaction",value:function(){throw new Error("Operation handled by backend!")}},{key:"commitTransaction",value:function(){throw new Error("Operation handled by backend!")}},{key:"rollbackTransaction",value:function(){throw new Error("Operation handled by backend!")}},{key:"getNextAutoIncrementValue",value:function(){throw new Error("Operation handled by backend!")}},{key:"setNextAutoIncrementValue",value:function(e){throw new Error("Operation handled by backend!")}},{key:"alterIndexes",value:function(e){return Promise.reject()}},{key:"isIndexable",value:function(){return!0}},{key:"isVirtual",value:function(){return!1}}]),n}(b),D=n(34919),I=function(){function e(){i()(this,e)}return a()(e,null,[{key:"createVirtualTable",value:function(e){return new S(e)}},{key:"createFromInMemoryArrayOfObjects",value:function(e,t,n){var r,i,o,a=void 0===t?D.b.getColumnDefinitions(e):t,u=[],c=a.length;if(!a.length)throw new Error('No valid columns were detected in "in-memory" array!');for(var l=0,h=e.length;l<h;l++){var f=0,d=void 0;for(d=0;d<c;d++)if(Array.isArray(e[l][a[d].name])){f=e[l][a[d].name].length;break}if(f>0)for(var p=0;p<f;p++){r=[];for(var g=0;g<c;g++)i=g==d?e[l][a[g].name][p]:e[l][a[g].name],null!==(o=D.b.getType(i))&&o===a[g].type||(i=null),r.push(i);u.push(r)}else{r=[];for(var v=0;v<c;v++)i=e[l][a[v].name],(o=D.b.getType(i))===s.DW.OBJECT&&(i=i[Object.keys(i)[0]],o=D.b.getType(i)),null!==o&&o===a[v].type||(i=null),r.push(i);u.push(r)}}return new N(a,u,n)}},{key:"createFromRemoteTableDefinition",value:function(e,t){return new O(e,t)}}]),e}();window.JQLTableFactory=I},34919:function(e,t,n){n.d(t,{b:function(){return f}});var r=n(73738),i=n.n(r),o=n(17383),a=n.n(o),s=n(34579),u=n.n(s),c=n(43693),l=n.n(c),h=n(62768),f=function(){function e(){a()(this,e)}return u()(e,null,[{key:"getType",value:function(e){if(void 0===e)return null;if(null===e)return h.DW.NULL;var t=i()(e);return"number"===t?isFinite(e)?h.DW.NUMBER:null:"boolean"===t?h.DW.BOOLEAN:"string"===t?h.DW.STRING:"object"===t?h.DW.OBJECT:null}},{key:"isNumeric",value:function(e){var t=this.getType(e);return t===h.DW.NUMBER||t===h.DW.STRING&&"-"!==e&&"+"!==e&&/^([\-+])?(0|[1-9]([0-9]+)?)?(\.[0-9]+)?/.test(e)}},{key:"getColumnDefinitions",value:function(e){for(var t,n=Object.create(null),r=0,i=(e||[]).length;r<i&&0===r;r++)for(var o in e[r])e[r].hasOwnProperty(o)&&(t=this.getType(e[r][o]),n[o]=t);var a=[];for(var s in n)null!==n[s]&&a.push({type:n[s],name:s});return a}},{key:"isReservedKeyword",value:function(e){return this.RESERVED_KEYWORDS.indexOf(String(e||""))>-1}},{key:"shuffleArray",value:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}},{key:"compare",value:function(e,t){var n,r,i=this.getType(e),o=this.getType(t);if(null===i&&null===o)return 0;if(null===i||null===o)return null===i?-1:1;if(i===o)switch(i){case h.DW.BOOLEAN:case h.DW.NUMBER:case h.DW.NULL:return e==t?0:e<t?-1:1;case h.DW.STRING:n=String(e).toLowerCase(),r=String(t).toLowerCase()}else n=i!==h.DW.STRING?i===h.DW.NUMBER?String(e):i===h.DW.NULL?"":e?"1":"0":String(e).toLowerCase(),r=o!==h.DW.STRING?o===h.DW.NUMBER?String(t):o===h.DW.NULL?"":t?"1":"0":String(e).toLowerCase();return n===r?0:n<r?-1:1}},{key:"parseString",value:function(e){for(var t,n,r="",i=0,o=e.length;i<o;i++)if("\\"===(t=e.charAt(i)))switch(n=e.charAt(i+1),i++,n){case"r":r+="\r";break;case"n":r+="\n";break;case"t":r+="\t";break;case"\\":case"":r+="\\";break;default:r+=n}else r+=t;return r}},{key:"castToString",value:function(e){return!0===e?"1":!1===e?"0":String(e||"")}},{key:"compareAsStrings",value:function(e,t){var n=this.castToString(e).toLowerCase(),r=this.castToString(t).toLowerCase();return n===r?0:n>r?-1:1}},{key:"encodeData",value:function(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}},{key:"makeRequest",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.REQUEST_METHOD_GET,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.REQUEST_CONTENT_TYPE_PLAIN,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=new XMLHttpRequest;return a&&(s.withCredentials=!0),new Promise((function(a,u){s.onreadystatechange=function(){if(4===s.readyState)if(s.status>=200&&s.status<300){var t;switch(s.responseType){case e.REQUEST_RESPONSE_TYPE_TEXT:t=s.responseText;break;case e.REQUEST_RESPONSE_TYPE_JSON:case e.REQUEST_RESPONSE_TYPE_BLOB:case e.REQUEST_RESPONSE_TYPE_BUFFER:default:t="string"==typeof s.response?JSON.parse(s.response):s.response}a(t)}else u(s.statusText)},s.ontimeout=function(){u(s.statusText)},s.open(n,t,!0),i&&(s.responseType=i),r&&s.setRequestHeader("Content-Type",r),s.send(o)}))}}]),e}();l()(f,"REQUEST_METHOD_POST","POST"),l()(f,"REQUEST_METHOD_GET","GET"),l()(f,"REQUEST_CONTENT_TYPE_PLAIN","text/plain"),l()(f,"REQUEST_CONTENT_TYPE_HTML","text/html"),l()(f,"REQUEST_CONTENT_TYPE_JSON","application/json"),l()(f,"REQUEST_CONTENT_TYPE_MULTIPART","multipart/form-data"),l()(f,"REQUEST_CONTENT_TYPE_X_WWW_FORM_URLENCODED","application/x-www-form-urlencoded"),l()(f,"REQUEST_RESPONSE_TYPE_BUFFER","arraybuffer"),l()(f,"REQUEST_RESPONSE_TYPE_BLOB","blob"),l()(f,"REQUEST_RESPONSE_TYPE_TEXT","text"),l()(f,"REQUEST_RESPONSE_TYPE_JSON","json"),l()(f,"RESERVED_KEYWORDS",["select","from","where","in","limit","order","by","asc","update","table","set","insert","into","values","delete","like"])},62768:function(e,t,n){var r,i,o,a,s,u,c,l,h,f,d,p,g,v,m,y;n.d(t,{$U:function(){return r},DQ:function(){return u},DW:function(){return d},Ev:function(){return g},Fb:function(){return h},Hg:function(){return a},W:function(){return m},a4:function(){return y},gN:function(){return l},ko:function(){return i},ll:function(){return o},rp:function(){return p},tx:function(){return f},um:function(){return c},yo:function(){return v},zN:function(){return s}}),function(e){e.STATEMENT="statement",e.TABLE="table_reference",e.EXPRESSION="expression",e.FIELDS_LIST="fields_list",e.FIELD="field",e.UPDATE_FIELD="update_field",e.DELAYED_OPTION="delayed_option",e.LIMIT_OPTION="limit_option",e.ORDER_BY_OPTION="order_by_option",e.ORDER_BY_EXPRESSION="order_by_expression"}(r||(r={})),function(e){e.SELECT="select",e.UPDATE="update",e.INSERT="insert",e.DELETE="delete"}(i||(i={})),function(e){e.ALL_FIELDS="all",e.SPECIFIC_FIELDS="enumeration"}(o||(o={})),function(e){e.NUMBER="number",e.BOOLEAN="boolean",e.NULL="null",e.STRING="string",e.UNARY="unary",e.LOGICAL="logical",e.MATH="math",e.GROUP="group",e.IDENTIFIER="identifier",e.BINDING="binding",e.FUNCTION_CALL="function_call"}(a||(a={})),function(e){e.RANDOM="random",e.ORDERED="ordered"}(s||(s={})),function(e){e.ASCENDING="asc",e.DESCENDING="desc"}(u||(u={})),function(e){e.NOT="!",e.INVERT="-"}(c||(c={})),function(e){e.OR="||",e.AND="&&"}(l||(l={})),function(e){e.EQUALS="=",e.NOTEQUAL="!=",e.DIFFERENT="<>",e.LIKE="like",e.IN="in",e.LTE="<=",e.LT="<",e.GTE=">=",e.GT=">"}(h||(h={})),function(e){e.MULTIPLY="*",e.DIVISION="/",e.ADDITION="+",e.DIFFERENCE="-"}(f||(f={})),function(e){e.STRING="string",e.NUMBER="number",e.BOOLEAN="boolean",e.NULL="null",e.OBJECT="object"}(d||(d={})),function(e){e.STRING="string",e.INT="int",e.FLOAT="float",e.BOOLEAN="boolean"}(p||(p={})),function(e){e.IN_MEMORY="memory",e.REMOTE="remote"}(g||(g={})),function(e){e.READ="r",e.WRITE="w",e.READ_WRITE="rw"}(v||(v={})),function(e){e.FORM="private",e.GLOBAL="global"}(m||(m={})),function(e){e[e.INIT=0]="INIT",e[e.CHANGE=1]="CHANGE",e[e.CHECK=2]="CHECK",e[e.UNCHECK=3]="UNCHECK",e[e.TEXT_INPUT=4]="TEXT_INPUT",e[e.ALL_EVENTS=5]="ALL_EVENTS",e[e.REINITIALIZE=6]="REINITIALIZE",e[e.APPROVED=7]="APPROVED",e[e.SUBMITTED=8]="SUBMITTED",e[e.PREFILL=9]="PREFILL"}(y||(y={})),window.EJQLTableColumnType=d,window.EFormRuleEventType=y}}]);